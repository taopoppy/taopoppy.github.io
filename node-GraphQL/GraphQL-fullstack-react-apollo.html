<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>完整代码 | TaoPoppy</title>
    <meta name="description" content="陶振川">
    <link rel="icon" href="/meta.png">
    
    <link rel="preload" href="/assets/css/0.styles.32e41c9b.css" as="style"><link rel="preload" href="/assets/js/app.1a394514.js" as="script"><link rel="preload" href="/assets/js/2.8304a06b.js" as="script"><link rel="preload" href="/assets/js/179.8ab2f01b.js" as="script"><link rel="prefetch" href="/assets/js/10.7aef26de.js"><link rel="prefetch" href="/assets/js/100.b6a5dbe3.js"><link rel="prefetch" href="/assets/js/101.4cf14517.js"><link rel="prefetch" href="/assets/js/102.a10509c8.js"><link rel="prefetch" href="/assets/js/103.725c83f9.js"><link rel="prefetch" href="/assets/js/104.4cf52e25.js"><link rel="prefetch" href="/assets/js/105.fa93d42c.js"><link rel="prefetch" href="/assets/js/106.bc4f6131.js"><link rel="prefetch" href="/assets/js/107.720518ec.js"><link rel="prefetch" href="/assets/js/108.73134973.js"><link rel="prefetch" href="/assets/js/109.074b05fb.js"><link rel="prefetch" href="/assets/js/11.0781fb51.js"><link rel="prefetch" href="/assets/js/110.fa287650.js"><link rel="prefetch" href="/assets/js/111.66cf0003.js"><link rel="prefetch" href="/assets/js/112.ec18ad13.js"><link rel="prefetch" href="/assets/js/113.45a7c13a.js"><link rel="prefetch" href="/assets/js/114.8ac723f2.js"><link rel="prefetch" href="/assets/js/115.519d8940.js"><link rel="prefetch" href="/assets/js/116.c52bde55.js"><link rel="prefetch" href="/assets/js/117.35c583ff.js"><link rel="prefetch" href="/assets/js/118.6b209cf4.js"><link rel="prefetch" href="/assets/js/119.a3bd3fcb.js"><link rel="prefetch" href="/assets/js/12.75f1c153.js"><link rel="prefetch" href="/assets/js/120.45c18f2c.js"><link rel="prefetch" href="/assets/js/121.f1335403.js"><link rel="prefetch" href="/assets/js/122.4ddc6efe.js"><link rel="prefetch" href="/assets/js/123.3fedcfb9.js"><link rel="prefetch" href="/assets/js/124.57c3d5fd.js"><link rel="prefetch" href="/assets/js/125.98bb56f7.js"><link rel="prefetch" href="/assets/js/126.b4e3e7bc.js"><link rel="prefetch" href="/assets/js/127.aa4e7f95.js"><link rel="prefetch" href="/assets/js/128.08be9111.js"><link rel="prefetch" href="/assets/js/129.c32609eb.js"><link rel="prefetch" href="/assets/js/13.a3141dde.js"><link rel="prefetch" href="/assets/js/130.a0c93b04.js"><link rel="prefetch" href="/assets/js/131.dfae9fea.js"><link rel="prefetch" href="/assets/js/132.74845e19.js"><link rel="prefetch" href="/assets/js/133.cb7fc263.js"><link rel="prefetch" href="/assets/js/134.f9ae184c.js"><link rel="prefetch" href="/assets/js/135.273e7372.js"><link rel="prefetch" href="/assets/js/136.1da93b8e.js"><link rel="prefetch" href="/assets/js/137.198dbe16.js"><link rel="prefetch" href="/assets/js/138.64fac690.js"><link rel="prefetch" href="/assets/js/139.ac7f9fdf.js"><link rel="prefetch" href="/assets/js/14.023d10f2.js"><link rel="prefetch" href="/assets/js/140.a6685c82.js"><link rel="prefetch" href="/assets/js/141.96f04b23.js"><link rel="prefetch" href="/assets/js/142.cc5f5520.js"><link rel="prefetch" href="/assets/js/143.9b28c5f0.js"><link rel="prefetch" href="/assets/js/144.b0527ead.js"><link rel="prefetch" href="/assets/js/145.dad8d1ad.js"><link rel="prefetch" href="/assets/js/146.37619b4e.js"><link rel="prefetch" href="/assets/js/147.51353321.js"><link rel="prefetch" href="/assets/js/148.b7dbbadc.js"><link rel="prefetch" href="/assets/js/149.01c189f9.js"><link rel="prefetch" href="/assets/js/15.1ead8c76.js"><link rel="prefetch" href="/assets/js/150.6999137d.js"><link rel="prefetch" href="/assets/js/151.36a45175.js"><link rel="prefetch" href="/assets/js/152.f4c8c0a3.js"><link rel="prefetch" href="/assets/js/153.f04f1cfa.js"><link rel="prefetch" href="/assets/js/154.11f667b0.js"><link rel="prefetch" href="/assets/js/155.3df246f1.js"><link rel="prefetch" href="/assets/js/156.95c2a81f.js"><link rel="prefetch" href="/assets/js/157.4c4e453a.js"><link rel="prefetch" href="/assets/js/158.ea143735.js"><link rel="prefetch" href="/assets/js/159.1851c143.js"><link rel="prefetch" href="/assets/js/16.588b8a18.js"><link rel="prefetch" href="/assets/js/160.8623fd27.js"><link rel="prefetch" href="/assets/js/161.9f3dde39.js"><link rel="prefetch" href="/assets/js/162.ec8ada30.js"><link rel="prefetch" href="/assets/js/163.578cd511.js"><link rel="prefetch" href="/assets/js/164.5f326c38.js"><link rel="prefetch" href="/assets/js/165.d6055e4f.js"><link rel="prefetch" href="/assets/js/166.a4b38932.js"><link rel="prefetch" href="/assets/js/167.6a25e6a6.js"><link rel="prefetch" href="/assets/js/168.11291db9.js"><link rel="prefetch" href="/assets/js/169.3a6aec97.js"><link rel="prefetch" href="/assets/js/17.dbb0117f.js"><link rel="prefetch" href="/assets/js/170.c1b92e05.js"><link rel="prefetch" href="/assets/js/171.f06cccdb.js"><link rel="prefetch" href="/assets/js/172.26661658.js"><link rel="prefetch" href="/assets/js/173.ce718757.js"><link rel="prefetch" href="/assets/js/174.425859ee.js"><link rel="prefetch" href="/assets/js/175.b334be38.js"><link rel="prefetch" href="/assets/js/176.d29c1ef4.js"><link rel="prefetch" href="/assets/js/177.61e20b4a.js"><link rel="prefetch" href="/assets/js/178.f79fe9c5.js"><link rel="prefetch" href="/assets/js/18.5178d2f1.js"><link rel="prefetch" href="/assets/js/180.e1f584e7.js"><link rel="prefetch" href="/assets/js/181.384f8b65.js"><link rel="prefetch" href="/assets/js/182.675d4534.js"><link rel="prefetch" href="/assets/js/183.a5314419.js"><link rel="prefetch" href="/assets/js/184.49a4f95b.js"><link rel="prefetch" href="/assets/js/185.39566276.js"><link rel="prefetch" href="/assets/js/186.faf772f8.js"><link rel="prefetch" href="/assets/js/187.5e40a002.js"><link rel="prefetch" href="/assets/js/188.e9a85c75.js"><link rel="prefetch" href="/assets/js/189.4f6300fd.js"><link rel="prefetch" href="/assets/js/19.a3a8a3b2.js"><link rel="prefetch" href="/assets/js/190.5395a82d.js"><link rel="prefetch" href="/assets/js/191.c37e69d9.js"><link rel="prefetch" href="/assets/js/192.49c5336c.js"><link rel="prefetch" href="/assets/js/193.8358c1f7.js"><link rel="prefetch" href="/assets/js/194.f3baad75.js"><link rel="prefetch" href="/assets/js/195.9b64acde.js"><link rel="prefetch" href="/assets/js/196.af79cfd2.js"><link rel="prefetch" href="/assets/js/197.83502b3c.js"><link rel="prefetch" href="/assets/js/198.79a30060.js"><link rel="prefetch" href="/assets/js/199.4a4580d8.js"><link rel="prefetch" href="/assets/js/20.f7956ee9.js"><link rel="prefetch" href="/assets/js/200.ea5edefe.js"><link rel="prefetch" href="/assets/js/201.ba9f6baf.js"><link rel="prefetch" href="/assets/js/202.a684e81a.js"><link rel="prefetch" href="/assets/js/203.f6ae36b1.js"><link rel="prefetch" href="/assets/js/204.1b7d15f6.js"><link rel="prefetch" href="/assets/js/205.886aa300.js"><link rel="prefetch" href="/assets/js/206.4c920afb.js"><link rel="prefetch" href="/assets/js/207.84ff34f5.js"><link rel="prefetch" href="/assets/js/208.869b1786.js"><link rel="prefetch" href="/assets/js/209.46e7bcd8.js"><link rel="prefetch" href="/assets/js/21.a7419b80.js"><link rel="prefetch" href="/assets/js/210.8ae86200.js"><link rel="prefetch" href="/assets/js/211.8f174712.js"><link rel="prefetch" href="/assets/js/212.13a1cfde.js"><link rel="prefetch" href="/assets/js/213.2623c8b3.js"><link rel="prefetch" href="/assets/js/214.5f6c13ce.js"><link rel="prefetch" href="/assets/js/215.239ee6c0.js"><link rel="prefetch" href="/assets/js/216.bb2ce7ff.js"><link rel="prefetch" href="/assets/js/217.0708a1bc.js"><link rel="prefetch" href="/assets/js/218.9b44a3a0.js"><link rel="prefetch" href="/assets/js/219.872ef7dc.js"><link rel="prefetch" href="/assets/js/22.c95b31e3.js"><link rel="prefetch" href="/assets/js/220.d16ceb67.js"><link rel="prefetch" href="/assets/js/221.405b655a.js"><link rel="prefetch" href="/assets/js/222.fcbd0075.js"><link rel="prefetch" href="/assets/js/223.e48f31f2.js"><link rel="prefetch" href="/assets/js/224.f5562fa5.js"><link rel="prefetch" href="/assets/js/225.4c58f939.js"><link rel="prefetch" href="/assets/js/226.84e6ccf6.js"><link rel="prefetch" href="/assets/js/227.307e3114.js"><link rel="prefetch" href="/assets/js/228.f4bc2989.js"><link rel="prefetch" href="/assets/js/229.96ea2ba2.js"><link rel="prefetch" href="/assets/js/23.a75f3ddc.js"><link rel="prefetch" href="/assets/js/230.2ae85257.js"><link rel="prefetch" href="/assets/js/231.78d7510d.js"><link rel="prefetch" href="/assets/js/232.f5bf4f67.js"><link rel="prefetch" href="/assets/js/233.9102fdaa.js"><link rel="prefetch" href="/assets/js/234.a9e5e11a.js"><link rel="prefetch" href="/assets/js/235.71426295.js"><link rel="prefetch" href="/assets/js/236.03474465.js"><link rel="prefetch" href="/assets/js/237.48aed7b3.js"><link rel="prefetch" href="/assets/js/238.6a271b50.js"><link rel="prefetch" href="/assets/js/239.28d2a86b.js"><link rel="prefetch" href="/assets/js/24.84641855.js"><link rel="prefetch" href="/assets/js/240.22bca10d.js"><link rel="prefetch" href="/assets/js/241.2a279198.js"><link rel="prefetch" href="/assets/js/242.43b24484.js"><link rel="prefetch" href="/assets/js/243.fe9d5ea9.js"><link rel="prefetch" href="/assets/js/244.d39e950f.js"><link rel="prefetch" href="/assets/js/245.64db6d12.js"><link rel="prefetch" href="/assets/js/246.5b1f1745.js"><link rel="prefetch" href="/assets/js/247.d1ab0e2b.js"><link rel="prefetch" href="/assets/js/248.a19e36bd.js"><link rel="prefetch" href="/assets/js/249.3aa723c7.js"><link rel="prefetch" href="/assets/js/25.73570942.js"><link rel="prefetch" href="/assets/js/250.0f968bec.js"><link rel="prefetch" href="/assets/js/251.9ade3872.js"><link rel="prefetch" href="/assets/js/252.72e1aa12.js"><link rel="prefetch" href="/assets/js/253.374cc99e.js"><link rel="prefetch" href="/assets/js/254.44800bf9.js"><link rel="prefetch" href="/assets/js/255.06241cb8.js"><link rel="prefetch" href="/assets/js/256.bbeaafaa.js"><link rel="prefetch" href="/assets/js/257.14e8b661.js"><link rel="prefetch" href="/assets/js/258.0913e120.js"><link rel="prefetch" href="/assets/js/259.32bd3bf9.js"><link rel="prefetch" href="/assets/js/26.9a79c041.js"><link rel="prefetch" href="/assets/js/260.e5a40c02.js"><link rel="prefetch" href="/assets/js/261.4c8be7b1.js"><link rel="prefetch" href="/assets/js/262.0663f55e.js"><link rel="prefetch" href="/assets/js/263.cecc1123.js"><link rel="prefetch" href="/assets/js/264.d2209296.js"><link rel="prefetch" href="/assets/js/265.497bc01b.js"><link rel="prefetch" href="/assets/js/266.769ac5e0.js"><link rel="prefetch" href="/assets/js/267.6b97962f.js"><link rel="prefetch" href="/assets/js/268.fa6635c8.js"><link rel="prefetch" href="/assets/js/269.c1e74469.js"><link rel="prefetch" href="/assets/js/27.0dd62438.js"><link rel="prefetch" href="/assets/js/270.4e8f8d77.js"><link rel="prefetch" href="/assets/js/271.f27f2f56.js"><link rel="prefetch" href="/assets/js/272.d1349876.js"><link rel="prefetch" href="/assets/js/273.e967ea79.js"><link rel="prefetch" href="/assets/js/274.7c9df4ce.js"><link rel="prefetch" href="/assets/js/275.5b85e62c.js"><link rel="prefetch" href="/assets/js/276.c09ef549.js"><link rel="prefetch" href="/assets/js/277.58b59a93.js"><link rel="prefetch" href="/assets/js/278.e91f9b01.js"><link rel="prefetch" href="/assets/js/279.3159509a.js"><link rel="prefetch" href="/assets/js/28.685ccac3.js"><link rel="prefetch" href="/assets/js/280.8878bc0d.js"><link rel="prefetch" href="/assets/js/281.c7e08ecb.js"><link rel="prefetch" href="/assets/js/282.85066f7c.js"><link rel="prefetch" href="/assets/js/283.80120ef1.js"><link rel="prefetch" href="/assets/js/284.1f719606.js"><link rel="prefetch" href="/assets/js/285.b4a3cea5.js"><link rel="prefetch" href="/assets/js/286.2ebd0b34.js"><link rel="prefetch" href="/assets/js/287.8e141966.js"><link rel="prefetch" href="/assets/js/288.ea2f74f5.js"><link rel="prefetch" href="/assets/js/289.beba8c8e.js"><link rel="prefetch" href="/assets/js/29.d9a2cd59.js"><link rel="prefetch" href="/assets/js/290.fd587ae1.js"><link rel="prefetch" href="/assets/js/291.e0b87667.js"><link rel="prefetch" href="/assets/js/292.d86d8fa2.js"><link rel="prefetch" href="/assets/js/293.f176a900.js"><link rel="prefetch" href="/assets/js/294.536a81c8.js"><link rel="prefetch" href="/assets/js/295.54f88831.js"><link rel="prefetch" href="/assets/js/296.7c5ad5dd.js"><link rel="prefetch" href="/assets/js/297.cf9a4601.js"><link rel="prefetch" href="/assets/js/298.a844a174.js"><link rel="prefetch" href="/assets/js/299.809942fc.js"><link rel="prefetch" href="/assets/js/3.5dd59f66.js"><link rel="prefetch" href="/assets/js/30.1ca80117.js"><link rel="prefetch" href="/assets/js/300.bc9809ff.js"><link rel="prefetch" href="/assets/js/301.d677b5b5.js"><link rel="prefetch" href="/assets/js/302.aa40279f.js"><link rel="prefetch" href="/assets/js/303.070e632e.js"><link rel="prefetch" href="/assets/js/304.3d695df8.js"><link rel="prefetch" href="/assets/js/305.44e261e9.js"><link rel="prefetch" href="/assets/js/306.e2f7ad64.js"><link rel="prefetch" href="/assets/js/307.83982154.js"><link rel="prefetch" href="/assets/js/308.4db5bbe7.js"><link rel="prefetch" href="/assets/js/309.3aa975c1.js"><link rel="prefetch" href="/assets/js/31.440aa4c9.js"><link rel="prefetch" href="/assets/js/310.614e3c2f.js"><link rel="prefetch" href="/assets/js/311.ebda45a9.js"><link rel="prefetch" href="/assets/js/312.52cdf585.js"><link rel="prefetch" href="/assets/js/313.1f984642.js"><link rel="prefetch" href="/assets/js/314.fd4722eb.js"><link rel="prefetch" href="/assets/js/315.14d7045f.js"><link rel="prefetch" href="/assets/js/316.8f4cc226.js"><link rel="prefetch" href="/assets/js/317.21630e12.js"><link rel="prefetch" href="/assets/js/318.9a5c960e.js"><link rel="prefetch" href="/assets/js/319.06f7dacf.js"><link rel="prefetch" href="/assets/js/32.27f34442.js"><link rel="prefetch" href="/assets/js/320.e426fea5.js"><link rel="prefetch" href="/assets/js/321.46a426b9.js"><link rel="prefetch" href="/assets/js/322.7256b9c8.js"><link rel="prefetch" href="/assets/js/323.5b848b7f.js"><link rel="prefetch" href="/assets/js/324.e8eedaac.js"><link rel="prefetch" href="/assets/js/325.54947978.js"><link rel="prefetch" href="/assets/js/326.03bfd5b9.js"><link rel="prefetch" href="/assets/js/327.34a2ec4d.js"><link rel="prefetch" href="/assets/js/328.4e023633.js"><link rel="prefetch" href="/assets/js/329.b218e68f.js"><link rel="prefetch" href="/assets/js/33.f6658b03.js"><link rel="prefetch" href="/assets/js/330.a8a2750a.js"><link rel="prefetch" href="/assets/js/331.0df9ca3a.js"><link rel="prefetch" href="/assets/js/332.95c19161.js"><link rel="prefetch" href="/assets/js/333.c6e765b9.js"><link rel="prefetch" href="/assets/js/334.c79e3b52.js"><link rel="prefetch" href="/assets/js/335.49fcd3ab.js"><link rel="prefetch" href="/assets/js/336.5c2ccd1d.js"><link rel="prefetch" href="/assets/js/337.fd6692e6.js"><link rel="prefetch" href="/assets/js/338.e0f59f10.js"><link rel="prefetch" href="/assets/js/339.04196614.js"><link rel="prefetch" href="/assets/js/34.17b5b881.js"><link rel="prefetch" href="/assets/js/340.05e21d65.js"><link rel="prefetch" href="/assets/js/341.15ff2a62.js"><link rel="prefetch" href="/assets/js/342.ae7694ad.js"><link rel="prefetch" href="/assets/js/343.f4a5186c.js"><link rel="prefetch" href="/assets/js/344.4caf3fa0.js"><link rel="prefetch" href="/assets/js/345.214e2189.js"><link rel="prefetch" href="/assets/js/346.f613921f.js"><link rel="prefetch" href="/assets/js/347.626136bf.js"><link rel="prefetch" href="/assets/js/348.cf4b86a4.js"><link rel="prefetch" href="/assets/js/349.2a62c487.js"><link rel="prefetch" href="/assets/js/35.e99d5a01.js"><link rel="prefetch" href="/assets/js/350.389648a3.js"><link rel="prefetch" href="/assets/js/351.81305cad.js"><link rel="prefetch" href="/assets/js/352.d7a80ffa.js"><link rel="prefetch" href="/assets/js/353.0929bd7f.js"><link rel="prefetch" href="/assets/js/354.87d7184c.js"><link rel="prefetch" href="/assets/js/355.1dd69433.js"><link rel="prefetch" href="/assets/js/356.b969449b.js"><link rel="prefetch" href="/assets/js/357.16cecac1.js"><link rel="prefetch" href="/assets/js/358.ef6c9df0.js"><link rel="prefetch" href="/assets/js/359.8b33b863.js"><link rel="prefetch" href="/assets/js/36.8e7e289a.js"><link rel="prefetch" href="/assets/js/360.089cc7ad.js"><link rel="prefetch" href="/assets/js/361.9a59c5c5.js"><link rel="prefetch" href="/assets/js/362.a8026d31.js"><link rel="prefetch" href="/assets/js/363.c3bb2718.js"><link rel="prefetch" href="/assets/js/364.62014d33.js"><link rel="prefetch" href="/assets/js/365.00a229da.js"><link rel="prefetch" href="/assets/js/366.5c57901c.js"><link rel="prefetch" href="/assets/js/367.ad1d6755.js"><link rel="prefetch" href="/assets/js/368.64dc7bec.js"><link rel="prefetch" href="/assets/js/369.406cd3d7.js"><link rel="prefetch" href="/assets/js/37.4f733baf.js"><link rel="prefetch" href="/assets/js/370.750f2303.js"><link rel="prefetch" href="/assets/js/371.6cc0e13d.js"><link rel="prefetch" href="/assets/js/372.ed729131.js"><link rel="prefetch" href="/assets/js/373.c369c4c9.js"><link rel="prefetch" href="/assets/js/374.d3a57fb2.js"><link rel="prefetch" href="/assets/js/375.21d68193.js"><link rel="prefetch" href="/assets/js/376.25d9d5f3.js"><link rel="prefetch" href="/assets/js/377.c7ebd0c2.js"><link rel="prefetch" href="/assets/js/378.c733ec30.js"><link rel="prefetch" href="/assets/js/379.d6cf1c34.js"><link rel="prefetch" href="/assets/js/38.86de11d5.js"><link rel="prefetch" href="/assets/js/380.9abd3090.js"><link rel="prefetch" href="/assets/js/381.1fc3ec03.js"><link rel="prefetch" href="/assets/js/382.d0d2e795.js"><link rel="prefetch" href="/assets/js/383.bd308361.js"><link rel="prefetch" href="/assets/js/384.c2a5969a.js"><link rel="prefetch" href="/assets/js/385.20c11f56.js"><link rel="prefetch" href="/assets/js/386.631b9af2.js"><link rel="prefetch" href="/assets/js/387.8f59e0b5.js"><link rel="prefetch" href="/assets/js/388.5b1951cd.js"><link rel="prefetch" href="/assets/js/389.2e942f96.js"><link rel="prefetch" href="/assets/js/39.153b6ec6.js"><link rel="prefetch" href="/assets/js/390.341a807c.js"><link rel="prefetch" href="/assets/js/391.c9bd676c.js"><link rel="prefetch" href="/assets/js/392.ac05ebea.js"><link rel="prefetch" href="/assets/js/393.6989a857.js"><link rel="prefetch" href="/assets/js/394.744402ae.js"><link rel="prefetch" href="/assets/js/395.a0636831.js"><link rel="prefetch" href="/assets/js/396.9e92309a.js"><link rel="prefetch" href="/assets/js/397.867afb5d.js"><link rel="prefetch" href="/assets/js/398.261fe9bc.js"><link rel="prefetch" href="/assets/js/399.83573ac7.js"><link rel="prefetch" href="/assets/js/4.1b11a2b1.js"><link rel="prefetch" href="/assets/js/40.77cd485e.js"><link rel="prefetch" href="/assets/js/400.333909ad.js"><link rel="prefetch" href="/assets/js/401.9c9ae0ae.js"><link rel="prefetch" href="/assets/js/402.50b49502.js"><link rel="prefetch" href="/assets/js/403.c0d1aa14.js"><link rel="prefetch" href="/assets/js/404.24e4f5ba.js"><link rel="prefetch" href="/assets/js/405.09e8422c.js"><link rel="prefetch" href="/assets/js/406.1e91805d.js"><link rel="prefetch" href="/assets/js/407.2393ac65.js"><link rel="prefetch" href="/assets/js/408.e0df89f7.js"><link rel="prefetch" href="/assets/js/409.58e7dc26.js"><link rel="prefetch" href="/assets/js/41.67fda662.js"><link rel="prefetch" href="/assets/js/410.e9c06b6a.js"><link rel="prefetch" href="/assets/js/411.bbe28a09.js"><link rel="prefetch" href="/assets/js/412.44a068c9.js"><link rel="prefetch" href="/assets/js/413.b76704b3.js"><link rel="prefetch" href="/assets/js/414.32590ba0.js"><link rel="prefetch" href="/assets/js/415.60884e6d.js"><link rel="prefetch" href="/assets/js/416.119019d8.js"><link rel="prefetch" href="/assets/js/417.277cf86c.js"><link rel="prefetch" href="/assets/js/418.fb313fbc.js"><link rel="prefetch" href="/assets/js/419.3eba15ec.js"><link rel="prefetch" href="/assets/js/42.7e56f2cd.js"><link rel="prefetch" href="/assets/js/420.c6d3f2a0.js"><link rel="prefetch" href="/assets/js/421.0939406a.js"><link rel="prefetch" href="/assets/js/422.f9975cec.js"><link rel="prefetch" href="/assets/js/423.fb455c5f.js"><link rel="prefetch" href="/assets/js/424.01dea30b.js"><link rel="prefetch" href="/assets/js/425.ae78c193.js"><link rel="prefetch" href="/assets/js/426.01ffc131.js"><link rel="prefetch" href="/assets/js/427.ca692320.js"><link rel="prefetch" href="/assets/js/428.db29a47a.js"><link rel="prefetch" href="/assets/js/429.954aaaf1.js"><link rel="prefetch" href="/assets/js/43.d0246dae.js"><link rel="prefetch" href="/assets/js/430.b2c8abce.js"><link rel="prefetch" href="/assets/js/431.238123f0.js"><link rel="prefetch" href="/assets/js/432.459a70b6.js"><link rel="prefetch" href="/assets/js/433.ec112349.js"><link rel="prefetch" href="/assets/js/434.d11bf56d.js"><link rel="prefetch" href="/assets/js/435.98d79cdc.js"><link rel="prefetch" href="/assets/js/436.78b0e462.js"><link rel="prefetch" href="/assets/js/437.17bafd8b.js"><link rel="prefetch" href="/assets/js/438.462d1929.js"><link rel="prefetch" href="/assets/js/439.1f5c292d.js"><link rel="prefetch" href="/assets/js/44.eb3d088f.js"><link rel="prefetch" href="/assets/js/440.b139dc54.js"><link rel="prefetch" href="/assets/js/441.2fae1d62.js"><link rel="prefetch" href="/assets/js/45.39adc1d2.js"><link rel="prefetch" href="/assets/js/46.93061422.js"><link rel="prefetch" href="/assets/js/47.0dc9e596.js"><link rel="prefetch" href="/assets/js/48.68f070d6.js"><link rel="prefetch" href="/assets/js/49.a29d9572.js"><link rel="prefetch" href="/assets/js/5.37e3a575.js"><link rel="prefetch" href="/assets/js/50.0b46a629.js"><link rel="prefetch" href="/assets/js/51.c7712d08.js"><link rel="prefetch" href="/assets/js/52.8fdf333b.js"><link rel="prefetch" href="/assets/js/53.1e5f8a94.js"><link rel="prefetch" href="/assets/js/54.41216d39.js"><link rel="prefetch" href="/assets/js/55.34d14bf4.js"><link rel="prefetch" href="/assets/js/56.b7d3b6ca.js"><link rel="prefetch" href="/assets/js/57.9646b246.js"><link rel="prefetch" href="/assets/js/58.5446709c.js"><link rel="prefetch" href="/assets/js/59.0fac1fa2.js"><link rel="prefetch" href="/assets/js/6.41004de5.js"><link rel="prefetch" href="/assets/js/60.8a2d1be8.js"><link rel="prefetch" href="/assets/js/61.77eca8ce.js"><link rel="prefetch" href="/assets/js/62.277c8f17.js"><link rel="prefetch" href="/assets/js/63.8b203bb2.js"><link rel="prefetch" href="/assets/js/64.d466d2b9.js"><link rel="prefetch" href="/assets/js/65.7c4cb8d5.js"><link rel="prefetch" href="/assets/js/66.71b38fe1.js"><link rel="prefetch" href="/assets/js/67.e0b107a2.js"><link rel="prefetch" href="/assets/js/68.7d64bb4b.js"><link rel="prefetch" href="/assets/js/69.9cdbcfeb.js"><link rel="prefetch" href="/assets/js/7.67d94aac.js"><link rel="prefetch" href="/assets/js/70.eb1c9224.js"><link rel="prefetch" href="/assets/js/71.51e0c37c.js"><link rel="prefetch" href="/assets/js/72.cba6948f.js"><link rel="prefetch" href="/assets/js/73.6abd4dce.js"><link rel="prefetch" href="/assets/js/74.b5fa6c08.js"><link rel="prefetch" href="/assets/js/75.8f34d79a.js"><link rel="prefetch" href="/assets/js/76.5fc9c80d.js"><link rel="prefetch" href="/assets/js/77.6e4a5e93.js"><link rel="prefetch" href="/assets/js/78.bffd6a40.js"><link rel="prefetch" href="/assets/js/79.1a7f5d0e.js"><link rel="prefetch" href="/assets/js/8.e4995b94.js"><link rel="prefetch" href="/assets/js/80.b70c1106.js"><link rel="prefetch" href="/assets/js/81.4476a49e.js"><link rel="prefetch" href="/assets/js/82.f40aa218.js"><link rel="prefetch" href="/assets/js/83.d4c57d4f.js"><link rel="prefetch" href="/assets/js/84.d1dc86f7.js"><link rel="prefetch" href="/assets/js/85.dd779a2e.js"><link rel="prefetch" href="/assets/js/86.569cfbc2.js"><link rel="prefetch" href="/assets/js/87.938a5bd8.js"><link rel="prefetch" href="/assets/js/88.2d3dadd7.js"><link rel="prefetch" href="/assets/js/89.3aeee704.js"><link rel="prefetch" href="/assets/js/9.54a41cce.js"><link rel="prefetch" href="/assets/js/90.2b47965b.js"><link rel="prefetch" href="/assets/js/91.58aa3587.js"><link rel="prefetch" href="/assets/js/92.47d2a191.js"><link rel="prefetch" href="/assets/js/93.ff10ac69.js"><link rel="prefetch" href="/assets/js/94.a8d90c0c.js"><link rel="prefetch" href="/assets/js/95.15ae9c48.js"><link rel="prefetch" href="/assets/js/96.43aa4adb.js"><link rel="prefetch" href="/assets/js/97.4eb74c93.js"><link rel="prefetch" href="/assets/js/98.94686ad8.js"><link rel="prefetch" href="/assets/js/99.ceb4f2f1.js">
    <link rel="stylesheet" href="/assets/css/0.styles.32e41c9b.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">TaoPoppy</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/learnMaterials/" class="nav-link">资料</a></div><div class="nav-item"><a href="https://github.com/taopoppy/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="/construct/" class="nav-link">小技巧</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">小程序</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/WeiXin-Rumen/" class="nav-link">微信小程序入门和实战</a></li><li class="dropdown-item"><!----> <a href="/Weixin-quanzhan/" class="nav-link">微信小程序全栈开发实战</a></li><li class="dropdown-item"><!----> <a href="/WeiXin-Combat/" class="nav-link">微信小程序云开发实战</a></li><li class="dropdown-item"><!----> <a href="/WeiXin-money/" class="nav-link">微信支付和分享</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">工具系列</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Jest/" class="nav-link">前端自动化测试</a></li><li class="dropdown-item"><!----> <a href="/Webpack/" class="nav-link">前端工程化</a></li><li class="dropdown-item"><!----> <a href="/Optimization/" class="nav-link">前端性能优化</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Go</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/go/" class="nav-link">go语言入门实践</a></li><li class="dropdown-item"><!----> <a href="/go-concurrent/" class="nav-link">go并发编程详解</a></li><li class="dropdown-item"><!----> <a href="/go-web/" class="nav-link">go与web编程实战</a></li><li class="dropdown-item"><!----> <a href="/go-reptile/" class="nav-link">go爬虫编程实战</a></li><li class="dropdown-item"><!----> <a href="/Beego/" class="nav-link">Beego框架入门</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">node</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/node/" class="nav-link">node入门</a></li><li class="dropdown-item"><!----> <a href="/node-RESTful/" class="nav-link">node与RESTful</a></li><li class="dropdown-item"><!----> <a href="/node-GraphQL/" class="nav-link router-link-active">node与GraphQL</a></li><li class="dropdown-item"><!----> <a href="/node-BFF/" class="nav-link">node与BFF</a></li><li class="dropdown-item"><!----> <a href="/node-blog/" class="nav-link">node博客后台</a></li><li class="dropdown-item"><!----> <a href="/node-weibo/" class="nav-link">node实战微博</a></li><li class="dropdown-item"><!----> <a href="/node-microService/" class="nav-link">node微服务</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">react</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/react-redux/" class="nav-link">React+Redux入门详解</a></li><li class="dropdown-item"><!----> <a href="/react-typescript/" class="nav-link">React+TypeScript的完美结合</a></li><li class="dropdown-item"><!----> <a href="/react-webapp/" class="nav-link">React网易云Webapp</a></li><li class="dropdown-item"><!----> <a href="/react-ssr/" class="nav-link">React服务器渲染原理解析</a></li><li class="dropdown-item"><!----> <a href="/react-source/" class="nav-link">React深度剖析和源码解析</a></li><li class="dropdown-item"><!----> <a href="/react-antd/" class="nav-link">React+Typescript开发组件库</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">vue</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vue-ssr/" class="nav-link">Vue服务端渲染原理解析</a></li><li class="dropdown-item"><!----> <a href="/vue-interview/" class="nav-link">Vue3入门和实践</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">后端系列</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>数据库</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/Mysql/" class="nav-link">mysql</a></li><li class="dropdown-subitem"><a href="/Mysql-Architecture/" class="nav-link">mysql-Architecture</a></li></ul></li><li class="dropdown-item"><h4>linux操作系统</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/Linux/" class="nav-link">linux</a></li><li class="dropdown-subitem"><a href="/Linux-Architecture/" class="nav-link">linux-Architecture</a></li></ul></li><li class="dropdown-item"><h4>网络协议</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/Protocol/" class="nav-link">protocol</a></li><li class="dropdown-subitem"><a href="/node-GraphQL/font-end-protocol.html" class="nav-link">font-end-protocol</a></li></ul></li><li class="dropdown-item"><h4>运维系统</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/prometheus/" class="nav-link">prometheus</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">前端系列</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Front-end/" class="nav-link">前端初级面试</a></li><li class="dropdown-item"><!----> <a href="/Front-advance/" class="nav-link">前端中级面试</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">究极全栈</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Big-Front-End/" class="nav-link">大前端</a></li><li class="dropdown-item"><!----> <a href="/Web-Architect/" class="nav-link">web架构课</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/learnMaterials/" class="nav-link">资料</a></div><div class="nav-item"><a href="https://github.com/taopoppy/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="/construct/" class="nav-link">小技巧</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">小程序</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/WeiXin-Rumen/" class="nav-link">微信小程序入门和实战</a></li><li class="dropdown-item"><!----> <a href="/Weixin-quanzhan/" class="nav-link">微信小程序全栈开发实战</a></li><li class="dropdown-item"><!----> <a href="/WeiXin-Combat/" class="nav-link">微信小程序云开发实战</a></li><li class="dropdown-item"><!----> <a href="/WeiXin-money/" class="nav-link">微信支付和分享</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">工具系列</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Jest/" class="nav-link">前端自动化测试</a></li><li class="dropdown-item"><!----> <a href="/Webpack/" class="nav-link">前端工程化</a></li><li class="dropdown-item"><!----> <a href="/Optimization/" class="nav-link">前端性能优化</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Go</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/go/" class="nav-link">go语言入门实践</a></li><li class="dropdown-item"><!----> <a href="/go-concurrent/" class="nav-link">go并发编程详解</a></li><li class="dropdown-item"><!----> <a href="/go-web/" class="nav-link">go与web编程实战</a></li><li class="dropdown-item"><!----> <a href="/go-reptile/" class="nav-link">go爬虫编程实战</a></li><li class="dropdown-item"><!----> <a href="/Beego/" class="nav-link">Beego框架入门</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">node</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/node/" class="nav-link">node入门</a></li><li class="dropdown-item"><!----> <a href="/node-RESTful/" class="nav-link">node与RESTful</a></li><li class="dropdown-item"><!----> <a href="/node-GraphQL/" class="nav-link router-link-active">node与GraphQL</a></li><li class="dropdown-item"><!----> <a href="/node-BFF/" class="nav-link">node与BFF</a></li><li class="dropdown-item"><!----> <a href="/node-blog/" class="nav-link">node博客后台</a></li><li class="dropdown-item"><!----> <a href="/node-weibo/" class="nav-link">node实战微博</a></li><li class="dropdown-item"><!----> <a href="/node-microService/" class="nav-link">node微服务</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">react</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/react-redux/" class="nav-link">React+Redux入门详解</a></li><li class="dropdown-item"><!----> <a href="/react-typescript/" class="nav-link">React+TypeScript的完美结合</a></li><li class="dropdown-item"><!----> <a href="/react-webapp/" class="nav-link">React网易云Webapp</a></li><li class="dropdown-item"><!----> <a href="/react-ssr/" class="nav-link">React服务器渲染原理解析</a></li><li class="dropdown-item"><!----> <a href="/react-source/" class="nav-link">React深度剖析和源码解析</a></li><li class="dropdown-item"><!----> <a href="/react-antd/" class="nav-link">React+Typescript开发组件库</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">vue</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vue-ssr/" class="nav-link">Vue服务端渲染原理解析</a></li><li class="dropdown-item"><!----> <a href="/vue-interview/" class="nav-link">Vue3入门和实践</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">后端系列</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>数据库</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/Mysql/" class="nav-link">mysql</a></li><li class="dropdown-subitem"><a href="/Mysql-Architecture/" class="nav-link">mysql-Architecture</a></li></ul></li><li class="dropdown-item"><h4>linux操作系统</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/Linux/" class="nav-link">linux</a></li><li class="dropdown-subitem"><a href="/Linux-Architecture/" class="nav-link">linux-Architecture</a></li></ul></li><li class="dropdown-item"><h4>网络协议</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/Protocol/" class="nav-link">protocol</a></li><li class="dropdown-subitem"><a href="/node-GraphQL/font-end-protocol.html" class="nav-link">font-end-protocol</a></li></ul></li><li class="dropdown-item"><h4>运维系统</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/prometheus/" class="nav-link">prometheus</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">前端系列</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Front-end/" class="nav-link">前端初级面试</a></li><li class="dropdown-item"><!----> <a href="/Front-advance/" class="nav-link">前端中级面试</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">究极全栈</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Big-Front-End/" class="nav-link">大前端</a></li><li class="dropdown-item"><!----> <a href="/Web-Architect/" class="nav-link">web架构课</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/node-GraphQL/" class="sidebar-link">Node-GraphQL</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>GraphQL-基础</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Graphql-全栈入门</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/node-GraphQL/GraphQL-fullstack-express.html" class="sidebar-link">Express搭建服务器</a></li><li><a href="/node-GraphQL/GraphQL-fullstack-mongodb.html" class="sidebar-link">使用mongodb存储数据</a></li><li><a href="/node-GraphQL/GraphQL-fullstack-react-apollo.html" class="active sidebar-link">完整代码</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/node-GraphQL/GraphQL-fullstack-react-apollo.html#index-js" class="sidebar-link">index.js</a></li><li class="sidebar-sub-header"><a href="/node-GraphQL/GraphQL-fullstack-react-apollo.html#config-js" class="sidebar-link">config.js</a></li><li class="sidebar-sub-header"><a href="/node-GraphQL/GraphQL-fullstack-react-apollo.html#schema-graphql" class="sidebar-link">schema.graphql</a></li><li class="sidebar-sub-header"><a href="/node-GraphQL/GraphQL-fullstack-react-apollo.html#resolvers" class="sidebar-link">resolvers</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/node-GraphQL/GraphQL-fullstack-react-apollo.html#comment-js" class="sidebar-link">Comment.js</a></li><li class="sidebar-sub-header"><a href="/node-GraphQL/GraphQL-fullstack-react-apollo.html#mutation-js" class="sidebar-link">Mutation.js</a></li><li class="sidebar-sub-header"><a href="/node-GraphQL/GraphQL-fullstack-react-apollo.html#post-js" class="sidebar-link">Post.js</a></li><li class="sidebar-sub-header"><a href="/node-GraphQL/GraphQL-fullstack-react-apollo.html#query-js" class="sidebar-link">Query.js</a></li><li class="sidebar-sub-header"><a href="/node-GraphQL/GraphQL-fullstack-react-apollo.html#subscription-js" class="sidebar-link">Subscription.js</a></li><li class="sidebar-sub-header"><a href="/node-GraphQL/GraphQL-fullstack-react-apollo.html#user-js" class="sidebar-link">User.js</a></li></ul></li><li class="sidebar-sub-header"><a href="/node-GraphQL/GraphQL-fullstack-react-apollo.html#models" class="sidebar-link">models</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/node-GraphQL/GraphQL-fullstack-react-apollo.html#comment-js-2" class="sidebar-link">Comment.js</a></li><li class="sidebar-sub-header"><a href="/node-GraphQL/GraphQL-fullstack-react-apollo.html#index" class="sidebar-link">index</a></li><li class="sidebar-sub-header"><a href="/node-GraphQL/GraphQL-fullstack-react-apollo.html#post-js-2" class="sidebar-link">Post.js</a></li><li class="sidebar-sub-header"><a href="/node-GraphQL/GraphQL-fullstack-react-apollo.html#user-js-2" class="sidebar-link">User.js</a></li></ul></li><li class="sidebar-sub-header"><a href="/node-GraphQL/GraphQL-fullstack-react-apollo.html#middleware" class="sidebar-link">middleware</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/node-GraphQL/GraphQL-fullstack-react-apollo.html#auth-js" class="sidebar-link">auth.js</a></li></ul></li><li class="sidebar-sub-header"><a href="/node-GraphQL/GraphQL-fullstack-react-apollo.html#db" class="sidebar-link">db</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/node-GraphQL/GraphQL-fullstack-react-apollo.html#index-js-2" class="sidebar-link">index.js</a></li></ul></li><li class="sidebar-sub-header"><a href="/node-GraphQL/GraphQL-fullstack-react-apollo.html#controller" class="sidebar-link">controller</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/node-GraphQL/GraphQL-fullstack-react-apollo.html#index-js-3" class="sidebar-link">index.js</a></li><li class="sidebar-sub-header"><a href="/node-GraphQL/GraphQL-fullstack-react-apollo.html#downloadcontroller-js" class="sidebar-link">downloadController.js</a></li><li class="sidebar-sub-header"><a href="/node-GraphQL/GraphQL-fullstack-react-apollo.html#qrimagecontroller-js" class="sidebar-link">qrImageController.js</a></li><li class="sidebar-sub-header"><a href="/node-GraphQL/GraphQL-fullstack-react-apollo.html#uploadercontroller-js" class="sidebar-link">upLoaderController.js</a></li></ul></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="完整代码"><a href="#完整代码" aria-hidden="true" class="header-anchor">#</a> 完整代码</h1> <p>有了前面的基础，我们来自己整一个比较完整的项目，我们的项目文件都<a href="https://github.com/taopoppy/node-graphql-api/tree/main/src" target="_blank" rel="noopener noreferrer">github<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>上，可以自行查看，我们列出目录</p> <ul><li><font color="#1E90FF">controller</font> <ul><li><font color="#1E90FF">downloadController.js</font></li> <li><font color="#1E90FF">index.js</font></li> <li><font color="#1E90FF">qrImageController.js</font></li> <li><font color="#1E90FF">upLoaderController.js</font></li></ul></li> <li><font color="#1E90FF">db</font> <ul><li><font color="#1E90FF">index.js</font></li></ul></li> <li><font color="#1E90FF">middleware</font> <ul><li><font color="#1E90FF">auth.js</font></li></ul></li> <li><font color="#1E90FF">models</font> <ul><li><font color="#1E90FF">Comment.js</font></li> <li><font color="#1E90FF">Post.js</font></li> <li><font color="#1E90FF">User.js</font></li> <li><font color="#1E90FF">index.js</font></li></ul></li> <li><font color="#1E90FF">resolvers</font> <ul><li><font color="#1E90FF">Comment.js</font></li> <li><font color="#1E90FF">Mutation.js</font></li> <li><font color="#1E90FF">Post.js</font></li> <li><font color="#1E90FF">Query.js</font></li> <li><font color="#1E90FF">Subscription.js</font></li> <li><font color="#1E90FF">User.js</font></li></ul></li> <li><font color="#1E90FF">config.js</font></li> <li><font color="#1E90FF">index.js</font></li> <li><font color="#1E90FF">schema.graphql</font></li></ul> <h2 id="index-js"><a href="#index-js" aria-hidden="true" class="header-anchor">#</a> index.js</h2> <p>项目的入口文件，注释都有详细的说明，对于<code>GraphQL</code>服务，有些功能无法通过<code>json</code>进行请求和响应，还好<code>graphiql-yoga</code>是通过集成<code>express</code>和<code>apollo-server</code>的项目，我们可以将<code>express</code>对象进行抽离。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// src/index.js</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> GraphQLServer<span class="token punctuation">,</span> PubSub <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'graphql-yoga'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> connectDB <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./db/index'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> Query <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./resolvers/Query'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> Comment <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./resolvers/Comment'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> Mutation <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./resolvers/Mutation'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> Post <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./resolvers/Post'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> User <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./resolvers/User'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> Subscription <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./resolvers/Subscription'</span><span class="token punctuation">)</span>

<span class="token comment">// 文件上传库</span>
<span class="token keyword">const</span> multer  <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'multer'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> upload <span class="token operator">=</span> <span class="token function">multer</span><span class="token punctuation">(</span><span class="token punctuation">{</span> dest<span class="token punctuation">:</span> <span class="token string">'public'</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment">// 文件储存路径</span>

<span class="token comment">// 引入resuful风格的处理器</span>
<span class="token keyword">const</span> Controller <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./controller/index'</span><span class="token punctuation">)</span>
<span class="token comment">// 订阅实现</span>
<span class="token keyword">const</span> pubsub <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PubSub</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// Resolvers(函数实现)</span>
<span class="token keyword">const</span> resolvers<span class="token operator">=</span> <span class="token punctuation">{</span>
	Comment<span class="token punctuation">,</span>
	User<span class="token punctuation">,</span>
	Post<span class="token punctuation">,</span>
	Query<span class="token punctuation">,</span>
	Mutation<span class="token punctuation">,</span>
	Subscription
<span class="token punctuation">}</span>

<span class="token comment">// 创建Graphql服务器</span>
<span class="token keyword">const</span> server <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">GraphQLServer</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
	typeDefs<span class="token punctuation">:</span><span class="token string">'./src/schema.graphql'</span><span class="token punctuation">,</span>
	<span class="token function-variable function">context</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token parameter">req</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
		pubsub<span class="token punctuation">,</span>
		req
	<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	resolvers<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// 连接数据库</span>
<span class="token function">connectDB</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// 设置跨域</span>
server<span class="token punctuation">.</span>express<span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token string">'*'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token string">&quot;Access-Control-Allow-Origin&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;*&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  res<span class="token punctuation">.</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token string">&quot;Access-Control-Allow-Headers&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;X-Requested-With&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  res<span class="token punctuation">.</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token string">&quot;Access-Control-Allow-Methods&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;PUT,POST,GET,DELETE,OPTIONS&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  res<span class="token punctuation">.</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token string">&quot;X-Powered-By&quot;</span><span class="token punctuation">,</span><span class="token string">' 3.2.1'</span><span class="token punctuation">)</span>
  res<span class="token punctuation">.</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token string">&quot;Content-Type&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;application/json;charset=utf-8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

server<span class="token punctuation">.</span>express<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">'/static'</span><span class="token punctuation">,</span> express<span class="token punctuation">.</span><span class="token function">static</span><span class="token punctuation">(</span><span class="token string">'public'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 静态资源访问</span>
server<span class="token punctuation">.</span>express<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>express<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// for parsing application/json</span>
server<span class="token punctuation">.</span>express<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>express<span class="token punctuation">.</span><span class="token function">urlencoded</span><span class="token punctuation">(</span><span class="token punctuation">{</span> extended<span class="token punctuation">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// for parsing application/x-www-form-urlencoded</span>

<span class="token comment">// restful 风格的路由</span>
server<span class="token punctuation">.</span>express<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/api/qrImage'</span><span class="token punctuation">,</span> Controller<span class="token punctuation">.</span>qrImageController<span class="token punctuation">)</span> <span class="token comment">// 生成二维码返回</span>
server<span class="token punctuation">.</span>express<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/api/uploader'</span><span class="token punctuation">,</span>upload<span class="token punctuation">.</span><span class="token function">array</span><span class="token punctuation">(</span><span class="token string">'images'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Controller<span class="token punctuation">.</span>upLoaderController<span class="token punctuation">)</span> <span class="token comment">// 上传多张图片</span>
server<span class="token punctuation">.</span>express<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/api/image/:id'</span><span class="token punctuation">,</span> Controller<span class="token punctuation">.</span>downloadController<span class="token punctuation">)</span> <span class="token comment">// 下载图片</span>

server<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;Server is running on localhost:4000&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="config-js"><a href="#config-js" aria-hidden="true" class="header-anchor">#</a> config.js</h2> <p>配置文件，一般我们其实是不采用这样的方式，我们通常会使用<code>dotenv</code>来配置，具体的你可以自己去<code>gihub</code>研究一下：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// config.js</span>
<span class="token keyword">const</span> <span class="token constant">MONGO_URI</span><span class="token operator">=</span><span class="token string">&quot;mongodb+srv://taopoppy:tao3941319=-=@cluster0.tnzd7.mongodb.net/myFirstDatabase?retryWrites=true&amp;w=majority&quot;</span>
<span class="token comment">//const MONGO_URI = &quot;mongodb://localhost:27017/graphql&quot;</span>
<span class="token keyword">const</span> <span class="token constant">JWT_SECRET</span><span class="token operator">=</span><span class="token string">&quot;123456&quot;</span>
<span class="token keyword">const</span> <span class="token constant">JWT_EXPIRES_IN</span><span class="token operator">=</span><span class="token string">&quot;30 days&quot;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
	<span class="token constant">MONGO_URI</span><span class="token punctuation">,</span>
	<span class="token constant">JWT_SECRET</span><span class="token punctuation">,</span>
	<span class="token constant">JWT_EXPIRES_IN</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="schema-graphql"><a href="#schema-graphql" aria-hidden="true" class="header-anchor">#</a> schema.graphql</h2> <div class="language-graphql extra-class"><pre class="language-graphql"><code><span class="token comment"># 根查询</span>
<span class="token keyword">type</span> <span class="token class-name">Query</span><span class="token punctuation">{</span>
	<span class="token attr-name">users</span><span class="token punctuation">(</span><span class="token attr-name">query</span><span class="token punctuation">:</span>String<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">[</span>User<span class="token operator">!</span><span class="token punctuation">]</span><span class="token operator">!</span>
	<span class="token attr-name">posts</span><span class="token punctuation">(</span><span class="token attr-name">query</span><span class="token punctuation">:</span>String<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>Post<span class="token punctuation">]</span><span class="token operator">!</span>
	<span class="token attr-name">comments</span><span class="token punctuation">(</span><span class="token attr-name">query</span><span class="token punctuation">:</span>String<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">[</span>Comment<span class="token operator">!</span><span class="token punctuation">]</span><span class="token operator">!</span>
<span class="token punctuation">}</span>

<span class="token comment">#根突变</span>
<span class="token keyword">type</span> <span class="token class-name">Mutation</span><span class="token punctuation">{</span>
	<span class="token attr-name">login</span><span class="token punctuation">(</span><span class="token attr-name">data</span><span class="token punctuation">:</span>LoginInput<span class="token operator">!</span><span class="token punctuation">)</span><span class="token punctuation">:</span>LoginResponse<span class="token operator">!</span>
	<span class="token attr-name">createUser</span><span class="token punctuation">(</span><span class="token attr-name">data</span><span class="token punctuation">:</span>CreateUserInput<span class="token operator">!</span><span class="token punctuation">)</span><span class="token punctuation">:</span>User<span class="token operator">!</span>
	<span class="token attr-name">createPost</span><span class="token punctuation">(</span><span class="token attr-name">data</span><span class="token punctuation">:</span>CreatePostInput<span class="token operator">!</span><span class="token punctuation">)</span><span class="token punctuation">:</span>Post<span class="token operator">!</span>
	<span class="token attr-name">createComment</span><span class="token punctuation">(</span><span class="token attr-name">data</span><span class="token punctuation">:</span>CreateCommentInput<span class="token operator">!</span><span class="token punctuation">)</span><span class="token punctuation">:</span>Comment<span class="token operator">!</span>
	<span class="token attr-name">deleteUser</span><span class="token punctuation">(</span><span class="token attr-name">userid</span><span class="token punctuation">:</span>ID<span class="token operator">!</span><span class="token punctuation">)</span><span class="token punctuation">:</span>User<span class="token operator">!</span>
	<span class="token attr-name">deletePost</span><span class="token punctuation">(</span><span class="token attr-name">postid</span><span class="token punctuation">:</span>ID<span class="token operator">!</span><span class="token punctuation">)</span><span class="token punctuation">:</span>Post<span class="token operator">!</span>
	<span class="token attr-name">deleteComment</span><span class="token punctuation">(</span><span class="token attr-name">commentid</span><span class="token punctuation">:</span>ID<span class="token operator">!</span><span class="token punctuation">)</span><span class="token punctuation">:</span>Comment<span class="token operator">!</span>
	<span class="token attr-name">updateUser</span><span class="token punctuation">(</span><span class="token attr-name">data</span><span class="token punctuation">:</span>UpdateUserInput<span class="token operator">!</span><span class="token punctuation">)</span><span class="token punctuation">:</span>User<span class="token operator">!</span>
	<span class="token attr-name">updatePost</span><span class="token punctuation">(</span><span class="token attr-name">postid</span><span class="token punctuation">:</span>ID<span class="token operator">!</span><span class="token punctuation">,</span><span class="token attr-name">data</span><span class="token punctuation">:</span>UpdatePostInput<span class="token operator">!</span><span class="token punctuation">)</span><span class="token punctuation">:</span>Post<span class="token operator">!</span>
	<span class="token attr-name">updateComment</span><span class="token punctuation">(</span><span class="token attr-name">commentid</span><span class="token punctuation">:</span>ID<span class="token operator">!</span><span class="token punctuation">,</span><span class="token attr-name">data</span><span class="token punctuation">:</span>UpdateCommentInput<span class="token operator">!</span><span class="token punctuation">)</span><span class="token punctuation">:</span>Comment<span class="token operator">!</span>
<span class="token punctuation">}</span>

<span class="token comment"># 登录返回响应类型</span>
<span class="token keyword">type</span> <span class="token class-name">LoginResponse</span><span class="token punctuation">{</span>
	<span class="token attr-name">message</span><span class="token punctuation">:</span> String<span class="token operator">!</span>
	<span class="token attr-name">user</span><span class="token punctuation">:</span>User
	<span class="token attr-name">token</span><span class="token punctuation">:</span> String
<span class="token punctuation">}</span>
<span class="token comment">#订阅类型</span>
<span class="token keyword">type</span> <span class="token class-name">Subscription</span><span class="token punctuation">{</span>
	<span class="token attr-name">comment</span><span class="token punctuation">(</span><span class="token attr-name">postId</span><span class="token punctuation">:</span>ID<span class="token operator">!</span><span class="token punctuation">)</span><span class="token punctuation">:</span>commentSubscriptionPayload<span class="token operator">!</span>
	<span class="token attr-name">post</span><span class="token punctuation">:</span>postSubscriptionPayload<span class="token operator">!</span>
<span class="token punctuation">}</span>
<span class="token comment">#文章订阅</span>
<span class="token keyword">type</span> <span class="token class-name">postSubscriptionPayload</span><span class="token punctuation">{</span>
	<span class="token attr-name">mutation</span><span class="token punctuation">:</span>MutationType<span class="token operator">!</span>
	<span class="token attr-name">data</span><span class="token punctuation">:</span>Post<span class="token operator">!</span>
<span class="token punctuation">}</span>
<span class="token keyword">type</span> <span class="token class-name">commentSubscriptionPayload</span><span class="token punctuation">{</span>
	<span class="token attr-name">mutation</span><span class="token punctuation">:</span>MutationType<span class="token operator">!</span>
	<span class="token attr-name">data</span><span class="token punctuation">:</span>Comment<span class="token operator">!</span>
<span class="token punctuation">}</span>
<span class="token comment">#MutationType当中定义的就是字符串</span>
<span class="token keyword">enum</span> <span class="token class-name">MutationType</span><span class="token punctuation">{</span>
	<span class="token constant">CREATED</span>
	<span class="token constant">UPDATED</span>
	<span class="token constant">DELETED</span>
<span class="token punctuation">}</span>
<span class="token comment">#登录输入类型</span>
<span class="token keyword">input</span> LoginInput<span class="token punctuation">{</span>
	<span class="token attr-name">email</span><span class="token punctuation">:</span> String<span class="token operator">!</span>
	<span class="token attr-name">password</span><span class="token punctuation">:</span> String<span class="token operator">!</span>
<span class="token punctuation">}</span>

<span class="token comment">#更新评论输入类型</span>
<span class="token keyword">input</span> UpdateCommentInput<span class="token punctuation">{</span>
	<span class="token attr-name">text</span><span class="token punctuation">:</span> String
<span class="token punctuation">}</span>

<span class="token comment">#更新文章输入类型</span>
<span class="token keyword">input</span> UpdatePostInput<span class="token punctuation">{</span>
	<span class="token attr-name">title</span><span class="token punctuation">:</span>String
	<span class="token attr-name">body</span><span class="token punctuation">:</span>String
	<span class="token attr-name">published</span><span class="token punctuation">:</span>Boolean
<span class="token punctuation">}</span>
<span class="token comment">#更新用户输入类型</span>
<span class="token keyword">input</span> UpdateUserInput<span class="token punctuation">{</span>
	<span class="token attr-name">username</span><span class="token punctuation">:</span>String
	<span class="token attr-name">email</span><span class="token punctuation">:</span>String
	<span class="token attr-name">age</span><span class="token punctuation">:</span>Int
	<span class="token attr-name">password</span><span class="token punctuation">:</span>String
<span class="token punctuation">}</span>
<span class="token comment">#创建用户的输入类型</span>
<span class="token keyword">input</span> CreateUserInput<span class="token punctuation">{</span>
	<span class="token attr-name">username</span><span class="token punctuation">:</span>String<span class="token operator">!</span>
	<span class="token attr-name">email</span><span class="token punctuation">:</span>String<span class="token operator">!</span>
	<span class="token attr-name">age</span><span class="token punctuation">:</span>Int
	<span class="token attr-name">password</span><span class="token punctuation">:</span>String<span class="token operator">!</span>
<span class="token punctuation">}</span>
<span class="token comment">#创建文章的输入类型</span>
<span class="token keyword">input</span> CreatePostInput<span class="token punctuation">{</span>
	<span class="token attr-name">title</span><span class="token punctuation">:</span>String<span class="token operator">!</span>
	<span class="token attr-name">body</span><span class="token punctuation">:</span>String<span class="token operator">!</span>
	<span class="token attr-name">published</span><span class="token punctuation">:</span>Boolean<span class="token operator">!</span>
<span class="token punctuation">}</span>
<span class="token comment">#创建评论的输入类型</span>
<span class="token keyword">input</span> CreateCommentInput<span class="token punctuation">{</span>
	<span class="token attr-name">text</span><span class="token punctuation">:</span>String<span class="token operator">!</span>
	<span class="token attr-name">post</span><span class="token punctuation">:</span>ID<span class="token operator">!</span>
<span class="token punctuation">}</span>
<span class="token comment">#用户类型</span>
<span class="token keyword">type</span> <span class="token class-name">User</span><span class="token punctuation">{</span>
	<span class="token attr-name">id</span><span class="token punctuation">:</span>ID<span class="token operator">!</span>
	<span class="token attr-name">username</span><span class="token punctuation">:</span>String<span class="token operator">!</span>
	<span class="token attr-name">email</span><span class="token punctuation">:</span>String<span class="token operator">!</span>
	<span class="token attr-name">age</span><span class="token punctuation">:</span>Int
	<span class="token attr-name">posts</span><span class="token punctuation">:</span><span class="token punctuation">[</span>Post<span class="token punctuation">]</span><span class="token operator">!</span>
	<span class="token attr-name">comments</span><span class="token punctuation">:</span><span class="token punctuation">[</span>Comment<span class="token operator">!</span><span class="token punctuation">]</span><span class="token operator">!</span>
<span class="token punctuation">}</span>
<span class="token comment">#文章类型</span>
<span class="token keyword">type</span> <span class="token class-name">Post</span><span class="token punctuation">{</span>
	<span class="token attr-name">id</span><span class="token punctuation">:</span>ID<span class="token operator">!</span>
	<span class="token attr-name">title</span><span class="token punctuation">:</span>String<span class="token operator">!</span>
	<span class="token attr-name">body</span><span class="token punctuation">:</span>String<span class="token operator">!</span>
	<span class="token attr-name">published</span><span class="token punctuation">:</span>Boolean<span class="token operator">!</span>
	<span class="token attr-name">author</span><span class="token punctuation">:</span>User<span class="token operator">!</span>
	<span class="token attr-name">comments</span><span class="token punctuation">:</span><span class="token punctuation">[</span>Comment<span class="token punctuation">]</span><span class="token operator">!</span>
<span class="token punctuation">}</span>
<span class="token comment">#评论类型</span>
<span class="token keyword">type</span> <span class="token class-name">Comment</span><span class="token punctuation">{</span>
	<span class="token attr-name">id</span><span class="token punctuation">:</span>ID<span class="token operator">!</span>
	<span class="token attr-name">text</span><span class="token punctuation">:</span> String<span class="token operator">!</span>
	<span class="token attr-name">author</span><span class="token punctuation">:</span>User<span class="token operator">!</span>
	<span class="token attr-name">post</span><span class="token punctuation">:</span>Post<span class="token operator">!</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="resolvers"><a href="#resolvers" aria-hidden="true" class="header-anchor">#</a> resolvers</h2> <h3 id="comment-js"><a href="#comment-js" aria-hidden="true" class="header-anchor">#</a> Comment.js</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// src/resolvers/Comment.js</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> UserModel<span class="token punctuation">,</span> PostModel <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'../models/index'</span><span class="token punctuation">)</span>


<span class="token keyword">const</span> Comment <span class="token operator">=</span> <span class="token punctuation">{</span>
	<span class="token comment">// 根据authorId查看用户（完成）</span>
	<span class="token keyword">async</span> <span class="token function">author</span><span class="token punctuation">(</span><span class="token parameter">parent<span class="token punctuation">,</span> args<span class="token punctuation">,</span> ctx<span class="token punctuation">,</span> info</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">const</span> author <span class="token operator">=</span> <span class="token keyword">await</span> UserModel<span class="token punctuation">.</span><span class="token function">findById</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
			_id<span class="token punctuation">:</span> parent<span class="token punctuation">.</span>authorId
		<span class="token punctuation">}</span><span class="token punctuation">)</span>
		<span class="token keyword">return</span> author
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token comment">// 根据postId查看评论所在的文章（完成）</span>
	<span class="token keyword">async</span> <span class="token function">post</span><span class="token punctuation">(</span><span class="token parameter">parent<span class="token punctuation">,</span> args<span class="token punctuation">,</span> ctx<span class="token punctuation">,</span> info</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">const</span> post <span class="token operator">=</span> <span class="token keyword">await</span> PostModel<span class="token punctuation">.</span><span class="token function">findById</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
			_id<span class="token punctuation">:</span> parent<span class="token punctuation">.</span>postId
		<span class="token punctuation">}</span><span class="token punctuation">)</span>
		<span class="token keyword">return</span> post
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
	Comment
<span class="token punctuation">}</span>
</code></pre></div><h3 id="mutation-js"><a href="#mutation-js" aria-hidden="true" class="header-anchor">#</a> Mutation.js</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// src/resolvers/Mutation.js</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> v4<span class="token punctuation">:</span> uuidv4 <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'uuid'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> UserModel<span class="token punctuation">,</span> PostModel<span class="token punctuation">,</span> CommentModel<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'../models/index.js'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> createJwtToken<span class="token punctuation">,</span> authenticate <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'../middleware/auth'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> User <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'../models/User.js'</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> Mutation <span class="token operator">=</span> <span class="token punctuation">{</span>
	<span class="token comment">// 登录（完成）</span>
	<span class="token keyword">async</span> <span class="token function">login</span><span class="token punctuation">(</span><span class="token parameter">parent<span class="token punctuation">,</span> args<span class="token punctuation">,</span> ctx<span class="token punctuation">,</span> info</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">const</span> <span class="token punctuation">{</span> data <span class="token punctuation">}</span> <span class="token operator">=</span> args
		<span class="token keyword">const</span> <span class="token punctuation">{</span> email<span class="token punctuation">,</span> password <span class="token punctuation">}</span> <span class="token operator">=</span> data
		<span class="token keyword">const</span> user <span class="token operator">=</span> <span class="token keyword">await</span> UserModel<span class="token punctuation">.</span><span class="token function">findOne</span><span class="token punctuation">(</span><span class="token punctuation">{</span>email<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token string">&quot;+password&quot;</span><span class="token punctuation">)</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>user <span class="token operator">||</span> user<span class="token punctuation">.</span>password <span class="token operator">!==</span> password<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">&quot;用户名或者密码错误&quot;</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span>
		<span class="token comment">// 登录要返回一个token</span>
		<span class="token keyword">const</span> token <span class="token operator">=</span> <span class="token function">createJwtToken</span><span class="token punctuation">(</span><span class="token punctuation">{</span>id<span class="token punctuation">:</span>user<span class="token punctuation">.</span>_id<span class="token punctuation">,</span>email<span class="token punctuation">:</span>user<span class="token punctuation">.</span>email<span class="token punctuation">}</span><span class="token punctuation">)</span>
		<span class="token keyword">return</span> <span class="token punctuation">{</span>
			message<span class="token punctuation">:</span> <span class="token string">&quot;login successfully&quot;</span><span class="token punctuation">,</span>
			user<span class="token punctuation">,</span>
			token
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token comment">// 创建新用户（完成）</span>
	<span class="token keyword">async</span> <span class="token function">createUser</span><span class="token punctuation">(</span><span class="token parameter">parent<span class="token punctuation">,</span> args<span class="token punctuation">,</span> ctx<span class="token punctuation">,</span> info</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">const</span> <span class="token punctuation">{</span> data <span class="token punctuation">}</span> <span class="token operator">=</span> args
		<span class="token keyword">const</span> <span class="token punctuation">{</span> email<span class="token punctuation">,</span> username<span class="token punctuation">,</span> password<span class="token punctuation">,</span> age <span class="token punctuation">}</span> <span class="token operator">=</span> data
		<span class="token keyword">const</span> user <span class="token operator">=</span> <span class="token keyword">await</span> UserModel<span class="token punctuation">.</span><span class="token function">findOne</span><span class="token punctuation">(</span><span class="token punctuation">{</span>email<span class="token punctuation">}</span><span class="token punctuation">)</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">&quot;邮箱已经被占用&quot;</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span>
		<span class="token comment">// 创建新的作者对象</span>
		<span class="token keyword">const</span> newUser <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">UserModel</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
			username<span class="token punctuation">,</span>
			email<span class="token punctuation">,</span>
			age<span class="token punctuation">,</span>
			password
		<span class="token punctuation">}</span><span class="token punctuation">)</span>
		<span class="token keyword">await</span> newUser<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token keyword">return</span> newUser
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token comment">// 创建新文章（完成）</span>
	<span class="token keyword">async</span> <span class="token function">createPost</span><span class="token punctuation">(</span><span class="token parameter">parent<span class="token punctuation">,</span> args<span class="token punctuation">,</span> ctx<span class="token punctuation">,</span> info</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">const</span> <span class="token punctuation">{</span> req<span class="token punctuation">,</span> pubsub <span class="token punctuation">}</span> <span class="token operator">=</span> ctx
		<span class="token keyword">const</span> <span class="token punctuation">{</span> data <span class="token punctuation">}</span> <span class="token operator">=</span> args

		<span class="token comment">// 创建新文章先要鉴权</span>
		<span class="token keyword">const</span> decodeResult <span class="token operator">=</span> <span class="token function">authenticate</span><span class="token punctuation">(</span>req<span class="token punctuation">)</span>
		<span class="token keyword">const</span> <span class="token punctuation">{</span>id<span class="token punctuation">,</span> email<span class="token punctuation">}</span> <span class="token operator">=</span> decodeResult

		<span class="token comment">// 判断author是否存在</span>
		<span class="token keyword">const</span> user <span class="token operator">=</span> <span class="token keyword">await</span> UserModel<span class="token punctuation">.</span><span class="token function">findOne</span><span class="token punctuation">(</span><span class="token punctuation">{</span>_id<span class="token punctuation">:</span> id<span class="token punctuation">,</span> email<span class="token punctuation">}</span><span class="token punctuation">)</span>
		<span class="token comment">// 如果作者不存在，返回错误</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>user<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">&quot;作者不存在&quot;</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">const</span> <span class="token punctuation">{</span> title<span class="token punctuation">,</span> body<span class="token punctuation">,</span> published <span class="token punctuation">}</span> <span class="token operator">=</span> data

		<span class="token comment">// 创建新的文章对象</span>
		<span class="token keyword">const</span> newPost <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PostModel</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
			title<span class="token punctuation">,</span>
			body<span class="token punctuation">,</span>
			published<span class="token punctuation">,</span>
			authorId<span class="token punctuation">:</span>id
		<span class="token punctuation">}</span><span class="token punctuation">)</span>
		<span class="token keyword">await</span> newPost<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token keyword">return</span> newPost
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token comment">// 创建新评论（完成）</span>
	<span class="token keyword">async</span> <span class="token function">createComment</span><span class="token punctuation">(</span><span class="token parameter">parent<span class="token punctuation">,</span> args<span class="token punctuation">,</span> ctx<span class="token punctuation">,</span> info</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">const</span> <span class="token punctuation">{</span> req<span class="token punctuation">,</span> pubsub <span class="token punctuation">}</span> <span class="token operator">=</span> ctx

		<span class="token comment">// 创建新文章先要鉴权</span>
		<span class="token keyword">const</span> decodeResult <span class="token operator">=</span> <span class="token function">authenticate</span><span class="token punctuation">(</span>req<span class="token punctuation">)</span>
		<span class="token keyword">const</span> <span class="token punctuation">{</span>id<span class="token punctuation">,</span> email<span class="token punctuation">}</span> <span class="token operator">=</span> decodeResult
		<span class="token comment">// 判断author是否存在</span>
		<span class="token keyword">const</span> user <span class="token operator">=</span> <span class="token keyword">await</span> UserModel<span class="token punctuation">.</span><span class="token function">findOne</span><span class="token punctuation">(</span><span class="token punctuation">{</span>_id<span class="token punctuation">:</span> id<span class="token punctuation">,</span> email<span class="token punctuation">}</span><span class="token punctuation">)</span>


		<span class="token keyword">const</span> <span class="token punctuation">{</span> data <span class="token punctuation">}</span> <span class="token operator">=</span> args
		<span class="token keyword">const</span> <span class="token punctuation">{</span> text<span class="token punctuation">,</span> post <span class="token punctuation">}</span> <span class="token operator">=</span> data
		<span class="token comment">// 判断文章是否存在</span>
		<span class="token keyword">const</span> postExist <span class="token operator">=</span> <span class="token keyword">await</span> PostModel<span class="token punctuation">.</span><span class="token function">findOne</span><span class="token punctuation">(</span><span class="token punctuation">{</span>_id<span class="token punctuation">:</span> post<span class="token punctuation">}</span><span class="token punctuation">)</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>postExist<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">&quot;要评论的文章不存在&quot;</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span>

		<span class="token comment">// 创建新的评论对象</span>
		<span class="token keyword">const</span> newComment <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CommentModel</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
			text<span class="token punctuation">,</span>
			authorId<span class="token punctuation">:</span> id<span class="token punctuation">,</span>
			postId<span class="token punctuation">:</span> post
		<span class="token punctuation">}</span><span class="token punctuation">)</span>
		<span class="token keyword">await</span> newComment<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token keyword">return</span> newComment
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token comment">// 删除用户（完成）</span>
	<span class="token keyword">async</span> <span class="token function">deleteUser</span><span class="token punctuation">(</span><span class="token parameter">parent<span class="token punctuation">,</span>args<span class="token punctuation">,</span>ctx<span class="token punctuation">,</span> info</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">const</span> <span class="token punctuation">{</span> req<span class="token punctuation">,</span> pubsub <span class="token punctuation">}</span> <span class="token operator">=</span> ctx

		<span class="token comment">// 删除用户先要鉴权</span>
		<span class="token keyword">const</span> decodeResult <span class="token operator">=</span> <span class="token function">authenticate</span><span class="token punctuation">(</span>req<span class="token punctuation">)</span>
		<span class="token keyword">const</span> <span class="token punctuation">{</span>id<span class="token punctuation">,</span> email<span class="token punctuation">}</span> <span class="token operator">=</span> decodeResult
		<span class="token comment">// 判断author是否存在</span>
		<span class="token keyword">const</span> user <span class="token operator">=</span> <span class="token keyword">await</span> UserModel<span class="token punctuation">.</span><span class="token function">findOne</span><span class="token punctuation">(</span><span class="token punctuation">{</span>_id<span class="token punctuation">:</span> id<span class="token punctuation">,</span> email<span class="token punctuation">}</span><span class="token punctuation">)</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>user<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">&quot;用户不存在&quot;</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span>

		<span class="token keyword">const</span> <span class="token punctuation">{</span> userid <span class="token punctuation">}</span> <span class="token operator">=</span> args

		<span class="token comment">// 判断你要删除的id和自己的id是否一样，只能删除自己</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>userid <span class="token operator">!==</span> id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">&quot;无权删除其他用户&quot;</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span>
		<span class="token comment">// 1. 删除自己</span>
		<span class="token keyword">const</span> userDeleted <span class="token operator">=</span> <span class="token keyword">await</span> UserModel<span class="token punctuation">.</span><span class="token function">findByIdAndDelete</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>userDeleted<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">&quot;数据库删除用户失败&quot;</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span>

		<span class="token comment">// 2. 同时要删除该作者写的文章以及文章下所有评论</span>
		<span class="token keyword">const</span> userPosts <span class="token operator">=</span> <span class="token keyword">await</span> PostModel<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span>authorId<span class="token punctuation">:</span> id<span class="token punctuation">}</span><span class="token punctuation">)</span>
		<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> i<span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span> userPosts<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token comment">// 删除文章下的所有评论</span>
			<span class="token keyword">let</span> everyPost <span class="token operator">=</span> userPosts<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
			<span class="token keyword">await</span> CommentModel<span class="token punctuation">.</span><span class="token function">deleteMany</span><span class="token punctuation">(</span><span class="token punctuation">{</span>postId<span class="token punctuation">:</span> everyPost<span class="token punctuation">.</span>_id<span class="token punctuation">}</span><span class="token punctuation">)</span>
			<span class="token comment">// 删除文章自己</span>
			<span class="token keyword">await</span> everyPost<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span>

		<span class="token comment">// 4. 最后要删除该作者所发表的所有评论</span>
		<span class="token keyword">const</span> commentDeleted <span class="token operator">=</span> <span class="token keyword">await</span> CommentModel<span class="token punctuation">.</span><span class="token function">deleteMany</span><span class="token punctuation">(</span><span class="token punctuation">{</span>authorId<span class="token punctuation">:</span> id<span class="token punctuation">}</span><span class="token punctuation">)</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>commentDeleted<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">&quot;数据库删除用户相关文章和评论失败&quot;</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">return</span> userDeleted
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token comment">// 删除文章（完成）</span>
	<span class="token keyword">async</span> <span class="token function">deletePost</span><span class="token punctuation">(</span><span class="token parameter">parent<span class="token punctuation">,</span>args<span class="token punctuation">,</span>ctx<span class="token punctuation">,</span>info</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">const</span> <span class="token punctuation">{</span> req<span class="token punctuation">,</span> pubsub <span class="token punctuation">}</span> <span class="token operator">=</span> ctx

		<span class="token comment">// 删除用户先要鉴权</span>
		<span class="token keyword">const</span> decodeResult <span class="token operator">=</span> <span class="token function">authenticate</span><span class="token punctuation">(</span>req<span class="token punctuation">)</span>
		<span class="token keyword">const</span> <span class="token punctuation">{</span>id<span class="token punctuation">,</span> email<span class="token punctuation">}</span> <span class="token operator">=</span> decodeResult
		<span class="token comment">// 判断author是否存在</span>
		<span class="token keyword">const</span> user <span class="token operator">=</span> <span class="token keyword">await</span> UserModel<span class="token punctuation">.</span><span class="token function">findOne</span><span class="token punctuation">(</span><span class="token punctuation">{</span>_id<span class="token punctuation">:</span> id<span class="token punctuation">,</span> email<span class="token punctuation">}</span><span class="token punctuation">)</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>user<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">&quot;用户不存在&quot;</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span>

		<span class="token keyword">const</span> <span class="token punctuation">{</span> postid <span class="token punctuation">}</span> <span class="token operator">=</span> args
		<span class="token comment">// 判断文章是否存在</span>
		<span class="token keyword">const</span> postDeleted <span class="token operator">=</span> <span class="token keyword">await</span> PostModel<span class="token punctuation">.</span><span class="token function">findById</span><span class="token punctuation">(</span>postid<span class="token punctuation">)</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>postDeleted<span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">&quot;要删除的文章不存在&quot;</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span>

		<span class="token comment">// 判断文章的作者是否是用户</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>postDeleted<span class="token punctuation">.</span>authorId <span class="token operator">!==</span> id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">&quot;无法删除不是自己写的文章&quot;</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span>

		<span class="token comment">// 2. 删除文章</span>
		<span class="token keyword">const</span> postDeletedResult <span class="token operator">=</span> <span class="token keyword">await</span> postDeleted<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token comment">// 3. 删除该文章下面所有的评论</span>
		<span class="token keyword">const</span> commentsDeleted <span class="token operator">=</span> <span class="token keyword">await</span> CommentModel<span class="token punctuation">.</span><span class="token function">deleteMany</span><span class="token punctuation">(</span><span class="token punctuation">{</span>postId<span class="token punctuation">:</span>postid<span class="token punctuation">}</span><span class="token punctuation">)</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>postDeletedResult <span class="token operator">&amp;&amp;</span> commentsDeleted<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">&quot;数据库删除文章相关信息失败&quot;</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span>

		<span class="token keyword">return</span> postDeletedResult
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token comment">// 删除评论（完成）</span>
	<span class="token keyword">async</span> <span class="token function">deleteComment</span><span class="token punctuation">(</span><span class="token parameter">parent<span class="token punctuation">,</span>args<span class="token punctuation">,</span>ctx<span class="token punctuation">,</span>info</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">const</span> <span class="token punctuation">{</span> req<span class="token punctuation">,</span> pubsub <span class="token punctuation">}</span> <span class="token operator">=</span> ctx

		<span class="token comment">// 删除用户先要鉴权</span>
		<span class="token keyword">const</span> decodeResult <span class="token operator">=</span> <span class="token function">authenticate</span><span class="token punctuation">(</span>req<span class="token punctuation">)</span>
		<span class="token keyword">const</span> <span class="token punctuation">{</span>id<span class="token punctuation">,</span> email<span class="token punctuation">}</span> <span class="token operator">=</span> decodeResult
		<span class="token comment">// 判断author是否存在</span>
		<span class="token keyword">const</span> user <span class="token operator">=</span> <span class="token keyword">await</span> UserModel<span class="token punctuation">.</span><span class="token function">findOne</span><span class="token punctuation">(</span><span class="token punctuation">{</span>_id<span class="token punctuation">:</span> id<span class="token punctuation">,</span> email<span class="token punctuation">}</span><span class="token punctuation">)</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>user<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">&quot;用户不存在&quot;</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span>

		<span class="token keyword">const</span> <span class="token punctuation">{</span> commentid <span class="token punctuation">}</span> <span class="token operator">=</span> args
		<span class="token comment">// 判断评论是否存在</span>
		<span class="token keyword">const</span> commentDeleted <span class="token operator">=</span> <span class="token keyword">await</span> CommentModel<span class="token punctuation">.</span><span class="token function">findById</span><span class="token punctuation">(</span>commentid<span class="token punctuation">)</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>commentDeleted<span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">&quot;要删除的评论不存在&quot;</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span>

		<span class="token comment">// 判断评论的作者是否是用户</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>commentDeleted<span class="token punctuation">.</span>authorId <span class="token operator">!==</span> id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">&quot;无法删除不是自己写的评论&quot;</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span>

		<span class="token comment">// 2. 删除评论</span>
		<span class="token keyword">const</span> commentDeletedResult <span class="token operator">=</span> <span class="token keyword">await</span> commentDeleted<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

		<span class="token keyword">return</span> commentDeletedResult
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token comment">// 更新用户信息（完成）</span>
	<span class="token keyword">async</span> <span class="token function">updateUser</span><span class="token punctuation">(</span><span class="token parameter">parent<span class="token punctuation">,</span> args<span class="token punctuation">,</span> ctx<span class="token punctuation">,</span> info</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">const</span> <span class="token punctuation">{</span> req<span class="token punctuation">,</span> pubsub <span class="token punctuation">}</span> <span class="token operator">=</span> ctx
		<span class="token keyword">const</span> <span class="token punctuation">{</span> data <span class="token punctuation">}</span> <span class="token operator">=</span> args

		<span class="token comment">// 创建新文章先要鉴权</span>
		<span class="token keyword">const</span> decodeResult <span class="token operator">=</span> <span class="token function">authenticate</span><span class="token punctuation">(</span>req<span class="token punctuation">)</span>
		<span class="token keyword">const</span> <span class="token punctuation">{</span> id <span class="token punctuation">}</span> <span class="token operator">=</span> decodeResult
		<span class="token comment">// 判断author是否存在</span>
		<span class="token keyword">const</span> user <span class="token operator">=</span> <span class="token keyword">await</span> UserModel<span class="token punctuation">.</span><span class="token function">findOne</span><span class="token punctuation">(</span><span class="token punctuation">{</span>_id<span class="token punctuation">:</span> id<span class="token punctuation">}</span><span class="token punctuation">)</span>
		console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;user&quot;</span><span class="token punctuation">,</span>user<span class="token punctuation">)</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>user<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">&quot;用户不存在&quot;</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span>

		<span class="token keyword">if</span><span class="token punctuation">(</span>data <span class="token operator">&amp;&amp;</span> data<span class="token punctuation">.</span>email<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token comment">// 判断邮箱需要保证唯一性</span>
			<span class="token keyword">const</span> emailExist <span class="token operator">=</span> <span class="token keyword">await</span> UserModel<span class="token punctuation">.</span><span class="token function">findOne</span><span class="token punctuation">(</span><span class="token punctuation">{</span>email<span class="token punctuation">}</span><span class="token punctuation">)</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span>emailExist<span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">&quot;新的邮箱已经被占用&quot;</span><span class="token punctuation">)</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>

		<span class="token keyword">const</span> userUpdated <span class="token operator">=</span> <span class="token keyword">await</span> UserModel<span class="token punctuation">.</span><span class="token function">findByIdAndUpdate</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token operator">...</span>data<span class="token punctuation">}</span><span class="token punctuation">)</span>

		<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>userUpdated<span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">&quot;数据库更新用户失败&quot;</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span>

		<span class="token keyword">return</span> userUpdated
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token comment">// 更新文章（完成）</span>
	<span class="token keyword">async</span> <span class="token function">updatePost</span><span class="token punctuation">(</span><span class="token parameter">parent<span class="token punctuation">,</span> args<span class="token punctuation">,</span> ctx<span class="token punctuation">,</span> info</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">const</span> <span class="token punctuation">{</span> req<span class="token punctuation">,</span>pubsub <span class="token punctuation">}</span> <span class="token operator">=</span> ctx
		<span class="token keyword">const</span> <span class="token punctuation">{</span> postid<span class="token punctuation">,</span> data <span class="token punctuation">}</span> <span class="token operator">=</span> args

		<span class="token comment">// 更新文章先要鉴权</span>
		<span class="token keyword">const</span> decodeResult <span class="token operator">=</span> <span class="token function">authenticate</span><span class="token punctuation">(</span>req<span class="token punctuation">)</span>
		<span class="token keyword">const</span> <span class="token punctuation">{</span> id <span class="token punctuation">}</span> <span class="token operator">=</span> decodeResult
		<span class="token comment">// 判断author是否存在</span>
		<span class="token keyword">const</span> user <span class="token operator">=</span> <span class="token keyword">await</span> UserModel<span class="token punctuation">.</span><span class="token function">findOne</span><span class="token punctuation">(</span><span class="token punctuation">{</span>_id<span class="token punctuation">:</span> id<span class="token punctuation">}</span><span class="token punctuation">)</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>user<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">&quot;用户不存在&quot;</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span>

		<span class="token comment">// 检查更新的文章是否存在</span>
		<span class="token keyword">const</span> oldPost <span class="token operator">=</span> <span class="token keyword">await</span> PostModel<span class="token punctuation">.</span><span class="token function">findById</span><span class="token punctuation">(</span>postid<span class="token punctuation">)</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>oldPost<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">&quot;文章不存在&quot;</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span>
		<span class="token comment">// 判断用户是否和文章作者一致</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>id<span class="token operator">!==</span>oldPost<span class="token punctuation">.</span>authorId<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">&quot;无法修改其他作者的文章&quot;</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span>

		<span class="token keyword">const</span> <span class="token punctuation">{</span> title<span class="token punctuation">,</span> body<span class="token punctuation">,</span> published <span class="token punctuation">}</span> <span class="token operator">=</span> data
		<span class="token keyword">let</span> newPost <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

		<span class="token comment">// 判断标题</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> title <span class="token operator">===</span> <span class="token string">'string'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			newPost<span class="token punctuation">.</span>title <span class="token operator">=</span> title
		<span class="token punctuation">}</span>
		<span class="token comment">// 判断内容</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> body <span class="token operator">===</span> <span class="token string">'string'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			newPost<span class="token punctuation">.</span>body <span class="token operator">=</span> body
		<span class="token punctuation">}</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> published <span class="token operator">===</span> <span class="token string">'boolean'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			newPost<span class="token punctuation">.</span>published <span class="token operator">=</span> published
		<span class="token punctuation">}</span>
		<span class="token comment">// 更新文章</span>
		<span class="token keyword">const</span> postUpdated <span class="token operator">=</span> <span class="token keyword">await</span> PostModel<span class="token punctuation">.</span><span class="token function">findByIdAndUpdate</span><span class="token punctuation">(</span>postid<span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token operator">...</span>newPost<span class="token punctuation">}</span><span class="token punctuation">)</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>postUpdated<span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">&quot;数据库更新文章失败&quot;</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span>

		<span class="token keyword">return</span> postUpdated
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token comment">// 更新评论（完成）</span>
	<span class="token keyword">async</span> <span class="token function">updateComment</span><span class="token punctuation">(</span><span class="token parameter">parent<span class="token punctuation">,</span> args<span class="token punctuation">,</span> ctx<span class="token punctuation">,</span> info</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">const</span> <span class="token punctuation">{</span> req<span class="token punctuation">,</span>pubsub <span class="token punctuation">}</span> <span class="token operator">=</span> ctx
		<span class="token keyword">const</span> <span class="token punctuation">{</span> commentid<span class="token punctuation">,</span> data <span class="token punctuation">}</span> <span class="token operator">=</span> args

		<span class="token comment">// 更新评论先要鉴权</span>
		<span class="token keyword">const</span> decodeResult <span class="token operator">=</span> <span class="token function">authenticate</span><span class="token punctuation">(</span>req<span class="token punctuation">)</span>
		<span class="token keyword">const</span> <span class="token punctuation">{</span> id <span class="token punctuation">}</span> <span class="token operator">=</span> decodeResult
		<span class="token comment">// 判断author是否存在</span>
		<span class="token keyword">const</span> user <span class="token operator">=</span> <span class="token keyword">await</span> UserModel<span class="token punctuation">.</span><span class="token function">findOne</span><span class="token punctuation">(</span><span class="token punctuation">{</span>_id<span class="token punctuation">:</span> id<span class="token punctuation">}</span><span class="token punctuation">)</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>user<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">&quot;用户不存在&quot;</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span>

		<span class="token comment">// 检查更新的评论是否存在</span>
		<span class="token keyword">const</span> oldComment <span class="token operator">=</span> <span class="token keyword">await</span> CommentModel<span class="token punctuation">.</span><span class="token function">findById</span><span class="token punctuation">(</span>commentid<span class="token punctuation">)</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>oldComment<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">&quot;评论不存在&quot;</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span>
		<span class="token comment">// 判断用户是否和评论作者一致</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>id<span class="token operator">!==</span>oldComment<span class="token punctuation">.</span>authorId<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">&quot;无法修改其他作者的评论&quot;</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span>

		<span class="token keyword">const</span> <span class="token punctuation">{</span> text <span class="token punctuation">}</span> <span class="token operator">=</span> data
		<span class="token keyword">let</span> newComment <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

		<span class="token comment">// 判断内容</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> text <span class="token operator">===</span> <span class="token string">'string'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			newComment<span class="token punctuation">.</span>text <span class="token operator">=</span> text
		<span class="token punctuation">}</span>
		<span class="token comment">// 更新评论</span>
		<span class="token keyword">const</span> commentUpdated <span class="token operator">=</span> <span class="token keyword">await</span> CommentModel<span class="token punctuation">.</span><span class="token function">findByIdAndUpdate</span><span class="token punctuation">(</span>commentid<span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token operator">...</span>newComment<span class="token punctuation">}</span><span class="token punctuation">)</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>commentUpdated<span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">&quot;数据库更新评论失败&quot;</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span>

		<span class="token keyword">return</span> commentUpdated
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
	Mutation
<span class="token punctuation">}</span>
</code></pre></div><h3 id="post-js"><a href="#post-js" aria-hidden="true" class="header-anchor">#</a> Post.js</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// src/resolvers/Post.js</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> PostModel<span class="token punctuation">,</span> UserModel<span class="token punctuation">,</span> CommentModel<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'../models/index'</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> Post <span class="token operator">=</span> <span class="token punctuation">{</span>
	<span class="token comment">// 根据文章的authorid查看用户（完成）</span>
	<span class="token keyword">async</span> <span class="token function">author</span><span class="token punctuation">(</span><span class="token parameter">parent<span class="token punctuation">,</span> args<span class="token punctuation">,</span> ctx<span class="token punctuation">,</span> info</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">const</span> author <span class="token operator">=</span> <span class="token keyword">await</span> UserModel<span class="token punctuation">.</span><span class="token function">findById</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
			_id<span class="token punctuation">:</span> parent<span class="token punctuation">.</span>authorId
		<span class="token punctuation">}</span><span class="token punctuation">)</span>
		<span class="token keyword">return</span> author
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token comment">// 根据文章查看文章下的所有评论（完成）</span>
	<span class="token keyword">async</span> <span class="token function">comments</span><span class="token punctuation">(</span><span class="token parameter">parent<span class="token punctuation">,</span> args<span class="token punctuation">,</span> ctx<span class="token punctuation">,</span> info</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">const</span> comments <span class="token operator">=</span> <span class="token keyword">await</span> CommentModel<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
			postId<span class="token punctuation">:</span> parent<span class="token punctuation">.</span>_id
		<span class="token punctuation">}</span><span class="token punctuation">)</span>
		<span class="token keyword">return</span> comments
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
	Post
<span class="token punctuation">}</span>
</code></pre></div><h3 id="query-js"><a href="#query-js" aria-hidden="true" class="header-anchor">#</a> Query.js</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// src/resolvers/Query.js</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> UserModel<span class="token punctuation">,</span> PostModel<span class="token punctuation">,</span> CommentModel <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'../models/index.js'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> authenticate <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'../middleware/auth'</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> Query <span class="token operator">=</span> <span class="token punctuation">{</span>
	<span class="token comment">// 查看评论（完成）</span>
	<span class="token keyword">async</span> <span class="token function">comments</span><span class="token punctuation">(</span><span class="token parameter">parent<span class="token punctuation">,</span> args<span class="token punctuation">,</span> ctx<span class="token punctuation">,</span> info</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">const</span> <span class="token punctuation">{</span> req<span class="token punctuation">,</span> pubsub <span class="token punctuation">}</span> <span class="token operator">=</span> ctx

		<span class="token comment">// 查看用户先鉴权</span>
		<span class="token keyword">const</span> decodeResult <span class="token operator">=</span> <span class="token function">authenticate</span><span class="token punctuation">(</span>req<span class="token punctuation">)</span>
		<span class="token keyword">const</span> <span class="token punctuation">{</span>id<span class="token punctuation">,</span> email<span class="token punctuation">}</span> <span class="token operator">=</span> decodeResult
		<span class="token comment">// 判断author是否存在</span>
		<span class="token keyword">const</span> user <span class="token operator">=</span> <span class="token keyword">await</span> UserModel<span class="token punctuation">.</span><span class="token function">findOne</span><span class="token punctuation">(</span><span class="token punctuation">{</span>_id<span class="token punctuation">:</span> id<span class="token punctuation">,</span> email<span class="token punctuation">}</span><span class="token punctuation">)</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>user<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">&quot;用户不存在&quot;</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span>

		<span class="token keyword">const</span> <span class="token punctuation">{</span> query <span class="token punctuation">}</span> <span class="token operator">=</span> args
		<span class="token keyword">let</span> commentone
		<span class="token keyword">if</span><span class="token punctuation">(</span>query<span class="token operator">!==</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			commentone <span class="token operator">=</span> <span class="token keyword">await</span> CommentModel<span class="token punctuation">.</span><span class="token function">findById</span><span class="token punctuation">(</span>query<span class="token punctuation">)</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>commentone<span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">&quot;评论不存在&quot;</span><span class="token punctuation">)</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
			commentone <span class="token operator">=</span> <span class="token keyword">await</span> CommentModel<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">return</span> Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>commentone<span class="token punctuation">)</span><span class="token operator">?</span> commentone<span class="token punctuation">:</span> <span class="token punctuation">[</span>commentone<span class="token punctuation">]</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token comment">// 查看用户（完成）</span>
	<span class="token keyword">async</span> <span class="token function">users</span><span class="token punctuation">(</span><span class="token parameter">parent<span class="token punctuation">,</span> args<span class="token punctuation">,</span> ctx<span class="token punctuation">,</span> info</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">const</span> <span class="token punctuation">{</span> req<span class="token punctuation">,</span> pubsub <span class="token punctuation">}</span> <span class="token operator">=</span> ctx

		<span class="token comment">// 查看用户先鉴权</span>
		<span class="token keyword">const</span> decodeResult <span class="token operator">=</span> <span class="token function">authenticate</span><span class="token punctuation">(</span>req<span class="token punctuation">)</span>
		<span class="token keyword">const</span> <span class="token punctuation">{</span>id<span class="token punctuation">,</span> email<span class="token punctuation">}</span> <span class="token operator">=</span> decodeResult
		<span class="token comment">// 判断author是否存在</span>
		<span class="token keyword">const</span> user <span class="token operator">=</span> <span class="token keyword">await</span> UserModel<span class="token punctuation">.</span><span class="token function">findOne</span><span class="token punctuation">(</span><span class="token punctuation">{</span>_id<span class="token punctuation">:</span> id<span class="token punctuation">,</span> email<span class="token punctuation">}</span><span class="token punctuation">)</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>user<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">&quot;用户不存在&quot;</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span>

		<span class="token keyword">const</span> <span class="token punctuation">{</span> query <span class="token punctuation">}</span> <span class="token operator">=</span> args
		<span class="token keyword">let</span> userone
		<span class="token keyword">if</span><span class="token punctuation">(</span>query<span class="token operator">!==</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			userone <span class="token operator">=</span> <span class="token keyword">await</span> UserModel<span class="token punctuation">.</span><span class="token function">findById</span><span class="token punctuation">(</span>query<span class="token punctuation">)</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>userone<span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">&quot;用户不存在&quot;</span><span class="token punctuation">)</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
			userone <span class="token operator">=</span> <span class="token keyword">await</span> UserModel<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">return</span> Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>userone<span class="token punctuation">)</span><span class="token operator">?</span> userone<span class="token punctuation">:</span> <span class="token punctuation">[</span>userone<span class="token punctuation">]</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token comment">// 查看文章</span>
	<span class="token keyword">async</span> <span class="token function">posts</span><span class="token punctuation">(</span><span class="token parameter">parent<span class="token punctuation">,</span> args<span class="token punctuation">,</span> ctx<span class="token punctuation">,</span> info</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">const</span> <span class="token punctuation">{</span> req<span class="token punctuation">,</span> pubsub <span class="token punctuation">}</span> <span class="token operator">=</span> ctx

		<span class="token comment">// 查看用户先鉴权</span>
		<span class="token keyword">const</span> decodeResult <span class="token operator">=</span> <span class="token function">authenticate</span><span class="token punctuation">(</span>req<span class="token punctuation">)</span>
		<span class="token keyword">const</span> <span class="token punctuation">{</span>id<span class="token punctuation">,</span> email<span class="token punctuation">}</span> <span class="token operator">=</span> decodeResult
		<span class="token comment">// 判断author是否存在</span>
		<span class="token keyword">const</span> user <span class="token operator">=</span> <span class="token keyword">await</span> UserModel<span class="token punctuation">.</span><span class="token function">findOne</span><span class="token punctuation">(</span><span class="token punctuation">{</span>_id<span class="token punctuation">:</span> id<span class="token punctuation">,</span> email<span class="token punctuation">}</span><span class="token punctuation">)</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>user<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">&quot;用户不存在&quot;</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span>

		<span class="token keyword">const</span> <span class="token punctuation">{</span> query <span class="token punctuation">}</span> <span class="token operator">=</span> args
		<span class="token keyword">let</span> postone
		<span class="token keyword">if</span><span class="token punctuation">(</span>query<span class="token operator">!==</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			postone <span class="token operator">=</span> <span class="token keyword">await</span> PostModel<span class="token punctuation">.</span><span class="token function">findById</span><span class="token punctuation">(</span>query<span class="token punctuation">)</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>postone<span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">&quot;用户不存在&quot;</span><span class="token punctuation">)</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
			postone <span class="token operator">=</span> <span class="token keyword">await</span> PostModel<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">return</span> Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>postone<span class="token punctuation">)</span><span class="token operator">?</span> postone<span class="token punctuation">:</span> <span class="token punctuation">[</span>postone<span class="token punctuation">]</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
	Query
<span class="token punctuation">}</span>
</code></pre></div><h3 id="subscription-js"><a href="#subscription-js" aria-hidden="true" class="header-anchor">#</a> Subscription.js</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// src/resolvers/Subscription.js</span>
<span class="token keyword">const</span> Subscription <span class="token operator">=</span> <span class="token punctuation">{</span>
	comment<span class="token punctuation">:</span> <span class="token punctuation">{</span>
		<span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token parameter">parent<span class="token punctuation">,</span> args<span class="token punctuation">,</span> ctx<span class="token punctuation">,</span> info</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">const</span> <span class="token punctuation">{</span> postId <span class="token punctuation">}</span> <span class="token operator">=</span> args
			<span class="token keyword">const</span> <span class="token punctuation">{</span> db<span class="token punctuation">,</span> pubsub <span class="token punctuation">}</span> <span class="token operator">=</span> ctx
			<span class="token comment">// 1. 检查订阅评论所属的文章是否存在</span>
			<span class="token keyword">const</span> post <span class="token operator">=</span> db<span class="token punctuation">.</span>allPosts<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">post</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> post<span class="token punctuation">.</span>id <span class="token operator">===</span> postId<span class="token operator">&amp;&amp;</span>post<span class="token punctuation">.</span>published<span class="token punctuation">)</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>post<span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">&quot;订阅评论所属的文章不存在&quot;</span><span class="token punctuation">)</span>
			<span class="token punctuation">}</span>

			<span class="token keyword">return</span> pubsub<span class="token punctuation">.</span><span class="token function">asyncIterator</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`comment </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>postId<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">)</span> <span class="token comment">// 2.根据不同的id来定义不同的通道</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>

	post<span class="token punctuation">:</span> <span class="token punctuation">{</span>
		<span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token parameter">parent<span class="token punctuation">,</span> args<span class="token punctuation">,</span> ctx<span class="token punctuation">,</span> info</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">const</span> <span class="token punctuation">{</span> pubsub <span class="token punctuation">}</span> <span class="token operator">=</span> ctx
			<span class="token keyword">return</span> pubsub<span class="token punctuation">.</span><span class="token function">asyncIterator</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`post`</span></span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

module<span class="token punctuation">.</span>exports<span class="token operator">=</span> <span class="token punctuation">{</span>
	Subscription
<span class="token punctuation">}</span>
</code></pre></div><h3 id="user-js"><a href="#user-js" aria-hidden="true" class="header-anchor">#</a> User.js</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// src/resolvers/User.js</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span>  CommentModel<span class="token punctuation">,</span> PostModel <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'../models/index'</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> User <span class="token operator">=</span> <span class="token punctuation">{</span>
	<span class="token comment">// 根据用户id查看用户的所有文章（完成）</span>
	<span class="token keyword">async</span> <span class="token function">posts</span><span class="token punctuation">(</span><span class="token parameter">parent<span class="token punctuation">,</span> args<span class="token punctuation">,</span> ctx<span class="token punctuation">,</span> info</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">const</span> userPosts <span class="token operator">=</span> <span class="token keyword">await</span> PostModel<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
			authorId<span class="token punctuation">:</span> parent<span class="token punctuation">.</span>id
		<span class="token punctuation">}</span><span class="token punctuation">)</span>
		<span class="token keyword">return</span> userPosts
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token comment">// 根据用户id查看用户的所有评论（完成）</span>
	<span class="token keyword">async</span> <span class="token function">comments</span><span class="token punctuation">(</span><span class="token parameter">parent<span class="token punctuation">,</span> args<span class="token punctuation">,</span> ctx<span class="token punctuation">,</span> info</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">const</span> userComments <span class="token operator">=</span> <span class="token keyword">await</span> CommentModel<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
			authorId<span class="token punctuation">:</span> parent<span class="token punctuation">.</span>id
		<span class="token punctuation">}</span><span class="token punctuation">)</span>
		<span class="token keyword">return</span> userComments
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
	User
<span class="token punctuation">}</span>
</code></pre></div><h2 id="models"><a href="#models" aria-hidden="true" class="header-anchor">#</a> models</h2> <h3 id="comment-js-2"><a href="#comment-js-2" aria-hidden="true" class="header-anchor">#</a> Comment.js</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// src/models/Comment.js</span>
<span class="token keyword">const</span> mongoose <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;mongoose&quot;</span><span class="token punctuation">)</span>

<span class="token comment">// 评论要保存在mongodb中的格式</span>
<span class="token keyword">const</span> commentSchema <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">mongoose<span class="token punctuation">.</span>Schema</span><span class="token punctuation">(</span>
  <span class="token punctuation">{</span>
    <span class="token comment">// 评论内容</span>
    text<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      type<span class="token punctuation">:</span> String<span class="token punctuation">,</span>
      required<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">// 用户id</span>
    authorId<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      type<span class="token punctuation">:</span> String<span class="token punctuation">,</span>
      required<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">// 评论所属文章id</span>
    postId<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      type<span class="token punctuation">:</span> String<span class="token punctuation">,</span>
      required<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> timestamps<span class="token punctuation">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span>
<span class="token punctuation">)</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> mongoose<span class="token punctuation">.</span><span class="token function">model</span><span class="token punctuation">(</span><span class="token string">&quot;comment&quot;</span><span class="token punctuation">,</span> commentSchema<span class="token punctuation">)</span>
</code></pre></div><h3 id="index"><a href="#index" aria-hidden="true" class="header-anchor">#</a> index</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// src/models/index.js</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  UserModel<span class="token punctuation">:</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./User&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  PostModel<span class="token punctuation">:</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./Post&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  CommentModel<span class="token punctuation">:</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./Comment&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="post-js-2"><a href="#post-js-2" aria-hidden="true" class="header-anchor">#</a> Post.js</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// src/models/Post.js</span>
<span class="token keyword">const</span> mongoose <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;mongoose&quot;</span><span class="token punctuation">)</span>

<span class="token comment">// 文章要保存在数据库中的格式</span>
<span class="token keyword">const</span> postSchema <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">mongoose<span class="token punctuation">.</span>Schema</span><span class="token punctuation">(</span>
  <span class="token punctuation">{</span>
    <span class="token comment">// 作者id</span>
    authorId<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      type<span class="token punctuation">:</span> String<span class="token punctuation">,</span>
      required<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">// 文章标题</span>
    title<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      type<span class="token punctuation">:</span> String<span class="token punctuation">,</span>
      required<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">// 文章内容</span>
    body<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      type<span class="token punctuation">:</span> String<span class="token punctuation">,</span>
      required<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token comment">// 文章是否公开</span>
		published<span class="token punctuation">:</span> <span class="token punctuation">{</span>
			type<span class="token punctuation">:</span> Boolean<span class="token punctuation">,</span>
			required<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
		<span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> timestamps<span class="token punctuation">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span>
<span class="token punctuation">)</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> mongoose<span class="token punctuation">.</span><span class="token function">model</span><span class="token punctuation">(</span><span class="token string">&quot;post&quot;</span><span class="token punctuation">,</span> postSchema<span class="token punctuation">)</span>
</code></pre></div><h3 id="user-js-2"><a href="#user-js-2" aria-hidden="true" class="header-anchor">#</a> User.js</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// src/models/User.js</span>
<span class="token keyword">const</span> mongoose <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;mongoose&quot;</span><span class="token punctuation">)</span>

<span class="token comment">// 用户在mongodb中的存储格式</span>
<span class="token keyword">const</span> userSchema <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">mongoose<span class="token punctuation">.</span>Schema</span><span class="token punctuation">(</span>
  <span class="token punctuation">{</span>
    <span class="token comment">// 用户名称</span>
    username<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      type<span class="token punctuation">:</span> String<span class="token punctuation">,</span>
      required<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">// 用户密码</span>
    password<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      type<span class="token punctuation">:</span> String<span class="token punctuation">,</span>
      required<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      select<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">// 默认不会在查询中返回</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
		age<span class="token punctuation">:</span> <span class="token punctuation">{</span>
			type<span class="token punctuation">:</span> Number<span class="token punctuation">,</span>
			required<span class="token punctuation">:</span> <span class="token boolean">false</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">// 用户邮箱</span>
    email<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      type<span class="token punctuation">:</span> String<span class="token punctuation">,</span>
      required<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      unique<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 唯一索引</span>
      match<span class="token punctuation">:</span> <span class="token punctuation">[</span>
        <span class="token regex">/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/</span><span class="token punctuation">,</span>
        <span class="token string">&quot;Please enter a valid email&quot;</span><span class="token punctuation">,</span>
      <span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// 验证器</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> timestamps<span class="token punctuation">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span>
<span class="token punctuation">)</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> mongoose<span class="token punctuation">.</span><span class="token function">model</span><span class="token punctuation">(</span><span class="token string">&quot;user&quot;</span><span class="token punctuation">,</span> userSchema<span class="token punctuation">)</span>
</code></pre></div><h2 id="middleware"><a href="#middleware" aria-hidden="true" class="header-anchor">#</a> middleware</h2> <h3 id="auth-js"><a href="#auth-js" aria-hidden="true" class="header-anchor">#</a> auth.js</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// src/middleware/auth.js</span>
<span class="token keyword">const</span> jwt <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'jsonwebtoken'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> <span class="token constant">JWT_SECRET</span><span class="token punctuation">,</span> <span class="token constant">JWT_EXPIRES_IN</span> <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'../config'</span><span class="token punctuation">)</span>

<span class="token comment">// 为用户生成Token</span>
<span class="token keyword">const</span> <span class="token function-variable function">createJwtToken</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">user</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> jwt<span class="token punctuation">.</span><span class="token function">sign</span><span class="token punctuation">(</span>user<span class="token punctuation">,</span> <span class="token constant">JWT_SECRET</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    expiresIn<span class="token punctuation">:</span> <span class="token constant">JWT_EXPIRES_IN</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// 鉴权</span>
<span class="token keyword">const</span> <span class="token function-variable function">authenticate</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">req</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
	<span class="token keyword">const</span> header <span class="token operator">=</span> req<span class="token punctuation">.</span>request<span class="token punctuation">.</span>headers<span class="token punctuation">.</span>authorization
	<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>header<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">&quot;no authention, please login first&quot;</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
  <span class="token keyword">const</span> token <span class="token operator">=</span> header<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">&quot;Bearer &quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">)</span>

  <span class="token keyword">const</span> decoded <span class="token operator">=</span> jwt<span class="token punctuation">.</span><span class="token function">verify</span><span class="token punctuation">(</span>token<span class="token punctuation">,</span> <span class="token constant">JWT_SECRET</span><span class="token punctuation">)</span>
	<span class="token keyword">return</span> decoded
<span class="token punctuation">}</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
	createJwtToken<span class="token punctuation">,</span>
	authenticate
<span class="token punctuation">}</span>
</code></pre></div><h2 id="db"><a href="#db" aria-hidden="true" class="header-anchor">#</a> db</h2> <h3 id="index-js-2"><a href="#index-js-2" aria-hidden="true" class="header-anchor">#</a> index.js</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// src/db/index.js</span>
<span class="token keyword">const</span> mongoose <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;mongoose&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> <span class="token constant">MONGO_URI</span> <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'../config.js'</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> <span class="token function-variable function">connectDB</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">await</span> mongoose<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span><span class="token constant">MONGO_URI</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    useNewUrlParser<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    useUnifiedTopology<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
		useFindAndModify<span class="token punctuation">:</span><span class="token boolean">false</span><span class="token punctuation">,</span>
		useCreateIndex<span class="token punctuation">:</span><span class="token boolean">true</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`MongoDB connected`</span></span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span> connectDB <span class="token punctuation">}</span>
</code></pre></div><h2 id="controller"><a href="#controller" aria-hidden="true" class="header-anchor">#</a> controller</h2> <h3 id="index-js-3"><a href="#index-js-3" aria-hidden="true" class="header-anchor">#</a> index.js</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// src/controller/index.js</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  downloadController<span class="token punctuation">:</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./downloadController&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  qrImageController<span class="token punctuation">:</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./qrImageController&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  upLoaderController<span class="token punctuation">:</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./upLoaderController&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="downloadcontroller-js"><a href="#downloadcontroller-js" aria-hidden="true" class="header-anchor">#</a> downloadController.js</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// src/controller/downloadController.js</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> <span class="token function-variable function">downloadController</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
	<span class="token keyword">let</span> imageId <span class="token operator">=</span> req<span class="token punctuation">.</span>params<span class="token punctuation">[</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">]</span>
	<span class="token keyword">let</span> filePath <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span><span class="token string">'../../public'</span><span class="token punctuation">,</span><span class="token template-string"><span class="token string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>imageId<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">)</span>
	<span class="token keyword">const</span> fileStream <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">createReadStream</span><span class="token punctuation">(</span>filePath<span class="token punctuation">)</span>
	res<span class="token punctuation">.</span><span class="token function">writeHead</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token string">'Content-Type'</span><span class="token punctuation">:</span> <span class="token string">'image/png'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
	fileStream<span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> downloadController
</code></pre></div><h3 id="qrimagecontroller-js"><a href="#qrimagecontroller-js" aria-hidden="true" class="header-anchor">#</a> qrImageController.js</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// src/controller/qrImageController.js</span>
<span class="token keyword">const</span> qr <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'qr-image'</span><span class="token punctuation">)</span>
<span class="token comment">// 加载加密库</span>
<span class="token keyword">const</span> CryptoJS <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;crypto-js&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 加载DES算法</span>
<span class="token keyword">const</span> tripledes <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;crypto-js/tripledes&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">qrImageController</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;req.body&quot;</span><span class="token punctuation">,</span> req<span class="token punctuation">.</span>body<span class="token punctuation">)</span>
	<span class="token comment">// 1.拿到his发来请求中携带的用户id</span>
	<span class="token keyword">const</span> <span class="token punctuation">{</span> hosptialid<span class="token punctuation">,</span> insurcetype<span class="token punctuation">,</span> name<span class="token punctuation">,</span> sex<span class="token punctuation">,</span> idcard<span class="token punctuation">,</span> age <span class="token punctuation">}</span> <span class="token operator">=</span> req<span class="token punctuation">.</span>body
	<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>hosptialid <span class="token operator">||</span> <span class="token operator">!</span>insurcetype <span class="token operator">||</span> <span class="token operator">!</span>name <span class="token operator">||</span> <span class="token operator">!</span>sex <span class="token operator">||</span> <span class="token operator">!</span>idcard <span class="token operator">||</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> idcard<span class="token punctuation">)</span> <span class="token operator">!==</span> <span class="token string">'string'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		res<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">)</span>
		res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
			<span class="token string">&quot;message&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;The fields are missing or wrong&quot;</span>
		<span class="token punctuation">}</span><span class="token punctuation">)</span>
		<span class="token keyword">return</span>
	<span class="token punctuation">}</span>

	<span class="token comment">// 2. 生成二维码信息</span>
	<span class="token keyword">let</span> message <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token operator">...</span>req<span class="token punctuation">.</span>body<span class="token punctuation">}</span><span class="token punctuation">)</span>

	<span class="token comment">// 3. 生成秘钥</span>
	<span class="token keyword">const</span> key <span class="token operator">=</span> idcard

	<span class="token comment">// 4. 通过对称加密DES加密信息（秘钥就是用户自己的id）</span>
	<span class="token keyword">const</span> encryptResult <span class="token operator">=</span> tripledes<span class="token punctuation">.</span><span class="token function">encrypt</span><span class="token punctuation">(</span>message<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

	<span class="token comment">// 解密写法</span>
	<span class="token comment">// try {</span>
	<span class="token comment">// 	let plaintext  = tripledes.decrypt(encryptResult, key).toString(CryptoJS.enc.Utf8)</span>
	<span class="token comment">// 	console.log(&quot;plaintext&quot;,plaintext)</span>
	<span class="token comment">// 	console.log(JSON.parse(plaintext))</span>
	<span class="token comment">// } catch (error) {</span>
	<span class="token comment">// 	console.log(&quot;解析失败&quot;,error.toString())</span>
	<span class="token comment">// }</span>

	<span class="token comment">// 5. 根据加密信息生成二维码进行返回</span>
	<span class="token keyword">const</span> temp_qrcode <span class="token operator">=</span> qr<span class="token punctuation">.</span><span class="token function">image</span><span class="token punctuation">(</span>encryptResult<span class="token punctuation">,</span> <span class="token punctuation">{</span>type<span class="token punctuation">:</span> <span class="token string">'png'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
	res<span class="token punctuation">.</span><span class="token function">writeHead</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token string">'Content-Type'</span><span class="token punctuation">:</span> <span class="token string">'image/png'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
	temp_qrcode<span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> qrImageController
</code></pre></div><h3 id="uploadercontroller-js"><a href="#uploadercontroller-js" aria-hidden="true" class="header-anchor">#</a> upLoaderController.js</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// src/controller/upLoaderController.js</span>

<span class="token keyword">const</span> <span class="token function-variable function">upLoaderController</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
	<span class="token keyword">let</span> files <span class="token operator">=</span> req<span class="token punctuation">.</span>files<span class="token punctuation">;</span>
	<span class="token comment">// file信息如下</span>
	<span class="token comment">// {</span>
	<span class="token comment">// 	fieldname: 'avatar',</span>
	<span class="token comment">// 	originalname: 'kq.png',</span>
	<span class="token comment">// 	encoding: '7bit',</span>
	<span class="token comment">// 	mimetype: 'image/png',</span>
	<span class="token comment">// 	destination: 'public/',</span>
	<span class="token comment">// 	filename: '6f7d1a63467c6388383cabd64240a7bb',</span>
	<span class="token comment">// 	path: 'public\\6f7d1a63467c6388383cabd64240a7bb',</span>
  <span class="token comment">// 	size: 98036</span>
	<span class="token comment">// }</span>
	<span class="token comment">// 存路径到数据库</span>
	<span class="token keyword">let</span> resFileIdArray <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>files<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		resFileIdArray <span class="token operator">=</span> files<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">file</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
			<span class="token keyword">return</span> file<span class="token punctuation">.</span>filename
		<span class="token punctuation">}</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
  res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span>
		<span class="token punctuation">{</span>
			message<span class="token punctuation">:</span> resFileIdArray<span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">0</span> <span class="token operator">?</span><span class="token string">&quot;failed&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;ok&quot;</span><span class="token punctuation">,</span>
			fildId<span class="token punctuation">:</span> resFileIdArray
		<span class="token punctuation">}</span>
	<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> upLoaderController
</code></pre></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated: </span> <span class="time">3/8/2021, 4:20:03 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/node-GraphQL/GraphQL-fullstack-mongodb.html" class="prev">
          使用mongodb存储数据
        </a></span> <!----></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.1a394514.js" defer></script><script src="/assets/js/2.8304a06b.js" defer></script><script src="/assets/js/179.8ab2f01b.js" defer></script>
  </body>
</html>
