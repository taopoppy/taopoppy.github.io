<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>OAuth接入 | TaoPoppy</title>
    <meta name="description" content="陶振川">
    <link rel="icon" href="/meta.png">
    
    <link rel="preload" href="/assets/css/0.styles.32e41c9b.css" as="style"><link rel="preload" href="/assets/js/app.1a394514.js" as="script"><link rel="preload" href="/assets/js/2.8304a06b.js" as="script"><link rel="preload" href="/assets/js/302.aa40279f.js" as="script"><link rel="prefetch" href="/assets/js/10.7aef26de.js"><link rel="prefetch" href="/assets/js/100.b6a5dbe3.js"><link rel="prefetch" href="/assets/js/101.4cf14517.js"><link rel="prefetch" href="/assets/js/102.a10509c8.js"><link rel="prefetch" href="/assets/js/103.725c83f9.js"><link rel="prefetch" href="/assets/js/104.4cf52e25.js"><link rel="prefetch" href="/assets/js/105.fa93d42c.js"><link rel="prefetch" href="/assets/js/106.bc4f6131.js"><link rel="prefetch" href="/assets/js/107.720518ec.js"><link rel="prefetch" href="/assets/js/108.73134973.js"><link rel="prefetch" href="/assets/js/109.074b05fb.js"><link rel="prefetch" href="/assets/js/11.0781fb51.js"><link rel="prefetch" href="/assets/js/110.fa287650.js"><link rel="prefetch" href="/assets/js/111.66cf0003.js"><link rel="prefetch" href="/assets/js/112.ec18ad13.js"><link rel="prefetch" href="/assets/js/113.45a7c13a.js"><link rel="prefetch" href="/assets/js/114.8ac723f2.js"><link rel="prefetch" href="/assets/js/115.519d8940.js"><link rel="prefetch" href="/assets/js/116.c52bde55.js"><link rel="prefetch" href="/assets/js/117.35c583ff.js"><link rel="prefetch" href="/assets/js/118.6b209cf4.js"><link rel="prefetch" href="/assets/js/119.a3bd3fcb.js"><link rel="prefetch" href="/assets/js/12.75f1c153.js"><link rel="prefetch" href="/assets/js/120.45c18f2c.js"><link rel="prefetch" href="/assets/js/121.f1335403.js"><link rel="prefetch" href="/assets/js/122.4ddc6efe.js"><link rel="prefetch" href="/assets/js/123.3fedcfb9.js"><link rel="prefetch" href="/assets/js/124.57c3d5fd.js"><link rel="prefetch" href="/assets/js/125.98bb56f7.js"><link rel="prefetch" href="/assets/js/126.b4e3e7bc.js"><link rel="prefetch" href="/assets/js/127.aa4e7f95.js"><link rel="prefetch" href="/assets/js/128.08be9111.js"><link rel="prefetch" href="/assets/js/129.c32609eb.js"><link rel="prefetch" href="/assets/js/13.a3141dde.js"><link rel="prefetch" href="/assets/js/130.a0c93b04.js"><link rel="prefetch" href="/assets/js/131.dfae9fea.js"><link rel="prefetch" href="/assets/js/132.74845e19.js"><link rel="prefetch" href="/assets/js/133.cb7fc263.js"><link rel="prefetch" href="/assets/js/134.f9ae184c.js"><link rel="prefetch" href="/assets/js/135.273e7372.js"><link rel="prefetch" href="/assets/js/136.1da93b8e.js"><link rel="prefetch" href="/assets/js/137.198dbe16.js"><link rel="prefetch" href="/assets/js/138.64fac690.js"><link rel="prefetch" href="/assets/js/139.ac7f9fdf.js"><link rel="prefetch" href="/assets/js/14.023d10f2.js"><link rel="prefetch" href="/assets/js/140.a6685c82.js"><link rel="prefetch" href="/assets/js/141.96f04b23.js"><link rel="prefetch" href="/assets/js/142.cc5f5520.js"><link rel="prefetch" href="/assets/js/143.9b28c5f0.js"><link rel="prefetch" href="/assets/js/144.b0527ead.js"><link rel="prefetch" href="/assets/js/145.dad8d1ad.js"><link rel="prefetch" href="/assets/js/146.37619b4e.js"><link rel="prefetch" href="/assets/js/147.51353321.js"><link rel="prefetch" href="/assets/js/148.b7dbbadc.js"><link rel="prefetch" href="/assets/js/149.01c189f9.js"><link rel="prefetch" href="/assets/js/15.1ead8c76.js"><link rel="prefetch" href="/assets/js/150.6999137d.js"><link rel="prefetch" href="/assets/js/151.36a45175.js"><link rel="prefetch" href="/assets/js/152.f4c8c0a3.js"><link rel="prefetch" href="/assets/js/153.f04f1cfa.js"><link rel="prefetch" href="/assets/js/154.11f667b0.js"><link rel="prefetch" href="/assets/js/155.3df246f1.js"><link rel="prefetch" href="/assets/js/156.95c2a81f.js"><link rel="prefetch" href="/assets/js/157.4c4e453a.js"><link rel="prefetch" href="/assets/js/158.ea143735.js"><link rel="prefetch" href="/assets/js/159.1851c143.js"><link rel="prefetch" href="/assets/js/16.588b8a18.js"><link rel="prefetch" href="/assets/js/160.8623fd27.js"><link rel="prefetch" href="/assets/js/161.9f3dde39.js"><link rel="prefetch" href="/assets/js/162.ec8ada30.js"><link rel="prefetch" href="/assets/js/163.578cd511.js"><link rel="prefetch" href="/assets/js/164.5f326c38.js"><link rel="prefetch" href="/assets/js/165.d6055e4f.js"><link rel="prefetch" href="/assets/js/166.a4b38932.js"><link rel="prefetch" href="/assets/js/167.6a25e6a6.js"><link rel="prefetch" href="/assets/js/168.11291db9.js"><link rel="prefetch" href="/assets/js/169.3a6aec97.js"><link rel="prefetch" href="/assets/js/17.dbb0117f.js"><link rel="prefetch" href="/assets/js/170.c1b92e05.js"><link rel="prefetch" href="/assets/js/171.f06cccdb.js"><link rel="prefetch" href="/assets/js/172.26661658.js"><link rel="prefetch" href="/assets/js/173.ce718757.js"><link rel="prefetch" href="/assets/js/174.425859ee.js"><link rel="prefetch" href="/assets/js/175.b334be38.js"><link rel="prefetch" href="/assets/js/176.d29c1ef4.js"><link rel="prefetch" href="/assets/js/177.61e20b4a.js"><link rel="prefetch" href="/assets/js/178.f79fe9c5.js"><link rel="prefetch" href="/assets/js/179.8ab2f01b.js"><link rel="prefetch" href="/assets/js/18.5178d2f1.js"><link rel="prefetch" href="/assets/js/180.e1f584e7.js"><link rel="prefetch" href="/assets/js/181.384f8b65.js"><link rel="prefetch" href="/assets/js/182.675d4534.js"><link rel="prefetch" href="/assets/js/183.a5314419.js"><link rel="prefetch" href="/assets/js/184.49a4f95b.js"><link rel="prefetch" href="/assets/js/185.39566276.js"><link rel="prefetch" href="/assets/js/186.faf772f8.js"><link rel="prefetch" href="/assets/js/187.5e40a002.js"><link rel="prefetch" href="/assets/js/188.e9a85c75.js"><link rel="prefetch" href="/assets/js/189.4f6300fd.js"><link rel="prefetch" href="/assets/js/19.a3a8a3b2.js"><link rel="prefetch" href="/assets/js/190.5395a82d.js"><link rel="prefetch" href="/assets/js/191.c37e69d9.js"><link rel="prefetch" href="/assets/js/192.49c5336c.js"><link rel="prefetch" href="/assets/js/193.8358c1f7.js"><link rel="prefetch" href="/assets/js/194.f3baad75.js"><link rel="prefetch" href="/assets/js/195.9b64acde.js"><link rel="prefetch" href="/assets/js/196.af79cfd2.js"><link rel="prefetch" href="/assets/js/197.83502b3c.js"><link rel="prefetch" href="/assets/js/198.79a30060.js"><link rel="prefetch" href="/assets/js/199.4a4580d8.js"><link rel="prefetch" href="/assets/js/20.f7956ee9.js"><link rel="prefetch" href="/assets/js/200.ea5edefe.js"><link rel="prefetch" href="/assets/js/201.ba9f6baf.js"><link rel="prefetch" href="/assets/js/202.a684e81a.js"><link rel="prefetch" href="/assets/js/203.f6ae36b1.js"><link rel="prefetch" href="/assets/js/204.1b7d15f6.js"><link rel="prefetch" href="/assets/js/205.886aa300.js"><link rel="prefetch" href="/assets/js/206.4c920afb.js"><link rel="prefetch" href="/assets/js/207.84ff34f5.js"><link rel="prefetch" href="/assets/js/208.869b1786.js"><link rel="prefetch" href="/assets/js/209.46e7bcd8.js"><link rel="prefetch" href="/assets/js/21.a7419b80.js"><link rel="prefetch" href="/assets/js/210.8ae86200.js"><link rel="prefetch" href="/assets/js/211.8f174712.js"><link rel="prefetch" href="/assets/js/212.13a1cfde.js"><link rel="prefetch" href="/assets/js/213.2623c8b3.js"><link rel="prefetch" href="/assets/js/214.5f6c13ce.js"><link rel="prefetch" href="/assets/js/215.239ee6c0.js"><link rel="prefetch" href="/assets/js/216.bb2ce7ff.js"><link rel="prefetch" href="/assets/js/217.0708a1bc.js"><link rel="prefetch" href="/assets/js/218.9b44a3a0.js"><link rel="prefetch" href="/assets/js/219.872ef7dc.js"><link rel="prefetch" href="/assets/js/22.c95b31e3.js"><link rel="prefetch" href="/assets/js/220.d16ceb67.js"><link rel="prefetch" href="/assets/js/221.405b655a.js"><link rel="prefetch" href="/assets/js/222.fcbd0075.js"><link rel="prefetch" href="/assets/js/223.e48f31f2.js"><link rel="prefetch" href="/assets/js/224.f5562fa5.js"><link rel="prefetch" href="/assets/js/225.4c58f939.js"><link rel="prefetch" href="/assets/js/226.84e6ccf6.js"><link rel="prefetch" href="/assets/js/227.307e3114.js"><link rel="prefetch" href="/assets/js/228.f4bc2989.js"><link rel="prefetch" href="/assets/js/229.96ea2ba2.js"><link rel="prefetch" href="/assets/js/23.a75f3ddc.js"><link rel="prefetch" href="/assets/js/230.2ae85257.js"><link rel="prefetch" href="/assets/js/231.78d7510d.js"><link rel="prefetch" href="/assets/js/232.f5bf4f67.js"><link rel="prefetch" href="/assets/js/233.9102fdaa.js"><link rel="prefetch" href="/assets/js/234.a9e5e11a.js"><link rel="prefetch" href="/assets/js/235.71426295.js"><link rel="prefetch" href="/assets/js/236.03474465.js"><link rel="prefetch" href="/assets/js/237.48aed7b3.js"><link rel="prefetch" href="/assets/js/238.6a271b50.js"><link rel="prefetch" href="/assets/js/239.28d2a86b.js"><link rel="prefetch" href="/assets/js/24.84641855.js"><link rel="prefetch" href="/assets/js/240.22bca10d.js"><link rel="prefetch" href="/assets/js/241.2a279198.js"><link rel="prefetch" href="/assets/js/242.43b24484.js"><link rel="prefetch" href="/assets/js/243.fe9d5ea9.js"><link rel="prefetch" href="/assets/js/244.d39e950f.js"><link rel="prefetch" href="/assets/js/245.64db6d12.js"><link rel="prefetch" href="/assets/js/246.5b1f1745.js"><link rel="prefetch" href="/assets/js/247.d1ab0e2b.js"><link rel="prefetch" href="/assets/js/248.a19e36bd.js"><link rel="prefetch" href="/assets/js/249.3aa723c7.js"><link rel="prefetch" href="/assets/js/25.73570942.js"><link rel="prefetch" href="/assets/js/250.0f968bec.js"><link rel="prefetch" href="/assets/js/251.9ade3872.js"><link rel="prefetch" href="/assets/js/252.72e1aa12.js"><link rel="prefetch" href="/assets/js/253.374cc99e.js"><link rel="prefetch" href="/assets/js/254.44800bf9.js"><link rel="prefetch" href="/assets/js/255.06241cb8.js"><link rel="prefetch" href="/assets/js/256.bbeaafaa.js"><link rel="prefetch" href="/assets/js/257.14e8b661.js"><link rel="prefetch" href="/assets/js/258.0913e120.js"><link rel="prefetch" href="/assets/js/259.32bd3bf9.js"><link rel="prefetch" href="/assets/js/26.9a79c041.js"><link rel="prefetch" href="/assets/js/260.e5a40c02.js"><link rel="prefetch" href="/assets/js/261.4c8be7b1.js"><link rel="prefetch" href="/assets/js/262.0663f55e.js"><link rel="prefetch" href="/assets/js/263.cecc1123.js"><link rel="prefetch" href="/assets/js/264.d2209296.js"><link rel="prefetch" href="/assets/js/265.497bc01b.js"><link rel="prefetch" href="/assets/js/266.769ac5e0.js"><link rel="prefetch" href="/assets/js/267.6b97962f.js"><link rel="prefetch" href="/assets/js/268.fa6635c8.js"><link rel="prefetch" href="/assets/js/269.c1e74469.js"><link rel="prefetch" href="/assets/js/27.0dd62438.js"><link rel="prefetch" href="/assets/js/270.4e8f8d77.js"><link rel="prefetch" href="/assets/js/271.f27f2f56.js"><link rel="prefetch" href="/assets/js/272.d1349876.js"><link rel="prefetch" href="/assets/js/273.e967ea79.js"><link rel="prefetch" href="/assets/js/274.7c9df4ce.js"><link rel="prefetch" href="/assets/js/275.5b85e62c.js"><link rel="prefetch" href="/assets/js/276.c09ef549.js"><link rel="prefetch" href="/assets/js/277.58b59a93.js"><link rel="prefetch" href="/assets/js/278.e91f9b01.js"><link rel="prefetch" href="/assets/js/279.3159509a.js"><link rel="prefetch" href="/assets/js/28.685ccac3.js"><link rel="prefetch" href="/assets/js/280.8878bc0d.js"><link rel="prefetch" href="/assets/js/281.c7e08ecb.js"><link rel="prefetch" href="/assets/js/282.85066f7c.js"><link rel="prefetch" href="/assets/js/283.80120ef1.js"><link rel="prefetch" href="/assets/js/284.1f719606.js"><link rel="prefetch" href="/assets/js/285.b4a3cea5.js"><link rel="prefetch" href="/assets/js/286.2ebd0b34.js"><link rel="prefetch" href="/assets/js/287.8e141966.js"><link rel="prefetch" href="/assets/js/288.ea2f74f5.js"><link rel="prefetch" href="/assets/js/289.beba8c8e.js"><link rel="prefetch" href="/assets/js/29.d9a2cd59.js"><link rel="prefetch" href="/assets/js/290.fd587ae1.js"><link rel="prefetch" href="/assets/js/291.e0b87667.js"><link rel="prefetch" href="/assets/js/292.d86d8fa2.js"><link rel="prefetch" href="/assets/js/293.f176a900.js"><link rel="prefetch" href="/assets/js/294.536a81c8.js"><link rel="prefetch" href="/assets/js/295.54f88831.js"><link rel="prefetch" href="/assets/js/296.7c5ad5dd.js"><link rel="prefetch" href="/assets/js/297.cf9a4601.js"><link rel="prefetch" href="/assets/js/298.a844a174.js"><link rel="prefetch" href="/assets/js/299.809942fc.js"><link rel="prefetch" href="/assets/js/3.5dd59f66.js"><link rel="prefetch" href="/assets/js/30.1ca80117.js"><link rel="prefetch" href="/assets/js/300.bc9809ff.js"><link rel="prefetch" href="/assets/js/301.d677b5b5.js"><link rel="prefetch" href="/assets/js/303.070e632e.js"><link rel="prefetch" href="/assets/js/304.3d695df8.js"><link rel="prefetch" href="/assets/js/305.44e261e9.js"><link rel="prefetch" href="/assets/js/306.e2f7ad64.js"><link rel="prefetch" href="/assets/js/307.83982154.js"><link rel="prefetch" href="/assets/js/308.4db5bbe7.js"><link rel="prefetch" href="/assets/js/309.3aa975c1.js"><link rel="prefetch" href="/assets/js/31.440aa4c9.js"><link rel="prefetch" href="/assets/js/310.614e3c2f.js"><link rel="prefetch" href="/assets/js/311.ebda45a9.js"><link rel="prefetch" href="/assets/js/312.52cdf585.js"><link rel="prefetch" href="/assets/js/313.1f984642.js"><link rel="prefetch" href="/assets/js/314.fd4722eb.js"><link rel="prefetch" href="/assets/js/315.14d7045f.js"><link rel="prefetch" href="/assets/js/316.8f4cc226.js"><link rel="prefetch" href="/assets/js/317.21630e12.js"><link rel="prefetch" href="/assets/js/318.9a5c960e.js"><link rel="prefetch" href="/assets/js/319.06f7dacf.js"><link rel="prefetch" href="/assets/js/32.27f34442.js"><link rel="prefetch" href="/assets/js/320.e426fea5.js"><link rel="prefetch" href="/assets/js/321.46a426b9.js"><link rel="prefetch" href="/assets/js/322.7256b9c8.js"><link rel="prefetch" href="/assets/js/323.5b848b7f.js"><link rel="prefetch" href="/assets/js/324.e8eedaac.js"><link rel="prefetch" href="/assets/js/325.54947978.js"><link rel="prefetch" href="/assets/js/326.03bfd5b9.js"><link rel="prefetch" href="/assets/js/327.34a2ec4d.js"><link rel="prefetch" href="/assets/js/328.4e023633.js"><link rel="prefetch" href="/assets/js/329.b218e68f.js"><link rel="prefetch" href="/assets/js/33.f6658b03.js"><link rel="prefetch" href="/assets/js/330.a8a2750a.js"><link rel="prefetch" href="/assets/js/331.0df9ca3a.js"><link rel="prefetch" href="/assets/js/332.95c19161.js"><link rel="prefetch" href="/assets/js/333.c6e765b9.js"><link rel="prefetch" href="/assets/js/334.c79e3b52.js"><link rel="prefetch" href="/assets/js/335.49fcd3ab.js"><link rel="prefetch" href="/assets/js/336.5c2ccd1d.js"><link rel="prefetch" href="/assets/js/337.fd6692e6.js"><link rel="prefetch" href="/assets/js/338.e0f59f10.js"><link rel="prefetch" href="/assets/js/339.04196614.js"><link rel="prefetch" href="/assets/js/34.17b5b881.js"><link rel="prefetch" href="/assets/js/340.05e21d65.js"><link rel="prefetch" href="/assets/js/341.15ff2a62.js"><link rel="prefetch" href="/assets/js/342.ae7694ad.js"><link rel="prefetch" href="/assets/js/343.f4a5186c.js"><link rel="prefetch" href="/assets/js/344.4caf3fa0.js"><link rel="prefetch" href="/assets/js/345.214e2189.js"><link rel="prefetch" href="/assets/js/346.f613921f.js"><link rel="prefetch" href="/assets/js/347.626136bf.js"><link rel="prefetch" href="/assets/js/348.cf4b86a4.js"><link rel="prefetch" href="/assets/js/349.2a62c487.js"><link rel="prefetch" href="/assets/js/35.e99d5a01.js"><link rel="prefetch" href="/assets/js/350.389648a3.js"><link rel="prefetch" href="/assets/js/351.81305cad.js"><link rel="prefetch" href="/assets/js/352.d7a80ffa.js"><link rel="prefetch" href="/assets/js/353.0929bd7f.js"><link rel="prefetch" href="/assets/js/354.87d7184c.js"><link rel="prefetch" href="/assets/js/355.1dd69433.js"><link rel="prefetch" href="/assets/js/356.b969449b.js"><link rel="prefetch" href="/assets/js/357.16cecac1.js"><link rel="prefetch" href="/assets/js/358.ef6c9df0.js"><link rel="prefetch" href="/assets/js/359.8b33b863.js"><link rel="prefetch" href="/assets/js/36.8e7e289a.js"><link rel="prefetch" href="/assets/js/360.089cc7ad.js"><link rel="prefetch" href="/assets/js/361.9a59c5c5.js"><link rel="prefetch" href="/assets/js/362.a8026d31.js"><link rel="prefetch" href="/assets/js/363.c3bb2718.js"><link rel="prefetch" href="/assets/js/364.62014d33.js"><link rel="prefetch" href="/assets/js/365.00a229da.js"><link rel="prefetch" href="/assets/js/366.5c57901c.js"><link rel="prefetch" href="/assets/js/367.ad1d6755.js"><link rel="prefetch" href="/assets/js/368.64dc7bec.js"><link rel="prefetch" href="/assets/js/369.406cd3d7.js"><link rel="prefetch" href="/assets/js/37.4f733baf.js"><link rel="prefetch" href="/assets/js/370.750f2303.js"><link rel="prefetch" href="/assets/js/371.6cc0e13d.js"><link rel="prefetch" href="/assets/js/372.ed729131.js"><link rel="prefetch" href="/assets/js/373.c369c4c9.js"><link rel="prefetch" href="/assets/js/374.d3a57fb2.js"><link rel="prefetch" href="/assets/js/375.21d68193.js"><link rel="prefetch" href="/assets/js/376.25d9d5f3.js"><link rel="prefetch" href="/assets/js/377.c7ebd0c2.js"><link rel="prefetch" href="/assets/js/378.c733ec30.js"><link rel="prefetch" href="/assets/js/379.d6cf1c34.js"><link rel="prefetch" href="/assets/js/38.86de11d5.js"><link rel="prefetch" href="/assets/js/380.9abd3090.js"><link rel="prefetch" href="/assets/js/381.1fc3ec03.js"><link rel="prefetch" href="/assets/js/382.d0d2e795.js"><link rel="prefetch" href="/assets/js/383.bd308361.js"><link rel="prefetch" href="/assets/js/384.c2a5969a.js"><link rel="prefetch" href="/assets/js/385.20c11f56.js"><link rel="prefetch" href="/assets/js/386.631b9af2.js"><link rel="prefetch" href="/assets/js/387.8f59e0b5.js"><link rel="prefetch" href="/assets/js/388.5b1951cd.js"><link rel="prefetch" href="/assets/js/389.2e942f96.js"><link rel="prefetch" href="/assets/js/39.153b6ec6.js"><link rel="prefetch" href="/assets/js/390.341a807c.js"><link rel="prefetch" href="/assets/js/391.c9bd676c.js"><link rel="prefetch" href="/assets/js/392.ac05ebea.js"><link rel="prefetch" href="/assets/js/393.6989a857.js"><link rel="prefetch" href="/assets/js/394.744402ae.js"><link rel="prefetch" href="/assets/js/395.a0636831.js"><link rel="prefetch" href="/assets/js/396.9e92309a.js"><link rel="prefetch" href="/assets/js/397.867afb5d.js"><link rel="prefetch" href="/assets/js/398.261fe9bc.js"><link rel="prefetch" href="/assets/js/399.83573ac7.js"><link rel="prefetch" href="/assets/js/4.1b11a2b1.js"><link rel="prefetch" href="/assets/js/40.77cd485e.js"><link rel="prefetch" href="/assets/js/400.333909ad.js"><link rel="prefetch" href="/assets/js/401.9c9ae0ae.js"><link rel="prefetch" href="/assets/js/402.50b49502.js"><link rel="prefetch" href="/assets/js/403.c0d1aa14.js"><link rel="prefetch" href="/assets/js/404.24e4f5ba.js"><link rel="prefetch" href="/assets/js/405.09e8422c.js"><link rel="prefetch" href="/assets/js/406.1e91805d.js"><link rel="prefetch" href="/assets/js/407.2393ac65.js"><link rel="prefetch" href="/assets/js/408.e0df89f7.js"><link rel="prefetch" href="/assets/js/409.58e7dc26.js"><link rel="prefetch" href="/assets/js/41.67fda662.js"><link rel="prefetch" href="/assets/js/410.e9c06b6a.js"><link rel="prefetch" href="/assets/js/411.bbe28a09.js"><link rel="prefetch" href="/assets/js/412.44a068c9.js"><link rel="prefetch" href="/assets/js/413.b76704b3.js"><link rel="prefetch" href="/assets/js/414.32590ba0.js"><link rel="prefetch" href="/assets/js/415.60884e6d.js"><link rel="prefetch" href="/assets/js/416.119019d8.js"><link rel="prefetch" href="/assets/js/417.277cf86c.js"><link rel="prefetch" href="/assets/js/418.fb313fbc.js"><link rel="prefetch" href="/assets/js/419.3eba15ec.js"><link rel="prefetch" href="/assets/js/42.7e56f2cd.js"><link rel="prefetch" href="/assets/js/420.c6d3f2a0.js"><link rel="prefetch" href="/assets/js/421.0939406a.js"><link rel="prefetch" href="/assets/js/422.f9975cec.js"><link rel="prefetch" href="/assets/js/423.fb455c5f.js"><link rel="prefetch" href="/assets/js/424.01dea30b.js"><link rel="prefetch" href="/assets/js/425.ae78c193.js"><link rel="prefetch" href="/assets/js/426.01ffc131.js"><link rel="prefetch" href="/assets/js/427.ca692320.js"><link rel="prefetch" href="/assets/js/428.db29a47a.js"><link rel="prefetch" href="/assets/js/429.954aaaf1.js"><link rel="prefetch" href="/assets/js/43.d0246dae.js"><link rel="prefetch" href="/assets/js/430.b2c8abce.js"><link rel="prefetch" href="/assets/js/431.238123f0.js"><link rel="prefetch" href="/assets/js/432.459a70b6.js"><link rel="prefetch" href="/assets/js/433.ec112349.js"><link rel="prefetch" href="/assets/js/434.d11bf56d.js"><link rel="prefetch" href="/assets/js/435.98d79cdc.js"><link rel="prefetch" href="/assets/js/436.78b0e462.js"><link rel="prefetch" href="/assets/js/437.17bafd8b.js"><link rel="prefetch" href="/assets/js/438.462d1929.js"><link rel="prefetch" href="/assets/js/439.1f5c292d.js"><link rel="prefetch" href="/assets/js/44.eb3d088f.js"><link rel="prefetch" href="/assets/js/440.b139dc54.js"><link rel="prefetch" href="/assets/js/441.2fae1d62.js"><link rel="prefetch" href="/assets/js/45.39adc1d2.js"><link rel="prefetch" href="/assets/js/46.93061422.js"><link rel="prefetch" href="/assets/js/47.0dc9e596.js"><link rel="prefetch" href="/assets/js/48.68f070d6.js"><link rel="prefetch" href="/assets/js/49.a29d9572.js"><link rel="prefetch" href="/assets/js/5.37e3a575.js"><link rel="prefetch" href="/assets/js/50.0b46a629.js"><link rel="prefetch" href="/assets/js/51.c7712d08.js"><link rel="prefetch" href="/assets/js/52.8fdf333b.js"><link rel="prefetch" href="/assets/js/53.1e5f8a94.js"><link rel="prefetch" href="/assets/js/54.41216d39.js"><link rel="prefetch" href="/assets/js/55.34d14bf4.js"><link rel="prefetch" href="/assets/js/56.b7d3b6ca.js"><link rel="prefetch" href="/assets/js/57.9646b246.js"><link rel="prefetch" href="/assets/js/58.5446709c.js"><link rel="prefetch" href="/assets/js/59.0fac1fa2.js"><link rel="prefetch" href="/assets/js/6.41004de5.js"><link rel="prefetch" href="/assets/js/60.8a2d1be8.js"><link rel="prefetch" href="/assets/js/61.77eca8ce.js"><link rel="prefetch" href="/assets/js/62.277c8f17.js"><link rel="prefetch" href="/assets/js/63.8b203bb2.js"><link rel="prefetch" href="/assets/js/64.d466d2b9.js"><link rel="prefetch" href="/assets/js/65.7c4cb8d5.js"><link rel="prefetch" href="/assets/js/66.71b38fe1.js"><link rel="prefetch" href="/assets/js/67.e0b107a2.js"><link rel="prefetch" href="/assets/js/68.7d64bb4b.js"><link rel="prefetch" href="/assets/js/69.9cdbcfeb.js"><link rel="prefetch" href="/assets/js/7.67d94aac.js"><link rel="prefetch" href="/assets/js/70.eb1c9224.js"><link rel="prefetch" href="/assets/js/71.51e0c37c.js"><link rel="prefetch" href="/assets/js/72.cba6948f.js"><link rel="prefetch" href="/assets/js/73.6abd4dce.js"><link rel="prefetch" href="/assets/js/74.b5fa6c08.js"><link rel="prefetch" href="/assets/js/75.8f34d79a.js"><link rel="prefetch" href="/assets/js/76.5fc9c80d.js"><link rel="prefetch" href="/assets/js/77.6e4a5e93.js"><link rel="prefetch" href="/assets/js/78.bffd6a40.js"><link rel="prefetch" href="/assets/js/79.1a7f5d0e.js"><link rel="prefetch" href="/assets/js/8.e4995b94.js"><link rel="prefetch" href="/assets/js/80.b70c1106.js"><link rel="prefetch" href="/assets/js/81.4476a49e.js"><link rel="prefetch" href="/assets/js/82.f40aa218.js"><link rel="prefetch" href="/assets/js/83.d4c57d4f.js"><link rel="prefetch" href="/assets/js/84.d1dc86f7.js"><link rel="prefetch" href="/assets/js/85.dd779a2e.js"><link rel="prefetch" href="/assets/js/86.569cfbc2.js"><link rel="prefetch" href="/assets/js/87.938a5bd8.js"><link rel="prefetch" href="/assets/js/88.2d3dadd7.js"><link rel="prefetch" href="/assets/js/89.3aeee704.js"><link rel="prefetch" href="/assets/js/9.54a41cce.js"><link rel="prefetch" href="/assets/js/90.2b47965b.js"><link rel="prefetch" href="/assets/js/91.58aa3587.js"><link rel="prefetch" href="/assets/js/92.47d2a191.js"><link rel="prefetch" href="/assets/js/93.ff10ac69.js"><link rel="prefetch" href="/assets/js/94.a8d90c0c.js"><link rel="prefetch" href="/assets/js/95.15ae9c48.js"><link rel="prefetch" href="/assets/js/96.43aa4adb.js"><link rel="prefetch" href="/assets/js/97.4eb74c93.js"><link rel="prefetch" href="/assets/js/98.94686ad8.js"><link rel="prefetch" href="/assets/js/99.ceb4f2f1.js">
    <link rel="stylesheet" href="/assets/css/0.styles.32e41c9b.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">TaoPoppy</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/learnMaterials/" class="nav-link">资料</a></div><div class="nav-item"><a href="https://github.com/taopoppy/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="/construct/" class="nav-link">小技巧</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">小程序</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/WeiXin-Rumen/" class="nav-link">微信小程序入门和实战</a></li><li class="dropdown-item"><!----> <a href="/Weixin-quanzhan/" class="nav-link">微信小程序全栈开发实战</a></li><li class="dropdown-item"><!----> <a href="/WeiXin-Combat/" class="nav-link">微信小程序云开发实战</a></li><li class="dropdown-item"><!----> <a href="/WeiXin-money/" class="nav-link">微信支付和分享</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">工具系列</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Jest/" class="nav-link">前端自动化测试</a></li><li class="dropdown-item"><!----> <a href="/Webpack/" class="nav-link">前端工程化</a></li><li class="dropdown-item"><!----> <a href="/Optimization/" class="nav-link">前端性能优化</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Go</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/go/" class="nav-link">go语言入门实践</a></li><li class="dropdown-item"><!----> <a href="/go-concurrent/" class="nav-link">go并发编程详解</a></li><li class="dropdown-item"><!----> <a href="/go-web/" class="nav-link">go与web编程实战</a></li><li class="dropdown-item"><!----> <a href="/go-reptile/" class="nav-link">go爬虫编程实战</a></li><li class="dropdown-item"><!----> <a href="/Beego/" class="nav-link">Beego框架入门</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">node</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/node/" class="nav-link">node入门</a></li><li class="dropdown-item"><!----> <a href="/node-RESTful/" class="nav-link">node与RESTful</a></li><li class="dropdown-item"><!----> <a href="/node-GraphQL/" class="nav-link">node与GraphQL</a></li><li class="dropdown-item"><!----> <a href="/node-BFF/" class="nav-link">node与BFF</a></li><li class="dropdown-item"><!----> <a href="/node-blog/" class="nav-link">node博客后台</a></li><li class="dropdown-item"><!----> <a href="/node-weibo/" class="nav-link">node实战微博</a></li><li class="dropdown-item"><!----> <a href="/node-microService/" class="nav-link">node微服务</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">react</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/react-redux/" class="nav-link">React+Redux入门详解</a></li><li class="dropdown-item"><!----> <a href="/react-typescript/" class="nav-link">React+TypeScript的完美结合</a></li><li class="dropdown-item"><!----> <a href="/react-webapp/" class="nav-link">React网易云Webapp</a></li><li class="dropdown-item"><!----> <a href="/react-ssr/" class="nav-link router-link-active">React服务器渲染原理解析</a></li><li class="dropdown-item"><!----> <a href="/react-source/" class="nav-link">React深度剖析和源码解析</a></li><li class="dropdown-item"><!----> <a href="/react-antd/" class="nav-link">React+Typescript开发组件库</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">vue</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vue-ssr/" class="nav-link">Vue服务端渲染原理解析</a></li><li class="dropdown-item"><!----> <a href="/vue-interview/" class="nav-link">Vue3入门和实践</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">后端系列</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>数据库</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/Mysql/" class="nav-link">mysql</a></li><li class="dropdown-subitem"><a href="/Mysql-Architecture/" class="nav-link">mysql-Architecture</a></li></ul></li><li class="dropdown-item"><h4>linux操作系统</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/Linux/" class="nav-link">linux</a></li><li class="dropdown-subitem"><a href="/Linux-Architecture/" class="nav-link">linux-Architecture</a></li></ul></li><li class="dropdown-item"><h4>网络协议</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/Protocol/" class="nav-link">protocol</a></li><li class="dropdown-subitem"><a href="/react-ssr/font-end-protocol.html" class="nav-link">font-end-protocol</a></li></ul></li><li class="dropdown-item"><h4>运维系统</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/prometheus/" class="nav-link">prometheus</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">前端系列</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Front-end/" class="nav-link">前端初级面试</a></li><li class="dropdown-item"><!----> <a href="/Front-advance/" class="nav-link">前端中级面试</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">究极全栈</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Big-Front-End/" class="nav-link">大前端</a></li><li class="dropdown-item"><!----> <a href="/Web-Architect/" class="nav-link">web架构课</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/learnMaterials/" class="nav-link">资料</a></div><div class="nav-item"><a href="https://github.com/taopoppy/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="/construct/" class="nav-link">小技巧</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">小程序</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/WeiXin-Rumen/" class="nav-link">微信小程序入门和实战</a></li><li class="dropdown-item"><!----> <a href="/Weixin-quanzhan/" class="nav-link">微信小程序全栈开发实战</a></li><li class="dropdown-item"><!----> <a href="/WeiXin-Combat/" class="nav-link">微信小程序云开发实战</a></li><li class="dropdown-item"><!----> <a href="/WeiXin-money/" class="nav-link">微信支付和分享</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">工具系列</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Jest/" class="nav-link">前端自动化测试</a></li><li class="dropdown-item"><!----> <a href="/Webpack/" class="nav-link">前端工程化</a></li><li class="dropdown-item"><!----> <a href="/Optimization/" class="nav-link">前端性能优化</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Go</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/go/" class="nav-link">go语言入门实践</a></li><li class="dropdown-item"><!----> <a href="/go-concurrent/" class="nav-link">go并发编程详解</a></li><li class="dropdown-item"><!----> <a href="/go-web/" class="nav-link">go与web编程实战</a></li><li class="dropdown-item"><!----> <a href="/go-reptile/" class="nav-link">go爬虫编程实战</a></li><li class="dropdown-item"><!----> <a href="/Beego/" class="nav-link">Beego框架入门</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">node</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/node/" class="nav-link">node入门</a></li><li class="dropdown-item"><!----> <a href="/node-RESTful/" class="nav-link">node与RESTful</a></li><li class="dropdown-item"><!----> <a href="/node-GraphQL/" class="nav-link">node与GraphQL</a></li><li class="dropdown-item"><!----> <a href="/node-BFF/" class="nav-link">node与BFF</a></li><li class="dropdown-item"><!----> <a href="/node-blog/" class="nav-link">node博客后台</a></li><li class="dropdown-item"><!----> <a href="/node-weibo/" class="nav-link">node实战微博</a></li><li class="dropdown-item"><!----> <a href="/node-microService/" class="nav-link">node微服务</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">react</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/react-redux/" class="nav-link">React+Redux入门详解</a></li><li class="dropdown-item"><!----> <a href="/react-typescript/" class="nav-link">React+TypeScript的完美结合</a></li><li class="dropdown-item"><!----> <a href="/react-webapp/" class="nav-link">React网易云Webapp</a></li><li class="dropdown-item"><!----> <a href="/react-ssr/" class="nav-link router-link-active">React服务器渲染原理解析</a></li><li class="dropdown-item"><!----> <a href="/react-source/" class="nav-link">React深度剖析和源码解析</a></li><li class="dropdown-item"><!----> <a href="/react-antd/" class="nav-link">React+Typescript开发组件库</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">vue</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vue-ssr/" class="nav-link">Vue服务端渲染原理解析</a></li><li class="dropdown-item"><!----> <a href="/vue-interview/" class="nav-link">Vue3入门和实践</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">后端系列</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>数据库</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/Mysql/" class="nav-link">mysql</a></li><li class="dropdown-subitem"><a href="/Mysql-Architecture/" class="nav-link">mysql-Architecture</a></li></ul></li><li class="dropdown-item"><h4>linux操作系统</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/Linux/" class="nav-link">linux</a></li><li class="dropdown-subitem"><a href="/Linux-Architecture/" class="nav-link">linux-Architecture</a></li></ul></li><li class="dropdown-item"><h4>网络协议</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/Protocol/" class="nav-link">protocol</a></li><li class="dropdown-subitem"><a href="/react-ssr/font-end-protocol.html" class="nav-link">font-end-protocol</a></li></ul></li><li class="dropdown-item"><h4>运维系统</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/prometheus/" class="nav-link">prometheus</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">前端系列</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Front-end/" class="nav-link">前端初级面试</a></li><li class="dropdown-item"><!----> <a href="/Front-advance/" class="nav-link">前端中级面试</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">究极全栈</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Big-Front-End/" class="nav-link">大前端</a></li><li class="dropdown-item"><!----> <a href="/Web-Architect/" class="nav-link">web架构课</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/react-ssr/" class="sidebar-link">React 服务端渲染</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>React_SSR_原理基础</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>React_SSR_原理进阶</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>React_SSR_原理高级</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>React_SSR_实战基础</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/react-ssr/ssr_combat_project_one.html" class="sidebar-link">项目搭建流程</a></li><li><a href="/react-ssr/ssr_combat_project_two.html" class="sidebar-link">nextjs的基本使用</a></li><li><a href="/react-ssr/ssr_combat_project_three.html" class="sidebar-link">Hook新特性</a></li><li><a href="/react-ssr/ssr_combat_project_four.html" class="sidebar-link">引入Redux</a></li><li><a href="/react-ssr/ssr_combat_project_five.html" class="active sidebar-link">OAuth接入</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/react-ssr/ssr_combat_project_five.html#认证和授权" class="sidebar-link">认证和授权</a></li><li class="sidebar-sub-header"><a href="/react-ssr/ssr_combat_project_five.html#什么是oauth" class="sidebar-link">什么是OAuth</a></li><li class="sidebar-sub-header"><a href="/react-ssr/ssr_combat_project_five.html#oauth的认证流程" class="sidebar-link">OAuth的认证流程</a></li><li class="sidebar-sub-header"><a href="/react-ssr/ssr_combat_project_five.html#注册github-oauth-app" class="sidebar-link">注册github-OAuth-App</a></li><li class="sidebar-sub-header"><a href="/react-ssr/ssr_combat_project_five.html#oauth字段讲解" class="sidebar-link">OAuth字段讲解</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/react-ssr/ssr_combat_project_five.html#_1-跳转字段" class="sidebar-link">1. 跳转字段</a></li><li class="sidebar-sub-header"><a href="/react-ssr/ssr_combat_project_five.html#_2-请求token字段" class="sidebar-link">2. 请求token字段</a></li></ul></li><li class="sidebar-sub-header"><a href="/react-ssr/ssr_combat_project_five.html#oauth-code认证和安全" class="sidebar-link">OAuth-code认证和安全</a></li><li class="sidebar-sub-header"><a href="/react-ssr/ssr_combat_project_five.html#cookie和session" class="sidebar-link">cookie和session</a></li><li class="sidebar-sub-header"><a href="/react-ssr/ssr_combat_project_five.html#github-oauth接入" class="sidebar-link">Github OAuth接入</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/react-ssr/ssr_combat_project_five.html#_1-创建第三方登录链接" class="sidebar-link">1. 创建第三方登录链接</a></li><li class="sidebar-sub-header"><a href="/react-ssr/ssr_combat_project_five.html#_2-创建路由" class="sidebar-link">2. 创建路由</a></li></ul></li></ul></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>React_SSR_实战项目</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="oauth接入"><a href="#oauth接入" aria-hidden="true" class="header-anchor">#</a> OAuth接入</h1> <h2 id="认证和授权"><a href="#认证和授权" aria-hidden="true" class="header-anchor">#</a> 认证和授权</h2> <p>认证（<code>Authentication</code>）是什么？<font color="#DD1144">通俗的来说就是：你怎么证明你是你自己，证明自己是某种身份</font>，比如身份证是用来帮助你证明你是中华人民共和国公民，学生证证明你是某个大学的学生，在互联网当中，用户名和密码可以代表你是网站中的已注册过的用户。</p> <p>当然互联网中的认证有<font color="#1E90FF">用户名和密码</font>、<font color="#1E90FF">邮箱发送登录连接</font>、<font color="#1E90FF">手机号接收验证码</font>，完成一个高可用的认证系统是很难的，考虑的问题很多，比如让用户设置高强度的密码、密码存储进行加密、使用<code>https</code>保证客户端和服务端进行安全通行，防止密码被中间人获取等等，所以这都是很复杂的东西</p> <p>但是使用<code>OAuth</code>就可以很方便的避免考虑这些问题，<font color="#DD1144">OAuth帮助我们实现了认证，我们只需要等待授权</font></p> <p>授权（<code>Authorization</code>）,<font color="#1E90FF">通俗的来说就是你有做哪些事情的权利</font>，比如在安装手机应用的时候会询问你应用是否可以访问手机的某些功能，还比如操作系统有很多用户，除了root用户有所有的操作的权利，其他用户只有部分权利。同理在<code>OAuth</code>后，被授权方会收获一定的权限。</p> <p>在网页当中，最直观的授权就是<code>cookie</code>，比如我们登陆<code>github</code>的时候，使用密码登录到<code>github</code>服务器实现了对用户的认证，然后<code>github</code>服务器会给你所使用的当前的浏览器一些权利，权利的容器实际上就是<code>cookie</code>，所以你在后面去做其他事情的时候浏览器向<code>github</code>服务器发送请求的时候会携带这个<code>cookie</code>，表示我有你给我权利去做这个事情。</p> <p><font color="#DD1144">但是授权并不一定要先认证</font>、比如发放优惠券，商家是不知道这些优惠券最终会在谁的手上，但是只要你持有优惠券就可以享受优惠，<font color="#9400D3">OAuth就是授权的一种方式，通过token的方式进行权限的授予的</font></p> <h2 id="什么是oauth"><a href="#什么是oauth" aria-hidden="true" class="header-anchor">#</a> 什么是OAuth</h2> <p><font color="#9400D3">OAuth是一种行业标准的授权方式</font>，在这种方式当中存在了三个角色，分别是<font color="#1E90FF">客户端</font>、<font color="#1E90FF">服务端</font>、<font color="#1E90FF">授权服务器</font>，基本就是围绕在这三个角色中进行的。</p> <p><font color="#DD1144">OAuth有多种授权方式</font>，比如</p> <ul><li><code>Authorization Code</code>（最好用，学习重点）</li> <li><code>Refresh Token</code>（不常用的协议）</li> <li><code>Device Code</code>（不常用）</li> <li><code>Password</code>（不太安全）</li> <li><code>Implicit</code>（不安全）</li> <li><code>Client Credentials</code>（客户端的相关权限，和用户无关）</li></ul> <p>要注意的时候，虽然<code>OAuth</code>有这么多的授权方式，但是每个<code>OAuth</code>提供商并不一定提供这么多的方式，有的可能只支持其中的一种授权方式，具体的要看提供商怎么提供的</p> <img src="/react_ssr_oauth_one.png" alt="Authorization Code"> <ul><li><p><font color="#9400D3">网站使用OAuth需要到github上去申请，申请之后会获得client_id和client_secret</font></p></li> <li><p><font color="#9400D3">首先要在我们的网页上发起一个redirect，并携带上client_id，让github知道用户现在要给哪个客户端授权</font></p></li> <li><p><font color="#9400D3">github跳出认证，就是用户名和密码的输入框。</font></p></li> <li><p><font color="#9400D3">认证完毕后会redirect一个url，并携带上code参数，虽然重定向是在客户端的，但是客户端要请求到服务器，所以code主要是在服务端用的</font></p></li> <li><p><font color="#9400D3">服务端拿到code会结合client_secret请求github的某个api来获取token</font></p></li> <li><p><font color="#9400D3">拿到这个token就可以通过tokne和github的api进行交互，因为github会询问用户是否要开放一些权限给token，所以这个token会携带一些权限信息</font></p></li></ul> <h2 id="oauth的认证流程"><a href="#oauth的认证流程" aria-hidden="true" class="header-anchor">#</a> OAuth的认证流程</h2> <img src="/react_ssr_oauth_two.png" alt="oauth认证流程"> <ul><li><p><font color="#9400D3">跳转认证(1)</font>：在网页上点击某个按钮，比如常常出现在登录界面下方的第三方登录的微信图标、qq图标，依旧<code>github</code>的图标，然后会跳转到<code>Github OAuth</code>的认证界面（比如从我们自己的网站<code>http://nextjs.w2deep.com</code>跳转到<code>github</code>的<code>OAuth</code>的地址：<code>https://github.com/login/oauth/authorize?client_id=b197d1e973afb0bc9a00&amp;redirect_url=http://nextjs.w2deep.com/auth&amp;scope=user</code>,后者地址中的client_id就携带在其中，还有scope=user就表示我们想获取用户的信息权限）</p></li> <li><p><font color="#9400D3">完成认证(2)</font>：在<code>Github OAuth</code>的认证界面输入用户名和密码完成登录，并且用户要在授权窗口中点击确认后进行跳转</p></li> <li><p><font color="#9400D3">跳转连接(3)</font>：跳转到浏览器中的某个链接，并携带<code>code</code>（比如<code>github</code>服务器跳回到我们自己的网站，并携带<code>code</code>，如<code>http://nextjs.w2deep.com/auth?code=a4e2898b223e6a144f</code>，这个<code>code</code>是一次性的，不能通过这个<code>code</code>去第二次获取<code>token</code>）</p></li> <li><p><font color="#9400D3">服务器拿到code(4)</font>：浏览器向服务端发送请求，服务端拿到跳转中携带的<code>code</code></p></li> <li><p><font color="#9400D3">服务器请求access_token(5)</font>：拿到<code>code</code>会结合<code>clien_secret</code>去向<code>github</code>的服务器请求<code>access_token</code></p></li> <li><p><font color="#9400D3">github返回token(6)</font>：<code>github</code>服务器根据服务器发来的<code>code</code>和<code>clien_secret</code>生成<code>access_token</code>返回给服务器</p></li> <li><p><font color="#9400D3">服务器返回响应(7.8)</font>：服务器拿到<code>access_token</code>存储到<code>session</code>当中，然后返回请求，写入浏览器的<code>cookie</code>当中。</p></li></ul> <h2 id="注册github-oauth-app"><a href="#注册github-oauth-app" aria-hidden="true" class="header-anchor">#</a> 注册github-OAuth-App</h2> <p>进入你自己的<code>github</code>，选择你右上角的头像，选择<code>setting</code>,在左边的导航列表当中选择<code>Developer settings</code>，然后再在左边的导航列表中选择<code>OAuth Apps</code>,选择<code>New OAuth App</code>进入创建页面，在创建页面中有很多选项</p> <img src="/react_ssr_oauth_three.png" alt="注册oauth apps"> <ul><li><font color="#9400D3">Application name</font>：名称，可以随便填，我填的是<code>imooc-taopoppy</code></li> <li><font color="#9400D3">Homepage URL</font>：这个虽然是必填，但是在整个流程中不重要，我们在开发阶段写成<code>http://localhost:3001</code>即可，一般来说后面都会改成项目上线的地址</li> <li><font color="#9400D3">Authorization callback URL</font>：这个地址就是<code>github</code>在用户认证和授权完后跳转的地址，会携带<code>code</code>的地址，我们填<code>http://localhost:3000/auth</code>,项目上线的时候是要填对应的域名和对应的路由地址的。</li></ul> <p>然后点击最下面的<code>Register application</code>之后，就会显示出<code>Client_id</code>和<code>Clien_secret</code>，如下图：</p> <img src="/react_ssr_oauth_four.png" alt="id和密码"> <p>注意的是<code>clien_secret</code>可以通过点击<code>Reset client secret</code>这个按钮去重置，<code>Client ID</code>是没有必要去重置的，因为本身就是要暴露给外部的。然后<code>Revoke all user tokens</code>是清除所有这个<code>app</code>上的授权成功的用户的<code>token</code>的按钮。在这个网页的下面还可以手动修改<code>Application name</code>、<code>Homepage URL</code>、<code>Authorization callback URL</code>。</p> <p>那这两个东西当然非常重要了，所以我们需要在项目当中去创建<code>config.js</code>去保存它们：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// nextjs-project/config.js</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
	github<span class="token punctuation">:</span> <span class="token punctuation">{</span>
		client_id<span class="token punctuation">:</span> <span class="token string">'bc3225e59db1965fbeb4'</span><span class="token punctuation">,</span>
		client_secret<span class="token punctuation">:</span> <span class="token string">'a2e086590fc4233f71bcf069d6d89818bc23185a'</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="oauth字段讲解"><a href="#oauth字段讲解" aria-hidden="true" class="header-anchor">#</a> OAuth字段讲解</h2> <h3 id="_1-跳转字段"><a href="#_1-跳转字段" aria-hidden="true" class="header-anchor">#</a> 1. 跳转字段</h3> <p>当我们要从自己的网站上跳转到<code>github</code>的授权网站时，可以带很多的参数，具体有哪些参数，以及这些参数的作用，我们可以到<a href="https://developer.github.com/apps/building-oauth-apps/authorizing-oauth-apps/" target="_blank" rel="noopener noreferrer">官网<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>参考.</p> <p>下面这个字段为例：<code>https://github.com/login/oauth/authorize?client_id=b197d1e973afb0bc9a00&amp;redirect_url=http://nextjs.w2deep.com/auth&amp;scope=user</code>我们来简单介绍一下：</p> <ul><li><font color="#9400D3">client_id</font>：（必带）在注册<code>OAuth Apps</code>时候的那个<code>client_id</code>。</li> <li><font color="#9400D3">scope</font>：（选带）代表我们希望获得的授权有哪些，比如<code>user</code>、<code>repo</code>等，这些可以使用逗号分开写在<code>scope=</code>后面，具体参考<a href="https://developer.github.com/apps/building-oauth-apps/understanding-scopes-for-oauth-apps/" target="_blank" rel="noopener noreferrer">官网<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><font color="#9400D3">redirect_uri</font>：（选带）就是认证授权成功后要返回能携带<code>code</code>的网址</li> <li><font color="#9400D3">login</font>：（选带）是否允许用户登录，默认为<code>true</code>，如果用户没有在浏览器中登录<code>github</code>，可以允许先通过用户名和密码进行登录。</li> <li><font color="#9400D3">state</font>：（选带）我们自己要用到的字段，我们在跳转和<code>github</code>返回的<code>code</code>的时候都带上<code>state</code>，确保两次是相同的，来保证安全性</li> <li><font color="#9400D3">allow_signup</font>：（选带）代表是否允许用户在没有<code>github</code>账号的时候先走注册，再登录授权</li></ul> <p>所以实际上现在我们知道只要带上<code>client_id</code>，就已经能跳转到<code>github</code>认证的页面了，我们来访问<code>https://github.com/login/oauth/authorize?client_id=bc3225e59db1965fbeb4</code>就能看到浏览器显示的界面：</p> <img src="/react_ssr_oauth_five.png" alt="授权"> <p>当然上面是没有带<code>scope</code>参数的，所以它只会显示<code>Public data only</code>，代表只给你最简单的权限。我们要带点参数，比如访问下面这个地址：<code>https://github.com/login/oauth/authorize?client_id=bc3225e59db1965fbeb4&amp;scope=user,repo,gist</code>，它就会授权用户，仓库以及<code>gist</code>的权限。</p> <img src="/react_ssr_oauth_six.png" alt="多种授权"> <p>当然如果你仔细看<a href="https://developer.github.com/apps/building-oauth-apps/understanding-scopes-for-oauth-apps/" target="_blank" rel="noopener noreferrer">官网<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>，<code>user</code>、<code>repo</code>这些都是大的权限，里面包含好多小的权限，比如<code>user</code>包含<code>read:user</code>，<code>user:email</code>、<code>user:follow</code>这些，这些小权限也可以单独拿出来，直接写<code>user</code>就相当于包含了所有小的权限。</p> <p>然后授权后<code>github</code>就会跳转到<code>redirect_url</code>指定的那个地址并带上<code>code</code>，我们在注册的时候<code>redirect_url</code>指定的是<code>http://localhost:3001/auth</code>，所以它最终跳转的地址就是<code>http://localhost:3001/auth?code=93d84b9041add8c47824</code></p> <h3 id="_2-请求token字段"><a href="#_2-请求token字段" aria-hidden="true" class="header-anchor">#</a> 2. 请求token字段</h3> <p>服务器拿到了<code>code</code>之后，需要结合一些参数去<code>github</code>服务器上请求<code>access_token</code>，请求的相关参数包含下面几个：</p> <ul><li><font color="#9400D3">client_id和client_secret</font>：这两个是必须的，表示我们拥有客户端权限</li> <li><font color="#9400D3">code</font>：<code>code</code>本身也是必须的，表示用户给我们授权了</li> <li><font color="#9400D3">redirect_uri和state</font>：和上面的是一样的</li></ul> <p>下面我们来使用<font color="#DD1144">restlet client</font>这个浏览器插件来发送一下<code>post</code>请求来获取一下<code>access_token</code>：
<img src="/react_ssr_oauth_seven.png" alt=""></p> <p>可以看到返回给我们的一串字符串<code>access_token=2429eeb510c604997db54f251c3f88152d81f4b0&amp;scope=gist%2Crepo%2Cuser&amp;token_type=bearer</code>，其中就包含了<code>access_token</code>还有授权的信息，和<code>token</code>的类型。<font color="#1E90FF">要注意的是，这个code是一次性的，之前就说过，不能用它来第二次请求access_token，当然它也是有过期时间的，如果已经使用不了就必须到github的授权页面重新授权，让github重新跳转并携带新的code</font></p> <p>然后保存一下这个<code>access_token</code>，去请求一下<code>github</code>用户的信息</p> <ul><li>请求的地址：<code>https://api.github.com/user</code></li> <li>请求的头部：<code>Authorization： token 2429eeb510c604997db54f251c3f88152d81f4b0</code></li></ul> <img src="/react_ssr_oauth_eight.png" alt=""> <h2 id="oauth-code认证和安全"><a href="#oauth-code认证和安全" aria-hidden="true" class="header-anchor">#</a> OAuth-code认证和安全</h2> <p>这种方式保证安全的策略有下面这几个：</p> <ul><li><font color="#DD1144">一次性的code</font>，因为是一次性<code>code</code>，所以即便是泄露了也不会有影响，应该只能用一次</li> <li><font color="#DD1144">id+secret</font>：这种验证方式就保证了即使<code>code</code>被别人先拿到了，别人也不知道<code>clien_secret</code>，因为<code>clien_secret</code>是保存在我们自己的服务器上的，是不向外暴露的。</li> <li><font color="#DD1144">redirect_uri</font>：如果参数中的<code>redirect_uri</code>和我们一开始注册<code>OAuth Apps</code>的时候在<code>Authorization callback URL</code>中填的不一样，那么直接就会报错，<code>code</code>都不会返回。</li></ul> <h2 id="cookie和session"><a href="#cookie和session" aria-hidden="true" class="header-anchor">#</a> cookie和session</h2> <p>首先我们创建<code>server/session-store.js</code>,书写<code>session</code>和<code>redis</code>之间相关的方法：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// server/session-store.js</span>
<span class="token comment">// 统一在和session的redis中的数据前面添加一个前缀</span>
<span class="token keyword">function</span> <span class="token function">getRedisSessionId</span><span class="token punctuation">(</span><span class="token parameter">sid</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token template-string"><span class="token string">`ssid:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>sid<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">RedisSessionStore</span> <span class="token punctuation">{</span>
  <span class="token comment">// 接收一个redis的client去操作redis</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">client</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>client <span class="token operator">=</span> client
  <span class="token punctuation">}</span>

  <span class="token comment">// 获取Redis中存储的session数据</span>
  <span class="token keyword">async</span> <span class="token keyword">get</span><span class="token punctuation">(</span>sid<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'get session'</span><span class="token punctuation">,</span> sid<span class="token punctuation">)</span>
    <span class="token keyword">const</span> id <span class="token operator">=</span> <span class="token function">getRedisSessionId</span><span class="token punctuation">(</span>sid<span class="token punctuation">)</span>
    <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>client<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>data<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token keyword">null</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
      <span class="token keyword">return</span> result
    <span class="token punctuation">}</span><span class="token keyword">catch</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// 存储session数据到redis(ttl为过期时间)</span>
  <span class="token comment">// 外界使用应该使用毫秒，而redis中需要传入秒</span>
  <span class="token keyword">async</span> <span class="token keyword">set</span><span class="token punctuation">(</span>sid<span class="token punctuation">,</span> sess<span class="token punctuation">,</span> ttl<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'set session'</span><span class="token punctuation">,</span> sid<span class="token punctuation">)</span>
    <span class="token keyword">const</span> id <span class="token operator">=</span> <span class="token function">getRedisSessionId</span><span class="token punctuation">(</span>sid<span class="token punctuation">)</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> ttl <span class="token operator">===</span> <span class="token string">'number'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      ttl <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">ceil</span><span class="token punctuation">(</span>ttl <span class="token operator">/</span> <span class="token number">1000</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> sessStr <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>sess<span class="token punctuation">)</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>ttl<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 有过期时间</span>
        <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>client<span class="token punctuation">.</span><span class="token function">setex</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span> ttl<span class="token punctuation">,</span> sessStr<span class="token punctuation">)</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span> <span class="token comment">// 无过期时间</span>
        <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>client<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span> sessStr<span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// 从redis当中删除某个session</span>
  <span class="token keyword">async</span> <span class="token function">destroy</span><span class="token punctuation">(</span><span class="token parameter">sid</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'destroy session'</span><span class="token punctuation">,</span> sid<span class="token punctuation">)</span>
    <span class="token keyword">const</span> id <span class="token operator">=</span> <span class="token function">getRedisSessionId</span><span class="token punctuation">(</span>sid<span class="token punctuation">)</span>
    <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>client<span class="token punctuation">.</span><span class="token function">del</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> RedisSessionStore
</code></pre></div><p>然后我们到服务端来书写代码：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// server.js</span>

<span class="token keyword">const</span> session <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'koa-session'</span><span class="token punctuation">)</span>  <span class="token comment">// 1. 引入session</span>
<span class="token keyword">const</span> RedisSessionStore <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./server/session-store.js'</span><span class="token punctuation">)</span> <span class="token comment">// 2. 引入RedisSessionStore</span>
<span class="token keyword">const</span> Redis <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'ioredis'</span><span class="token punctuation">)</span> <span class="token comment">// 3. 引入Redis</span>

<span class="token comment">// 3. 创建redis的client（全部使用默认配置）</span>
<span class="token keyword">const</span> redis <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Redis</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

app<span class="token punctuation">.</span><span class="token function">prepare</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
	<span class="token operator">...</span>

	server<span class="token punctuation">.</span>keys <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'Taopoppy develop Github App'</span><span class="token punctuation">]</span> <span class="token comment">// 4. 设置一个给cookie加密的字符串</span>
	<span class="token comment">// 5. 配置session的配置</span>
	<span class="token keyword">const</span> <span class="token constant">SESSION_CONFIG</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
		key<span class="token punctuation">:</span> <span class="token string">'jid'</span><span class="token punctuation">,</span> <span class="token comment">// cookie的key</span>
		<span class="token comment">// maxAge: 60*1000, // 一分钟的过期时间（默认是86400000为一天）</span>
		store<span class="token punctuation">:</span> <span class="token keyword">new</span> <span class="token class-name">RedisSessionStore</span><span class="token punctuation">(</span>redis<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>

	<span class="token comment">// 6. 中间件使用</span>
	server<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">session</span><span class="token punctuation">(</span><span class="token constant">SESSION_CONFIG</span><span class="token punctuation">,</span>server<span class="token punctuation">)</span><span class="token punctuation">)</span>

	<span class="token comment">// 7.1. 通过访问localhost:3001/set/user可以设置cookie</span>
	<span class="token comment">// 7.2  cookie的key是jid，值是通过server.keys加密{name:&quot;taopoppy&quot;,age: 18}这个对象的结果：比如155dew51re51vw1erw55gw-Udklsjsg-wdfjg12fd94</span>
	<span class="token comment">// 7.3 session在redis存储的的key就是155dew51re51vw1erw55gw-Udklsjsg-wdfjg12fd94，value是&quot;{\&quot;user\&quot;：{\&quot;name\&quot;:\&quot;taopoppy\&quot;,\&quot;age\&quot;: 18,\&quot;_exprie\&quot;:155505366755,\&quot;_maxAge\&quot;:86400000}&quot;</span>
	router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/set/user'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">ctx</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
		ctx<span class="token punctuation">.</span>session<span class="token punctuation">.</span>user <span class="token operator">=</span> <span class="token punctuation">{</span>
			name<span class="token punctuation">:</span><span class="token string">&quot;taopoppy&quot;</span><span class="token punctuation">,</span>
			age<span class="token punctuation">:</span> <span class="token number">18</span>
		<span class="token punctuation">}</span>
		ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> <span class="token string">'set session success'</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span>

	<span class="token comment">// 8. 通过访问localhost:3001/delete/user可以删除cookie</span>
	router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/delete/user'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">ctx</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
		ctx<span class="token punctuation">.</span>session <span class="token operator">=</span> <span class="token keyword">null</span> <span class="token comment">// 设置为null为自动将之前保存的和session相关的数据从redis中删除掉</span>
		ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> <span class="token string">'destroy session success'</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span>
	<span class="token operator">...</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><img src="/react_ssr_cookie_session.png" alt="cookie_session"> <p>可以看到当通过<code>ctx.session.xxx=yyy</code>设置的时候，服务端会自动在<code>ctx.body</code>的返回值中给浏览器种植<code>cookie</code></p> <h2 id="github-oauth接入"><a href="#github-oauth接入" aria-hidden="true" class="header-anchor">#</a> Github OAuth接入</h2> <p>接下来我们就要正式将其接入，我们分几步去具体实现：</p> <h3 id="_1-创建第三方登录链接"><a href="#_1-创建第三方登录链接" aria-hidden="true" class="header-anchor">#</a> 1. 创建第三方登录链接</h3> <p>因为第三方授权的跳转实际上是链接的跳转，我们必须先去拼接一个我们需要的链接：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// next.config.js</span>
<span class="token keyword">const</span> withCss <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'@zeit/next-css'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> config <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./config.js'</span><span class="token punctuation">)</span>   <span class="token comment">//  1. 引入config，包含client_id和client_server</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> require <span class="token operator">!==</span> <span class="token string">'undefined'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	require<span class="token punctuation">.</span>extensions<span class="token punctuation">[</span><span class="token string">'.css'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token parameter">file</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 2. github授权链接的根地址</span>
<span class="token keyword">const</span> <span class="token constant">GITHUB_OAUTH_URL</span> <span class="token operator">=</span> <span class="token string">'https://github.com/login/oauth/authorize'</span>
<span class="token comment">// 3. 定义权限(当前只需要user，后续可以写成'user,repo,gits')</span>
<span class="token keyword">const</span> <span class="token constant">SCOPE</span> <span class="token operator">=</span> <span class="token string">'user'</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token function">withCss</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
	<span class="token comment">// 4. 在这里写所有的配置项，publicRuntimeConfig可以在客户度和服务端同时拿到</span>
	publicRuntimeConfig<span class="token punctuation">:</span> <span class="token punctuation">{</span>
		<span class="token constant">GITHUB_OAUTH_URL</span><span class="token punctuation">,</span>
		<span class="token constant">OAUTH_URL</span><span class="token punctuation">:</span> <span class="token template-string"><span class="token string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token constant">GITHUB_OAUTH_URL</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">?client_id=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>config<span class="token punctuation">.</span>github<span class="token punctuation">.</span>client_id<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&amp;scope=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token constant">SCOPE</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>然后我们有了自己拼接的链接，显示在页面上即可</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// pages/index.js</span>
<span class="token keyword">import</span> getConfig <span class="token keyword">from</span> <span class="token string">'next/config'</span>  <span class="token comment">// 1. 引入getConfig</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> publicRuntimeConfig <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">getConfig</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 2. 拿到publicRuntimeConfig</span>


<span class="token keyword">const</span> <span class="token function-variable function">Index</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span>counter<span class="token punctuation">,</span>username<span class="token punctuation">,</span>rename<span class="token punctuation">,</span>addcount<span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token punctuation">(</span>
		<span class="token operator">&lt;</span><span class="token operator">&gt;</span>
			<span class="token operator">...</span>
			<span class="token operator">&lt;</span>a href<span class="token operator">=</span><span class="token punctuation">{</span>publicRuntimeConfig<span class="token punctuation">.</span><span class="token constant">OAUTH_URL</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>去登录<span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">&gt;</span> <span class="token punctuation">{</span><span class="token comment">/* 3. 显示到页面上*/</span><span class="token punctuation">}</span>
		<span class="token operator">&lt;</span><span class="token operator">/</span><span class="token operator">&gt;</span>
	<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>这样当我们点击登录的链接，就会去<code>github</code>上面授权，不过授权完毕后跳转回来的是<code>http://localhost:3001/auth?code=5b5c56d8d1ee54eb6327</code>，这个地址我们是没有的，我们需要去创建这样一个路由</p> <h3 id="_2-创建路由"><a href="#_2-创建路由" aria-hidden="true" class="header-anchor">#</a> 2. 创建路由</h3> <p>创建一个<code>/auth</code>的路由来处理授权之后<code>github</code>跳转来的的地址，当然我们先下载个东西：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>yarn add axios@<span class="token number">0.18</span><span class="token number">.0</span>
</code></pre></div><div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// server/auth.js</span>
<span class="token keyword">const</span> axios <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'axios'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> config <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'../config.js'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> client_id<span class="token punctuation">,</span> client_secret<span class="token punctuation">,</span>request_token_url <span class="token punctuation">}</span> <span class="token operator">=</span> config<span class="token punctuation">.</span>github

module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span>  <span class="token punctuation">(</span><span class="token parameter">server</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  server<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">ctx<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>ctx<span class="token punctuation">.</span>path <span class="token operator">===</span> <span class="token string">'/auth'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 如果是localhost:3001/auth就处理</span>
      <span class="token keyword">const</span> code <span class="token operator">=</span> ctx<span class="token punctuation">.</span>query<span class="token punctuation">.</span>code
      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>code<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> <span class="token string">'code not exist'</span>
        <span class="token keyword">return</span>
      <span class="token punctuation">}</span>
      <span class="token comment">// code如果存在就要去根据code和client_id、client_secret去请求github生成tokne</span>
      <span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">axios</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        method<span class="token punctuation">:</span> <span class="token string">'POST'</span><span class="token punctuation">,</span>
        url<span class="token punctuation">:</span> request_token_url<span class="token punctuation">,</span>
        data<span class="token punctuation">:</span> <span class="token punctuation">{</span>
          client_id<span class="token punctuation">,</span>
          client_secret<span class="token punctuation">,</span>
          code
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        headers<span class="token punctuation">:</span> <span class="token punctuation">{</span>
          <span class="token string">'Accept'</span><span class="token punctuation">:</span> <span class="token string">'application/json'</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span>status<span class="token punctuation">,</span>result<span class="token punctuation">.</span>data<span class="token punctuation">)</span>

      <span class="token comment">// 判断请求token是否成功</span>
      <span class="token comment">// 如果code二次使用，github也会返回200，所以要排除这种情况</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span>status <span class="token operator">===</span> <span class="token number">200</span> <span class="token operator">&amp;&amp;</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span>data <span class="token operator">&amp;&amp;</span><span class="token operator">!</span>result<span class="token punctuation">.</span>data<span class="token punctuation">.</span>error<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        ctx<span class="token punctuation">.</span>session<span class="token punctuation">.</span>githubAuth <span class="token operator">=</span> result<span class="token punctuation">.</span>data

        <span class="token comment">// 拿到token我们就用token去请求一下用户信息</span>
        <span class="token keyword">const</span> <span class="token punctuation">{</span>token_type<span class="token punctuation">,</span> access_token <span class="token punctuation">}</span> <span class="token operator">=</span> result<span class="token punctuation">.</span>data

        <span class="token keyword">const</span> userInfoResp <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">axios</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          method<span class="token punctuation">:</span> <span class="token string">'GET'</span><span class="token punctuation">,</span>
          url<span class="token punctuation">:</span><span class="token string">'https://api.github.com/user'</span><span class="token punctuation">,</span>
          headers<span class="token punctuation">:</span> <span class="token punctuation">{</span>
            <span class="token string">'Authorization'</span><span class="token punctuation">:</span> <span class="token template-string"><span class="token string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>token_type<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>access_token<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token comment">// console.log(userInfoResp.data)</span>
				<span class="token comment">// 将用户信息保存在session当中</span>
        ctx<span class="token punctuation">.</span>session<span class="token punctuation">.</span>userInfo <span class="token operator">=</span> userInfoResp<span class="token punctuation">.</span>data


        ctx<span class="token punctuation">.</span><span class="token function">redirect</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> errorMsg <span class="token operator">=</span> result<span class="token punctuation">.</span>data <span class="token operator">&amp;&amp;</span> result<span class="token punctuation">.</span>data<span class="token punctuation">.</span>error
        ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> <span class="token template-string"><span class="token string">`request token failed </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>result<span class="token punctuation">.</span>message<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span>
      <span class="token punctuation">}</span>


    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token keyword">await</span> <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment">// 其他不是/auth不经过这层处理</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>有了这样一个函数之后，<code>http://localhost:3001/auth?code=5b5c56d8d1ee54eb6327</code>这个地址的访问就会经过上面这个中间件，并且结合<code>code</code>以及<code>clien_secret</code>和<code>client_id</code>到<code>github</code>服务器请求到<code>token</code>，我们使用该<code>token</code>获取了用户的信息，并直接保存在<code>redis</code>当中，我们到<code>server.js</code>当中去使用一下：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// nextjs-project/server.js</span>
<span class="token keyword">const</span> auth <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./server/auth.js'</span><span class="token punctuation">)</span>  <span class="token comment">// 1. 引入auth</span>

app<span class="token punctuation">.</span><span class="token function">prepare</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
	<span class="token operator">...</span>
	server<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">session</span><span class="token punctuation">(</span><span class="token constant">SESSION_CONFIG</span><span class="token punctuation">,</span>server<span class="token punctuation">)</span><span class="token punctuation">)</span>

	<span class="token comment">// 2. 配置github OAuth登录，其auth函数必须在session后面</span>
	<span class="token function">auth</span><span class="token punctuation">(</span>server<span class="token punctuation">)</span>

	<span class="token comment">// 3. 编写测试路由</span>
	router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/api/user/info'</span><span class="token punctuation">,</span><span class="token keyword">async</span><span class="token punctuation">(</span><span class="token parameter">ctx</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
		<span class="token comment">// 4. 直接从redis当中取出用户信息返回</span>
		<span class="token keyword">const</span> user <span class="token operator">=</span> ctx<span class="token punctuation">.</span>session<span class="token punctuation">.</span>userInfo
		<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>user<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			ctx<span class="token punctuation">.</span>status <span class="token operator">=</span> <span class="token number">401</span>
			ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> <span class="token string">'Need Login'</span>
		<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
			ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> user
			ctx<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">'Content-Type'</span><span class="token punctuation">,</span> <span class="token string">'application/json'</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span>

</code></pre></div><p>然后我们到<code>pages/index.js</code>当中去测试一下这个路由</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// pages/index.js</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> useEffect <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span> <span class="token comment">// 1. 引入useEffect这个钩子</span>
<span class="token keyword">import</span> axios <span class="token keyword">from</span> <span class="token string">'axios'</span> <span class="token comment">// 2. 引入axios</span>

<span class="token keyword">const</span> <span class="token function-variable function">Index</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span>counter<span class="token punctuation">,</span>username<span class="token punctuation">,</span>rename<span class="token punctuation">,</span>addcount<span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>

	<span class="token comment">// 3. 进入组件</span>
	<span class="token comment">// 如果在没有登录的情况下请求localhost:3001/api/user/info是请求不成功的</span>
	<span class="token comment">// 如果在登录的情况下请求localhost:3001/api/user/info是成功的</span>
	<span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
		axios<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/api/user/info'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">resp</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>resp<span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>


<span class="token punctuation">}</span>

</code></pre></div><p>所以当我们没有登录，访问<code>localhost:3001/</code>就请求不到用户信息，因为<code>redis</code>当中没有，登录之后，回到首页<code>localhost:3001</code>，则就会在控制台当中打印出用户信息，到这里为止，整个<code>Github OAuth</code>就算接入完成了。</p> <p>当然，使用用户信息并没有这么简单，而是要走服务端的流程，并且一开始用户信息就存在，我们就应该放在<code>redux</code>当中去。</p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated: </span> <span class="time">8/11/2020, 4:49:35 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/react-ssr/ssr_combat_project_four.html" class="prev">
          引入Redux
        </a></span> <span class="next"><a href="/react-ssr/ssr_github_one.html">
          项目整体设计
        </a>
        →
      </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.1a394514.js" defer></script><script src="/assets/js/2.8304a06b.js" defer></script><script src="/assets/js/302.aa40279f.js" defer></script>
  </body>
</html>
