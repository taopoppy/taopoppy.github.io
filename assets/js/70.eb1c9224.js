(window.webpackJsonp=window.webpackJsonp||[]).push([[70],{261:function(t,a,e){"use strict";e.r(a);var s=e(0),r=Object(s.a)({},function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"性能测量工具"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#性能测量工具","aria-hidden":"true"}},[t._v("#")]),t._v(" 性能测量工具")]),t._v(" "),e("h2",{attrs:{id:"webpagetest"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#webpagetest","aria-hidden":"true"}},[t._v("#")]),t._v(" WebPageTest")]),t._v(" "),e("h3",{attrs:{id:"_1-测试选项"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-测试选项","aria-hidden":"true"}},[t._v("#")]),t._v(" 1. 测试选项")]),t._v(" "),e("p",[t._v("我们可以登录"),e("a",{attrs:{href:"webpagetest.org"}},[t._v("webpagetest.org")]),t._v("来测试我们想要测试的网站，我们来看网页")]),t._v(" "),e("img",{attrs:{src:t.$withBase("/font_end_optimization_4.png"),alt:""}}),t._v(" "),e("p",[t._v("其中重要的地方已经标注出来：")]),t._v(" "),e("ul",[e("li",[e("font",{attrs:{color:"#1E90FF"}},[t._v("输入框")]),t._v("：输入测试地址")],1),t._v(" "),e("li",[e("font",{attrs:{color:"#1E90FF"}},[t._v("Browser")]),t._v("：测试用的浏览器")],1),t._v(" "),e("li",[e("font",{attrs:{color:"#1E90FF"}},[t._v("Advanced Settings")]),t._v("：高级设置\n"),e("ul",[e("li",[e("font",{attrs:{color:"#1E90FF"}},[t._v("Connection")]),t._v("：网络种类设置")],1),t._v(" "),e("li",[e("font",{attrs:{color:"#1E90FF"}},[t._v("Number of Tests to Run")]),t._v("：测试次数")],1),t._v(" "),e("li",[e("font",{attrs:{color:"#1E90FF"}},[t._v("Repeat View")]),t._v("：第一次访问和第二次访问，用来测试缓存工作")],1),t._v(" "),e("li",[e("font",{attrs:{color:"#1E90FF"}},[t._v("Capture Video")]),t._v("：结果视频")],1)])],1)]),t._v(" "),e("h3",{attrs:{id:"_2-测试结果"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-测试结果","aria-hidden":"true"}},[t._v("#")]),t._v(" 2. 测试结果")]),t._v(" "),e("p",[t._v("然后我们选择好之后，我们可以点击测试，然后过一会会出现这样的结果，这里安利一个"),e("code",[t._v("Chrome")]),t._v("浏览器截图全网页的方法，"),e("a",{attrs:{href:"https://jingyan.baidu.com/article/1974b289342468f4b1f77428.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("百度知道"),e("OutboundLink")],1),t._v("：")]),t._v(" "),e("img",{attrs:{src:t.$withBase("/font_end_optimization_5.png"),alt:""}}),t._v(" "),e("p",[t._v("通过观察上面图可以看出，我们进行了3轮测试，每轮测试都会有结果，"),e("font",{attrs:{color:"#1E90FF"}},[t._v("然后最主要的要看Performance Results，就是测试结果")]),t._v("，有两行，第一行就是"),e("code",[t._v("First View")]),t._v("就是首次访问的情况，第二行就是"),e("code",[t._v("Repeat View")]),t._v("就是第二次访问的情况。然后我们来看指标；")],1),t._v(" "),e("ul",[e("li",[e("font",{attrs:{color:"#1E90FF"}},[t._v("First Byte")]),t._v("：第一个请求发出去得到响应的时间，反应的服务器处理的能力和网络的回路情况")],1),t._v(" "),e("li",[e("font",{attrs:{color:"#1E90FF"}},[t._v("Start Render")]),t._v("；首屏渲染")],1),t._v(" "),e("li",[e("font",{attrs:{color:"#1E90FF"}},[t._v("First ContentFul Paint")]),t._v("：第一个有绘制的东西出现的时间")],1),t._v(" "),e("li",[e("font",{attrs:{color:"#1E90FF"}},[t._v("Speed index")]),t._v("：速度指数，要在4秒以内")],1)]),t._v(" "),e("p",[t._v("然后中间的"),e("code",[t._v("Web Vitals")]),t._v("是谷歌浏览器独有的，其中有个指数比较重要：")]),t._v(" "),e("ul",[e("li",[e("font",{attrs:{color:"#1E90FF"}},[t._v("Totol Block Time")]),t._v("：页面阻塞导致用户无法交互的累积时长，绿色代表优秀，黄色代表一般，红色代表卡死")],1)]),t._v(" "),e("h3",{attrs:{id:"_3-具体结果"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-具体结果","aria-hidden":"true"}},[t._v("#")]),t._v(" 3. 具体结果")]),t._v(" "),e("p",[t._v("然后我们可以点击某一轮的具体的瀑布图，我们可以观察到更加仔细的瀑布图，这个图是要比"),e("code",[t._v("Chrome DevTools")]),t._v("更加详细的。")]),t._v(" "),e("img",{attrs:{src:t.$withBase("/font_end_optimization_6.png"),alt:""}}),t._v(" "),e("p",[t._v("你会看到在上图中有很多图片都是"),e("font",{attrs:{color:"#DD1144"}},[t._v("并行加载")]),t._v("的，它们开始加载的时间都是相同的，这一点也可以看出来淘宝网站的优化是做的不错的，这也是提示我们对于网站的很多资源也是可以并行加载的。")],1),t._v(" "),e("p",[t._v("我们再来看一个图：")]),t._v(" "),e("img",{attrs:{src:t.$withBase("/font_end_optimization_7.png"),alt:""}}),t._v(" "),e("p",[t._v("可以在图中看到使用黄色高亮标注的部分，可以看到这些请求的结果是302，也就是重定向，说明这个请求的地址当前已经无效了，为了进一步优化，我们可以把这些重定向的请求挑出来直接修改成重定向的地址，这样就可以节省重定向的过程。")]),t._v(" "),e("h3",{attrs:{id:"_4-本地部署webpagetest"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4-本地部署webpagetest","aria-hidden":"true"}},[t._v("#")]),t._v(" 4. 本地部署WebPageTest")]),t._v(" "),e("p",[t._v("之前说的都是在线网站的性能分析，我们知道优化实际上是个没有结果的事情，也就是说开发时期要进行优化，上线之后也要进行优化，在开发时期我们可以借助本地"),e("code",[t._v("WebPageTest")]),t._v("工具进行性能分析。")]),t._v(" "),e("p",[t._v("这里来说明一下"),e("code",[t._v("Windows")]),t._v("平台下的安装，前提是电脑上有"),e("a",{attrs:{href:"https://hub.docker.com/editions/community/docker-ce-desktop-windows/",target:"_blank",rel:"noopener noreferrer"}},[t._v("docker"),e("OutboundLink")],1)]),t._v(" "),e("div",{staticClass:"language-javascript extra-class"},[e("pre",{pre:!0,attrs:{class:"language-javascript"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 拉取镜像")]),t._v("\ndocker pull webpagetest"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("server\ndocker pull webpagetest"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("agent\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 运行server的实例")]),t._v("\ndocker run "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("d "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("p "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("4000")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")]),t._v(" webpagetest"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("server\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 运行agent的实例")]),t._v("\ndocker run "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("d "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("p "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("4001")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),t._v("network"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"host"')]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("e "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"SERVER_URL=http://localhost:4000/work/"')]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("e "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"LOCATION=Test"')]),t._v(" webpagetest"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("agent\n")])])]),e("p",[t._v("现在就可以直接到浏览器，打开"),e("code",[t._v("localhost:4000")]),t._v("就可以用了")]),t._v(" "),e("h2",{attrs:{id:"lighthouse"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#lighthouse","aria-hidden":"true"}},[t._v("#")]),t._v(" LightHouse")]),t._v(" "),e("h3",{attrs:{id:"_1-工具使用"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-工具使用","aria-hidden":"true"}},[t._v("#")]),t._v(" 1. 工具使用")]),t._v(" "),e("p",[e("font",{attrs:{color:"#1E90FF"}},[e("strong",[t._v("① 第三方包")])])],1),t._v(" "),e("p",[e("code",[t._v("LightHouse")]),t._v("不仅能给我们生成一个完成的报告，还会针对性的给我们提出建议。最开始的时候"),e("code",[t._v("LightHouse")]),t._v("是以"),e("code",[t._v("npm")]),t._v("包的形式出现的，需要全局下载：")]),t._v(" "),e("div",{staticClass:"language-javascript extra-class"},[e("pre",{pre:!0,attrs:{class:"language-javascript"}},[e("code",[t._v("npm install "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("g lighthouse\n")])])]),e("p",[t._v("当前最新的版本是"),e("code",[t._v("lighthouse@6.0.0")]),t._v("，使用方法也很简单，直接使用"),e("code",[t._v("lighthouse")]),t._v("加网址即可：")]),t._v(" "),e("div",{staticClass:"language-javascript extra-class"},[e("pre",{pre:!0,attrs:{class:"language-javascript"}},[e("code",[t._v("lighthouse http"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("www"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("bilibili"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("com\n")])])]),e("p",[t._v("默认会自动打开一个"),e("code",[t._v("Chrome")]),t._v("浏览器窗口对移动版的网址进行测试，然后会以"),e("code",[t._v("html")]),t._v("的文件形式进行输出，在浏览器打开即可")]),t._v(" "),e("div",{staticClass:"language-javascript extra-class"},[e("pre",{pre:!0,attrs:{class:"language-javascript"}},[e("code",[t._v("  Printer html output written to "),e("span",{pre:!0,attrs:{class:"token constant"}},[t._v("C")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\\Users\\Administrator\\Desktop\\m"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("bilibili"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("com\n"),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("020")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("11")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("23")]),t._v("_16"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("13")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("46.")]),t._v("report"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("html "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("98")]),t._v("ms\n")])])]),e("img",{attrs:{src:t.$withBase("/optimization_lighthouse_screen.png"),alt:"lighthouse"}}),t._v(" "),e("p",[e("font",{attrs:{color:"#1E90FF"}},[e("strong",[t._v("② 浏览器内置Dev")])])],1),t._v(" "),e("p",[t._v("打开浏览器开发工具，在"),e("code",[t._v("Audits")]),t._v("当中内置了"),e("code",[t._v("LightHouse")]),t._v("，其有很多参数可以选择，比较方便")]),t._v(" "),e("p",[e("font",{attrs:{color:"#1E90FF"}},[e("strong",[t._v("③ 浏览器插件")])])],1),t._v(" "),e("p",[t._v("在"),e("code",[t._v("Chrome Store")]),t._v("当中可以搜索到"),e("code",[t._v("lighthouse")]),t._v("插件，不过需要翻墙，使用方法和上述两种基本一致。")]),t._v(" "),e("h3",{attrs:{id:"_2-metrics指标"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-metrics指标","aria-hidden":"true"}},[t._v("#")]),t._v(" 2. Metrics指标")]),t._v(" "),e("p",[t._v("在"),e("code",[t._v("Metrics")]),t._v("当中最关心的几个指标")]),t._v(" "),e("ul",[e("li",[e("font",{attrs:{color:"#1E90FF"}},[t._v("First Contentful Paint")]),t._v(":第一个有绘制的东西出现的时间")],1),t._v(" "),e("li",[e("font",{attrs:{color:"#1E90FF"}},[t._v("Speed index")]),t._v("：速度指数，小于4秒为优，这个只是个指导性的指标，像电商网站无论怎么做都不会比百度这些官网优秀，因为内容不一样，复杂度会更高")],1),t._v(" "),e("li",[e("font",{attrs:{color:"#1E90FF"}},[t._v("Largest Contentful Paint")]),t._v("：绘制最大的内容所花费的时间")],1),t._v(" "),e("li",[e("font",{attrs:{color:"#1E90FF"}},[t._v("Time to Interactive")]),t._v("：什么时候用户可以和网站开始交互了")],1),t._v(" "),e("li",[e("font",{attrs:{color:"#1E90FF"}},[t._v("Total Blocking Time")]),t._v("：阻塞的总时间")],1)]),t._v(" "),e("h3",{attrs:{id:"_3-opportunities指路"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-opportunities指路","aria-hidden":"true"}},[t._v("#")]),t._v(" 3. Opportunities指路")]),t._v(" "),e("p",[t._v("接着往下就是"),e("code",[t._v("Opportunities")]),t._v("，这个部分是告诉你可以优化哪些部分，并且通过优化之后可以达到的一个结果：")]),t._v(" "),e("ul",[e("li",[e("font",{attrs:{color:"#1E90FF"}},[t._v("Remove unused JavaScript")]),t._v("：移除一些没有用的"),e("code",[t._v("JS")]),t._v("代码，可能将后面页面用到的"),e("code",[t._v("JS")]),t._v("在首屏就加载了出来。")],1),t._v(" "),e("li",[e("font",{attrs:{color:"#1E90FF"}},[t._v("Eliminate render-blocking resources")]),t._v("：消除阻塞阻塞加载")],1)]),t._v(" "),e("p",[t._v("还有很多项目，我们就不一一解释了，可以到具体的官网去查，另外在后面我们还会去实践。")]),t._v(" "),e("h2",{attrs:{id:"chrome-devtools"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#chrome-devtools","aria-hidden":"true"}},[t._v("#")]),t._v(" Chrome DevTools")]),t._v(" "),e("h2",{attrs:{id:"性能测量api"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#性能测量api","aria-hidden":"true"}},[t._v("#")]),t._v(" 性能测量API")])])},[],!1,null,null,null);a.default=r.exports}}]);