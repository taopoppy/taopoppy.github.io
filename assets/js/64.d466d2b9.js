(window.webpackJsonp=window.webpackJsonp||[]).push([[64],{250:function(s,t,a){"use strict";a.r(t);var e=a(0),r=Object(e.a)({},function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"环境的搭建"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#环境的搭建","aria-hidden":"true"}},[s._v("#")]),s._v(" 环境的搭建")]),s._v(" "),a("h2",{attrs:{id:"准备虚拟服务器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#准备虚拟服务器","aria-hidden":"true"}},[s._v("#")]),s._v(" 准备虚拟服务器")]),s._v(" "),a("h3",{attrs:{id:"_1-下载virtualbox"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-下载virtualbox","aria-hidden":"true"}},[s._v("#")]),s._v(" 1. 下载VirtualBox")]),s._v(" "),a("p",[s._v("首先我们要去下载"),a("code",[s._v("VirtualBox")]),s._v("和"),a("code",[s._v("CentOS")]),s._v("的"),a("code",[s._v("iso")]),s._v("镜像文件，下载地址在这里：")]),s._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://www.virtualbox.org/wiki/Downloads",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://www.virtualbox.org/wiki/Downloads(最新版)"),a("OutboundLink")],1)]),s._v(" "),a("li",[a("a",{attrs:{href:"https://download.virtualbox.org/virtualbox/5.2.22/VirtualBox-5.2.22-126460-Win.exe",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://download.virtualbox.org/virtualbox/5.2.22/VirtualBox-5.2.22-126460-Win.exe(5.2.22版)"),a("OutboundLink")],1)]),s._v(" "),a("li",[a("a",{attrs:{href:"http://isoredirect.centos.org/centos/7/isos/x86_64/centos-7-x86_64-dvd-1810.iso",target:"_blank",rel:"noopener noreferrer"}},[s._v("http://isoredirect.centos.org/centos/7/isos/x86_64/centos-7-x86_64-dvd-1810.iso(已不可用)"),a("OutboundLink")],1)]),s._v(" "),a("li",[a("a",{attrs:{href:"http://mirrors.aliyun.com/centos/7/isos/x86_64/",target:"_blank",rel:"noopener noreferrer"}},[s._v("http://mirrors.aliyun.com/centos/7/isos/x86_64/(可用)"),a("OutboundLink")],1)]),s._v(" "),a("li",[a("a",{attrs:{href:"http://isoredirect.centos.org/centos/8/isos/x86_64/CentOS-8-x86_64-1905-dvd1.iso",target:"_blank",rel:"noopener noreferrer"}},[s._v("http://isoredirect.centos.org/centos/8/isos/x86_64/CentOS-8-x86_64-1905-dvd1.iso(最新版CentOS8)"),a("OutboundLink")],1)])]),s._v(" "),a("p",[s._v("然后点击"),a("code",[s._v("Windows hosts")]),s._v("就会下载"),a("code",[s._v("VirtualBox-6.1.0-135406-Win.exe")]),s._v("的文件，下载好之后双击安装，安装好打开就是这样的界面：")]),s._v(" "),a("img",{attrs:{src:s.$withBase("/mysql_virtualbox_download.png"),alt:""}}),s._v(" "),a("p",[s._v("但是我们选择的是"),a("code",[s._v("5.2.22")]),s._v("版本，然后有个问题，就是无论是新版的或者是旧版本的"),a("code",[s._v("virtualbox")]),s._v("在选择"),a("code",[s._v("linux")]),s._v("的版本都没有"),a("code",[s._v("64bit")]),s._v("的问题，所以我们需要打开电脑的"),a("code",[s._v("BIOS")]),s._v("中去修改"),a("code",[s._v("cpu")]),s._v("的虚拟功能，可以参考这篇文章"),a("a",{attrs:{href:"https://blog.csdn.net/cherrycheng_/article/details/45719719",target:"_blank",rel:"noopener noreferrer"}},[s._v("64位的电脑装VirtualBox新建虚拟电脑都是32位的系统"),a("OutboundLink")],1)]),s._v(" "),a("h3",{attrs:{id:"_2-创建虚拟服务器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-创建虚拟服务器","aria-hidden":"true"}},[s._v("#")]),s._v(" 2. 创建虚拟服务器")]),s._v(" "),a("p",[s._v("下载好了并且打开了上述界面就点击新建，新建一个虚拟服务器：")]),s._v(" "),a("img",{attrs:{src:s.$withBase("/mysql_virtualbox_condition.png"),alt:"创建虚拟服务配置"}}),s._v(" "),a("p",[s._v("然后为了能让它安装系统，我们还要对这个虚拟服务器进行一些设置；")]),s._v(" "),a("ul",[a("li",[a("font",{attrs:{color:"#3eaf7c"}},[s._v("网络")]),s._v("：选择"),a("font",{attrs:{color:"#1E90FF"}},[s._v("桥接网卡")]),s._v("，这样才能使用内网IP来使用我们的虚拟机")],1),s._v(" "),a("li",[a("font",{attrs:{color:"#3eaf7c"}},[s._v("存储")]),s._v("：在控制器下面选择之前我们下载好的"),a("code",[s._v("CentOS")]),s._v("的镜像文件")],1)]),s._v(" "),a("p",[s._v("点击"),a("code",[s._v("OK")]),s._v("我们就完成了虚拟机安装的准备工作，然后点击启动，就能进行虚拟系统的安装了")]),s._v(" "),a("h2",{attrs:{id:"安装centos系统"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装centos系统","aria-hidden":"true"}},[s._v("#")]),s._v(" 安装CentOS系统")]),s._v(" "),a("h3",{attrs:{id:"_1-下载centos系统"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-下载centos系统","aria-hidden":"true"}},[s._v("#")]),s._v(" 1. 下载CentOS系统")]),s._v(" "),a("p",[s._v("选择我们已经创建的虚拟服务器，然后点击"),a("font",{attrs:{color:"#3eaf7c"}},[s._v("启动按钮")]),s._v("：")],1),s._v(" "),a("ul",[a("li",[s._v("选择"),a("font",{attrs:{color:"#1E90FF"}},[s._v("Test this media & install CentOS Linux？")]),s._v(",开始检测镜像文件的完整性和下载系统（这里在虚拟机中的鼠标是拉不出来的，需要使用键盘右侧的Ctrl进行切换鼠标）")],1),s._v(" "),a("li",[s._v("选择英语语言，然后在下一个页面自检完成后（"),a("code",[s._v("SYSTEM")]),s._v("栏中的第一个选项变红后点击，然后直接点击左上角的"),a("code",[s._v("Done")]),s._v("按钮），然后点击"),a("font",{attrs:{color:"#1E90FF"}},[s._v("Begin install")]),s._v("开始下载")],1),s._v(" "),a("li",[s._v("在下载的时候可以设置密码，在最上面左侧是设置密码，右侧是添加用户。等待安装后选择"),a("font",{attrs:{color:"#1E90FF"}},[s._v("Reboot")]),s._v("进行重启，大概一分钟后选择第一选项进入系统："),a("font",{attrs:{color:"#1E90FF"}},[s._v("CentOS Linux(Core)")]),s._v("，然后填写用户为"),a("code",[s._v("root")]),s._v("密码填写你刚才设置的密码。")],1)]),s._v(" "),a("h3",{attrs:{id:"_2-配置centos系统"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-配置centos系统","aria-hidden":"true"}},[s._v("#")]),s._v(" 2. 配置CentOS系统")]),s._v(" "),a("p",[s._v("然后下面我们进行配置"),a("code",[s._v("CentOS")]),s._v("系统，配置的原因是想让其他的服务器也能连接到这个虚拟机中来，首先我们要来配置这虚拟机的网络：")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cd")]),s._v(" /etc/sysconfig/\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cd")]),s._v(" network-scripts/\n")])])]),a("p",[s._v("在这个目录下面有一些配置文件，我们需要根据我们计算机本身的网卡来进行配置，我们首先要配置"),a("font",{attrs:{color:"#1E90FF"}},[s._v("ifcfg-enp0s3")]),s._v("这个文件，这就是网卡配置文件：")],1),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ip")]),s._v(" addr  // 看一下网卡信息\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("vi")]),s._v(" ifcfg-enp0s3 // 编辑网卡配置文件\n")])])]),a("p",[s._v("修改网卡文件如下:")]),s._v(" "),a("img",{attrs:{src:s.$withBase("/mysql_virtualbox_geteway.png"),alt:"CentOS网卡设置"}}),s._v(" "),a("ul",[a("li",[s._v("首先"),a("code",[s._v("BOOTPROTO")]),s._v("修改"),a("code",[s._v("dhcp")]),s._v("为"),a("code",[s._v("static")]),s._v("，我们使用静态的"),a("code",[s._v("ip")])]),s._v(" "),a("li",[s._v("然后"),a("code",[s._v("IPV6INIT")]),s._v("修改为"),a("code",[s._v("no")]),s._v("，因为用不到")]),s._v(" "),a("li",[s._v("接着"),a("code",[s._v("ONBOOT")]),s._v("修改为"),a("code",[s._v("yes")]),s._v("，开机的时候启动网卡设置")]),s._v(" "),a("li",[s._v("最后"),a("code",[s._v("NETMASK")]),s._v("子网掩码和"),a("code",[s._v("GATEWAY")]),s._v("网关要和本机中的设置要一致\n"),a("ul",[a("li",[a("code",[s._v("IPADDR")]),s._v("是虚拟机的"),a("code",[s._v("ip")]),s._v("，我们要修改成为和本机的"),a("code",[s._v("ip")]),s._v("在一个时段内，比如我们的本机是"),a("code",[s._v("11.75")]),s._v(",我这里在虚拟机就能设置为"),a("code",[s._v("11.xx")]),s._v("（我设置的"),a("code",[s._v("11.86")]),s._v(",如上图）")]),s._v(" "),a("li",[a("code",[s._v("DNS1")]),s._v("设置为"),a("code",[s._v("8.8.8.8")]),s._v("，这个是谷歌的一个"),a("code",[s._v("DNS")]),s._v("，如果你用本机的那个首选"),a("code",[s._v("DNS")]),s._v("服务器可能会有"),a("code",[s._v("ping baidu.com")]),s._v("无法连接的状态。")])])])]),s._v(" "),a("p",[s._v("然后我们使用"),a("font",{attrs:{color:"#DD1144"}},[s._v("service network restart")]),s._v("重新启动网络设置，然后测试一下：")],1),s._v(" "),a("ul",[a("li",[s._v("使用"),a("code",[s._v("ip addr")]),s._v("来检测虚拟机上的"),a("code",[s._v("ip")]),s._v("是否修改成为"),a("code",[s._v("192.168.11.86")])]),s._v(" "),a("li",[s._v("然后在虚拟机上我们使用"),a("code",[s._v("ping 192.168.11.75")]),s._v("来连接本机，在本机使用"),a("code",[s._v("ping 192.168.11.86")]),s._v("来连接虚拟机。")]),s._v(" "),a("li",[s._v("最后在虚拟机上使用"),a("code",[s._v("ping baidu.com")]),s._v("来连接百度")])]),s._v(" "),a("p",[s._v("如果上面的连接不成功，要么是设置有问题，要么是防火墙没有关，我们可以使用下面的命令来关闭防火墙，然后再重新"),a("code",[s._v("ping")]),s._v("一遍上面的测试：")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("systemctl stop firewalld.service "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#停止firewall")]),s._v("\nsystemctl disable firewalld.service "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#禁止firewall开机启动")]),s._v("\n")])])]),a("p",[s._v("另外我们去修改主机名，修改"),a("code",[s._v("/etc/hostname")]),s._v("文件中的内容为自己想要的主机名（我修改为了imooc）")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("vi")]),s._v(" /etc/hostname\n")])])]),a("p",[s._v("最后我们直接重启：")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("reboot")]),s._v("\n")])])]),a("p",[a("font",{attrs:{color:"#1E90FF"}},[s._v("重启后我们可以在virtualbox上面来操作我们的虚拟机，也可以通过ssh连接工具（比如说XShell）来连接到虚拟机进行操作了")]),s._v("。"),a("br"),s._v(" "),a("font",{attrs:{color:"#DD1144"}},[s._v("提示")]),s._v("：关于桥接网卡的概念和操作，可以参照"),a("a",{attrs:{href:"https://www.cnblogs.com/gne-hwz/p/8320361.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://www.cnblogs.com/gne-hwz/p/8320361.html"),a("OutboundLink")],1)],1),s._v(" "),a("h2",{attrs:{id:"部署mysql数据库"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#部署mysql数据库","aria-hidden":"true"}},[s._v("#")]),s._v(" 部署Mysql数据库")]),s._v(" "),a("h3",{attrs:{id:"_1-安装mysql数据库"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-安装mysql数据库","aria-hidden":"true"}},[s._v("#")]),s._v(" 1. 安装Mysql数据库")]),s._v(" "),a("p",[s._v("在我们的虚拟机可以连接到网络后我们在"),a("code",[s._v("CentOS")]),s._v("系统上还没有"),a("code",[s._v("wget")]),s._v("这个命令，我们需要通过下面的命令去安装：")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("yum "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" -y\n")])])]),a("p",[s._v("下面好了之后我们可以下载这个"),a("code",[s._v("mysql")]),s._v("的安装包了：")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" https://downloads.mysql.com/archives/get/p/23/file/mysql-8.0.15-linux-glibc2.12-x86_64.tar.xz\n")])])]),a("p",[s._v("当然了，因为有些网络慢的原因，我们希望下载好安装包然后上传到"),a("code",[s._v("linux")]),s._v("系统中，这个时候我们需要：")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("yum -y "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" lrzsz\n")])])]),a("p",[s._v("然后通过"),a("code",[s._v("rz")]),s._v("来上传文件，然后使用"),a("code",[s._v("sz")]),s._v("来下载文件。首先下载好的"),a("code",[s._v("mysql-8.0.15-linux-glibc2.12-x86_64.tar.xz")]),s._v("是个"),a("code",[s._v("xz")]),s._v("文件，我们需要解压成为"),a("code",[s._v("tar")]),s._v("文件，然后将"),a("code",[s._v("tar")]),s._v("文件解压成为"),a("code",[s._v("mysql-8.0.15-linux-glibc2.12-x86_64")]),s._v("这个文件夹,并且移动到"),a("code",[s._v("/usr/local/mysql")]),s._v("目录下：")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("xz -d mysql-8.0.15-linux-glibc2.12-x86_64.tar.xz\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("tar")]),s._v(" xf mysql-8.0.15-linux-glibc2.12-x86_64.tar\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mv")]),s._v(" mysql-8.0.15-linux-glibc2.12-x86_64 /usr/local/mysql\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cd")]),s._v(" /usr/local/mysql\n")])])]),a("p",[s._v("然后我们来看如何启动"),a("code",[s._v("mysql")])]),s._v(" "),a("h3",{attrs:{id:"_2-配置mysql数据库服务"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-配置mysql数据库服务","aria-hidden":"true"}},[s._v("#")]),s._v(" 2. 配置Mysql数据库服务")]),s._v(" "),a("p",[a("font",{attrs:{color:"#1E90FF"}},[a("strong",[s._v("① 添加mysql系统用户")])])],1),s._v(" "),a("p",[s._v("一般来说呢，我们是不能直接使用"),a("code",[s._v("root")]),s._v("用户来启动某个服务的，这样是不安全的，"),a("font",{attrs:{color:"#1E90FF"}},[s._v("所以我们需要单独的建立一个系统账号来是启动某个服务")]),s._v("：")],1),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("adduser mysql  // 添加一个mysql的用户来启动mysql服务\n")])])]),a("p",[a("font",{attrs:{color:"#1E90FF"}},[a("strong",[s._v("② 修改mysql配置文件")])])],1),s._v(" "),a("p",[s._v("添加好"),a("code",[s._v("mysql")]),s._v("名称的系统用户后我们来看看"),a("code",[s._v("mysql")]),s._v("的配置文件，一般都在"),a("code",[s._v("/etc/my.cnf")]),s._v("下面：")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("client"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nport   "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" 3306\nsocket "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" /usr/local/mysql/data/mysql.sock\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("mysqld"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# skip #")]),s._v("\nskip_name_resolve      "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" 1\nskip_external_locking  "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" 1\nskip_symbolic_links    "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" 1\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# GENERAL #")]),s._v("\nuser "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" mysql\ndefault_storage_engine "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" InnoDB\ncharacter-set-server "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" utf8\nsocket "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" /usr/local/mysql/data/mysql.sock\npid_file "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" /usr/local/mysql/data/mysqld.pid\nbasedir "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" /usr/local/mysql\nport "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" 3306\nbind-address "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" 0.0.0.0\nexplicit_defaults_for_timestamp "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" off\nsql_mode "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" NO_ENGINE_SUBSTITUTION,STRICT_TRANS_TABLES\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#read_only=on")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# MyISAM#")]),s._v("\nkey_buffer_size "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" 32M\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#myisam_recover = FORCE,BACKUP")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# undo log #")]),s._v("\ninnodb_undo_directory   "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" /usr/local/mysql/undo\ninnodb_undo_tablespaces "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" 8\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# SAFETY #")]),s._v("\nmax_allowed_packet "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" 100M\nmax_connect_errors "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" 1000000\nsysdate_is_now "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" 1\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#innodb = FORCE")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#innodb_strict_node = 1")]),s._v("\nsecure-file-priv "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/tmp'")]),s._v("\ndefault_authentication_plugin "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'mysql_native_password'")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Replice #")]),s._v("\nserver-id "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" 1001\nrelay_log "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" mysqld-relay-bin\ngtid_mode "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" on\nenforce-gtid-consistency\nlog-slave-updates "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" on\nmaster_info_repository "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" TABLE\nrelay_log_info_repository "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" TABLE\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# DATA STORAGE#")]),s._v("\ndatadir "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" /usr/local/mysql/data/\ntmpdir "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" /tmp\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# BINARY LOGGING#")]),s._v("\nlog_bin "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" /usr/local/mysql/sql_log/mysql-bin\nmax_binlog_size "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" 1000M\nbinlog_format "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" row\nbinlog_expire_logs_seconds "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" 86400\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#sync_binlog = 1")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# CACHES AND LIMITS #")]),s._v("\ntmp_table_size             "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" 32M\nmax_heap_table_size        "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" 32M\nmax_connections            "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" 4000\nthread_cache_size          "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" 2048\nopen_files_limit           "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" 65535\ntable_definition_cache     "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" 4096\ntable_open_cache           "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" 4096\nsort_buffer_size           "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" 2M\nread_buffer_size           "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" 2M\nread_rnd_buffer_size       "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" 2M\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# thread_concurrency        = 24")]),s._v("\njoin_buffer_size           "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" 1M\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# table_cache               = 32768")]),s._v("\nthread_stack               "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" 512k\nmax_length_for_sort_data   "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" 16k\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# INNODB #")]),s._v("\ninnodb_flush_method            "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" O_DIRECT\ninnodb_log_buffer_size         "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" 16M\ninnodb_flush_log_at_trx_commit "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" 2\ninnodb_file_per_table          "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" 1\ninnodb_buffer_pool_size        "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" 256M\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#innodb_buffer_pool_instances   = 8")]),s._v("\ninnodb_stats_on_metadata       "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" off\ninnodb_open_files              "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" 8192\ninnodb_read_io_threads         "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" 16\ninnodb_write_io_threads        "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" 16\ninnodb_io_capacity             "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" 20000\ninnodb_thread_concurrency      "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" 0\ninnodb_lock_wait_timeout       "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" 60\ninnodb_old_blocks_time         "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" 1000\ninnodb_use_native_aio          "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" 1\ninnodb_purge_threads           "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" 1\ninnodb_change_buffering        "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" all\ninnodb_log_file_size           "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" 64M\ninnodb_log_files_in_group      "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" 2\ninnodb_data_file_path          "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" ibdata1:256M:autoextend\ninnodb_rollback_on_timeout     "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" on\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# LOGGING #")]),s._v("\nlog_error "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" /usr/local/mysql/sql_log/mysql-error.log\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# log_queries_not_using_indexes   = 1")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# slow_query_lo                  =1")]),s._v("\nslow_query_log_file "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" /usr/local/mysql/sql_log/slowlog.log\n")])])]),a("p",[s._v("关于"),a("code",[s._v("my.cnf")]),s._v("的配置参数的含义和选型，可以到这两个博客上详细的查询："),a("a",{attrs:{href:"https://www.cnblogs.com/L-H-R-X-hehe/p/4110702.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("mysql配置文件my.cnf详解"),a("OutboundLink")],1),s._v("、"),a("a",{attrs:{href:"https://www.cnblogs.com/toby/articles/2198697.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("my.cnf部分详解"),a("OutboundLink")],1)]),s._v(" "),a("p",[a("font",{attrs:{color:"#1E90FF"}},[a("strong",[s._v("③ 添加文件并且修改权限")])])],1),s._v(" "),a("p",[s._v("然后我们在"),a("code",[s._v("/usr/local/mysql")]),s._v("目录下面创建几个文件，因为在配置中需要用到：")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" data sql_log undo\n")])])]),a("p",[s._v("然后之前我们添加一个"),a("code",[s._v("mysql")]),s._v("的系统用户，当前在"),a("code",[s._v("/usr/local/mysql")]),s._v("下的文件读写的权限都只有"),a("code",[s._v("root")]),s._v("用户，我们需要让"),a("code",[s._v("mysql")]),s._v("系统用户也拥有刚创建的三个文件的有写权限：")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@imooc mysql"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# chown mysql:mysql -R data/ sql_log/ undo/")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@imooc mysql"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ls -lh")]),s._v("\n")])])]),a("p",[s._v("使用"),a("code",[s._v("ls -lh")]),s._v("检查一下"),a("code",[s._v("data")]),s._v("、"),a("code",[s._v("sql_log")]),s._v("、"),a("code",[s._v("undo")]),s._v("三个文件的属主，"),a("font",{attrs:{color:"#1E90FF"}},[s._v("然后我们使用mysql系统用户启动mysql服务的时候，就能对这几个文件进行读写操作了")])],1),s._v(" "),a("p",[a("font",{attrs:{color:"#1E90FF"}},[a("strong",[s._v("④ 修改环境变量")])])],1),s._v(" "),a("p",[s._v("我们在"),a("code",[s._v("/etc/profile")]),s._v("这文件的最后添加"),a("code",[s._v("mysql")]),s._v("可执行文件的路径,这样在任何目录下都能使用"),a("code",[s._v("mysql")]),s._v("服务的命令了：")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("vi")]),s._v(" /etc/profile\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 文件最后一行添加下面的语句")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("export")]),s._v(" PATH"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$PATH")]),s._v(":/usr/local/mysql/bin\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 应用环境变量")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("source")]),s._v(" /etc/profile\n")])])]),a("h3",{attrs:{id:"_3-初始化mysql数据库服务"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-初始化mysql数据库服务","aria-hidden":"true"}},[s._v("#")]),s._v(" 3. 初始化Mysql数据库服务")]),s._v(" "),a("p",[a("font",{attrs:{color:"#1E90FF"}},[a("strong",[s._v("① 初始化mysql服务")])])],1),s._v(" "),a("p",[s._v("我们要初始化"),a("code",[s._v("mysql")]),s._v("的一些系统的数据库和它的系统表：")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("mysqld --initialize --user"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("mysql --basedir"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/local/mysql --datadir"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/local/mysql/data\n")])])]),a("p",[s._v("接着我们进入到"),a("code",[s._v("/usr/local/mysql/support-files/")]),s._v("目录下面，将"),a("code",[s._v("mysql.server")]),s._v("拷贝到"),a("code",[s._v("/etc/init.d/mysqld")]),s._v(":")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cd")]),s._v(" support-files/\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" mysql.server /etc/init.d/mysqld\n")])])]),a("p",[a("font",{attrs:{color:"#1E90FF"}},[a("strong",[s._v("② 启动mysql服务")])])],1),s._v(" "),a("p",[s._v("然后我们就可以进入到"),a("code",[s._v("/etc/init.d/mysqld")]),s._v("来启动"),a("code",[s._v("mysql")]),s._v("的服务了：")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("/etc/init.d/mysqld start\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 检查是否启动成功")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v(" -ef "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" mysql\n")])])]),a("p",[a("font",{attrs:{color:"#1E90FF"}},[a("strong",[s._v("③ 修改密码")])])],1),s._v(" "),a("p",[s._v("新版本中，我们的临时密码存储在"),a("code",[s._v("/usr/local/mysql/sql_log/mysql-error.log")]),s._v("文件中，我们先查询一下：")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" password mysql-error.log\n")])])]),a("p",[s._v("复制一下结果中最后的一小段复杂的字符串，那个就是临时的密码。然后使用"),a("code",[s._v("mysql")]),s._v("客户端命令进入"),a("code",[s._v("mysql")]),s._v(":")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("mysql -uroot -p\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 接着输入刚才记录的复制的字符串")]),s._v("\n")])])]),a("p",[s._v("进入到"),a("code",[s._v("mysql")]),s._v("中我们就来修改一下密码：")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("mysql"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" alter user user"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" identified by "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'123456'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\nmysql"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("exit")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),a("p",[s._v("然后重新使用新的密码登录。到这里我们就基本完成了"),a("code",[s._v("mysql")]),s._v("的全部安装和部署。当然这里我们还没有将"),a("code",[s._v("mysql")]),s._v("设置成为每次开机自启动服务，你可以参考这里的文章自己设置："),a("a",{attrs:{href:"https://blog.csdn.net/gxw19874/article/details/51982873",target:"_blank",rel:"noopener noreferrer"}},[s._v("设置MySQL开机自动启动的方法"),a("OutboundLink")],1)])])},[],!1,null,null,null);t.default=r.exports}}]);